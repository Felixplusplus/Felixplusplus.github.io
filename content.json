{"meta":{"title":"åŒ€æ˜Šçš„æ—§ç¬”è®°","subtitle":"å¤©ä¸‹äº‹æœ‰éš¾æ˜“ä¹ï¼Ÿä¸ºä¹‹ï¼Œåˆ™éš¾è€…äº¦æ˜“ä¹Ÿ","description":null,"author":"åŒ€æ˜Š","url":"https://felixplusplus.github.io"},"pages":[{"title":"categories","date":"2018-08-18T16:41:15.000Z","updated":"2018-08-18T16:41:35.347Z","comments":true,"path":"categories/index.html","permalink":"https://felixplusplus.github.io/categories/index.html","excerpt":"","text":""},{"title":"FELIX 's RESUME","date":"2018-08-18T16:43:18.000Z","updated":"2018-08-18T17:40:19.392Z","comments":true,"path":"about/index.html","permalink":"https://felixplusplus.github.io/about/index.html","excerpt":"","text":"Who Am IBase Info å§“å : å¼ äº‘çš“ ç±è´¯ : é»‘é¾™æ±Ÿ ç”Ÿæ—¥ : 1993.xx.xx é™¢æ ¡ : å“ˆå°”æ»¨ç†å·¥å¤§å­¦ ä¸“ä¸š : è½¯ä»¶å·¥ç¨‹ é‚®ç®± : zyhzhangyunhao@gmail.com Education Experience 2012å¹´9æœˆ~2016å¹´6æœˆ å“ˆå°”æ»¨ç†å·¥å¤§å­¦è½¯ä»¶å·¥ç¨‹ 2012å¹´9æœˆ~2016å¹´6æœˆ å“ˆå°”æ»¨ç†å·¥å¤§å­¦ä¼šè®¡ Work Experience 2016å¹´11æœˆ~2016å¹´9æœˆ åŒ—äº¬ç¥å·ç»¿ç›Ÿç§‘æŠ€æœ‰é™å…¬å¸ å®‰å…¨å·¥ç¨‹å¸ˆ 2016å¹´10æœˆ~ æ­å·è¿ªç«ç§‘æŠ€æœ‰é™å…¬å¸ iOSé«˜çº§å¼€å‘å·¥ç¨‹å¸ˆ What Have I Done What Can I Do"},{"title":"Tagcloud","date":"2017-04-26T09:47:43.000Z","updated":"2018-08-18T11:07:17.135Z","comments":true,"path":"tags/index.html","permalink":"https://felixplusplus.github.io/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"å¤§è¯lldb","slug":"lldb","date":"2018-08-27T07:06:47.000Z","updated":"2018-08-28T05:37:26.222Z","comments":true,"path":"2018/08/27/lldb/","link":"","permalink":"https://felixplusplus.github.io/2018/08/27/lldb/","excerpt":"","text":"lldb ç®€ä»‹lldb æ˜¯ä»€ä¹ˆlldb æ˜¯æˆ‘ä»¬æ—¥å¸¸å¼€å‘ç”¨æ¥è°ƒè¯•çš„å‘½ä»¤è¡Œå·¥å…· Usageè¿›é˜¶Chiselæ€»ç»“","categories":[],"tags":[]},{"title":"ä½¿ç”¨swiftæ­å»ºç®€æ˜“åŒºå—é“¾å¹¶å®ç°ä½¿ç”¨webApiè¿›è¡Œè°ƒåº¦","slug":"swiftBlockChain","date":"2018-08-11T03:28:28.000Z","updated":"2018-08-18T10:52:16.949Z","comments":true,"path":"2018/08/11/swiftBlockChain/","link":"","permalink":"https://felixplusplus.github.io/2018/08/11/swiftBlockChain/","excerpt":"","text":"Reasonæœ€è¿‘ç‰¹åˆ«å¥½å¥‡æ¯”ç‰¹å¸ä¸ºå•¥é‚£ä¹ˆè´µ ï¼Œ é‚£ä¹ˆå¤šäººå»ç‚’ ï¼Œ æ‰€ä»¥å…ˆäº†è§£ä¸€ä¸‹åŒºå—é“¾ ï¼Œ å¹¶ä½¿ç”¨swiftå®ç°ä¸€ä¸ªç»ƒç»ƒæ‰‹ æºç åœ°å€ BlockChain æ‰€è°“åŒºå—é“¾æŠ€æœ¯ ï¼Œ ç®€ç§°BTï¼ˆBlockchain technologyï¼‰ï¼Œä¹Ÿè¢«ç§°ä¹‹ä¸ºåˆ†å¸ƒå¼è´¦æœ¬æŠ€æœ¯ï¼Œæ˜¯ä¸€ç§äº’è”ç½‘æ•°æ®åº“æŠ€æœ¯ï¼Œå…¶ç‰¹ç‚¹æ˜¯å»ä¸­å¿ƒåŒ–ã€å…¬å¼€é€æ˜ï¼Œè®©æ¯ä¸ªäººå‡å¯å‚ä¸æ•°æ®åº“è®°å½•ã€‚ Base äº¤æ˜“ï¼ˆTransactionï¼‰ï¼šä¸€æ¬¡æ“ä½œï¼Œå¯¼è‡´è´¦æœ¬çŠ¶æ€çš„ä¸€æ¬¡æ”¹å˜ï¼Œå¦‚æ·»åŠ ä¸€æ¡è®°å½•ï¼› åŒºå—ï¼ˆBlockï¼‰ï¼šè®°å½•ä¸€æ®µæ—¶é—´å†…å‘ç”Ÿçš„äº¤æ˜“å’ŒçŠ¶æ€ç»“æœï¼Œæ˜¯å¯¹å½“å‰è´¦æœ¬çŠ¶æ€çš„ä¸€æ¬¡å…±è¯†ï¼› é“¾ï¼ˆChainï¼‰ï¼šç”±ä¸€ä¸ªä¸ªåŒºå—æŒ‰ç…§å‘ç”Ÿé¡ºåºä¸²è”è€Œæˆï¼Œæ˜¯æ•´ä¸ªçŠ¶æ€å˜åŒ–çš„æ—¥å¿—è®°å½•ã€‚ å¦‚æœæŠŠåŒºå—é“¾ä½œä¸ºä¸€ä¸ªçŠ¶æ€æœºï¼Œåˆ™æ¯æ¬¡äº¤æ˜“å°±æ˜¯è¯•å›¾æ”¹å˜ä¸€æ¬¡çŠ¶æ€ï¼Œè€Œæ¯æ¬¡å…±è¯†ç”Ÿæˆçš„åŒºå—ï¼Œå°±æ˜¯å‚ä¸è€…å¯¹äºåŒºå—ä¸­æ‰€æœ‰äº¤æ˜“å†…å®¹å¯¼è‡´çŠ¶æ€æ”¹å˜çš„ç»“æœè¿›è¡Œç¡®è®¤ã€‚ é˜è¿° ç”¨é€šä¿—çš„è¯é˜è¿°ï¼šå¦‚æœæˆ‘ä»¬æŠŠæ•°æ®åº“å‡è®¾æˆä¸€æœ¬è´¦æœ¬ï¼Œè¯»å†™æ•°æ®åº“å°±å¯ä»¥çœ‹åšä¸€ç§è®°è´¦çš„è¡Œä¸ºï¼ŒåŒºå—é“¾æŠ€æœ¯çš„åŸç†å°±æ˜¯åœ¨ä¸€æ®µæ—¶é—´å†…æ‰¾å‡ºè®°è´¦æœ€å¿«æœ€å¥½çš„äººï¼Œç”±è¿™ä¸ªäººæ¥è®°è´¦ï¼Œç„¶åå°†è´¦æœ¬çš„è¿™ä¸€é¡µä¿¡æ¯å‘ç»™æ•´ä¸ªç³»ç»Ÿé‡Œçš„å…¶ä»–æ‰€æœ‰äººã€‚è¿™ä¹Ÿå°±ç›¸å½“äºæ”¹å˜æ•°æ®åº“æ‰€æœ‰çš„è®°å½•ï¼Œå‘ç»™å…¨ç½‘çš„å…¶ä»–æ¯ä¸ªèŠ‚ç‚¹ï¼Œæ‰€ä»¥åŒºå—é“¾æŠ€æœ¯ä¹Ÿç§°ä¸ºåˆ†å¸ƒå¼è´¦æœ¬ï¼ˆdistributed ledgerï¼‰ã€‚ Vaporæ—¢ç„¶è¦ç”¨swiftå®ç° ï¼Œ æˆ‘åœ¨è¿™é‡Œå°±é€‰æ‹©vaporä½œä¸ºæœåŠ¡ç«¯æ¡†æ¶æ¥ä½¿ç”¨ ï¼Œ vaporé‡Œé¢æœ‰æ„æ€çš„ä¸œè¥¿å¾ˆå¤š ï¼Œ è¿™é‡Œåªä»‹ç»åŸºæœ¬çš„æ“ä½œè€Œä¸æ·±ç©¶å…¶åŸç† ã€‚ Installå‰ç½®æ¡ä»¶ ï¼Œ è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨macOSè¿›è¡Œå¼€å‘éƒ¨ç½² ï¼Œ ä»¥ä¸‹æ˜¯éœ€è¦è½¯ä»¶å’Œç‰ˆæœ¬ã€‚ Install Xcode 9.3 or greater from the Mac App Store. Vapor requires Swift 4.1 or greater. Vapor Toolbox: 3.1.7 Vapor Framework: 3.0.8 homeBrew æ¥ç€ä½¿ç”¨homeBrewå®‰è£… 1brew install vapor/tap/vapor Get Startedç°åœ¨vaporå·²ç»è£…å¥½äº† ï¼Œ æˆ‘ä»¬å¯ä»¥å…ˆæŠŠåŸºæœ¬çš„å‡†å¤‡å·¥ä½œå¼„å¥½ ä½¿ç”¨vaporåˆå§‹åŒ–å·¥ç¨‹ 1vapor new blockChainServer ç”Ÿæˆå·¥ç¨‹æ–‡ä»¶ 1vapor xcode æ¥ç€æ‰“å¼€ blockChainServer.xcodeproj æ–‡ä»¶ ï¼Œ åœ¨å¯¼èˆªä¸Šçš„schemaä¸Šé€‰æ‹© run ï¼Œæ¥ç€æŒ‰ä¸‹ command + R è¿™æ—¶ä½ åº”èƒ½å¤Ÿåœ¨æ§åˆ¶å°çœ‹åˆ°è¾“å‡ºçš„serveråœ°å€äº† Practiceåˆ°ç°åœ¨æˆ‘ä»¬ä¸€åˆ‡å‡†å¤‡å·¥ä½œéƒ½å°±ç»ªäº† ï¼Œ é‚£ä¹ˆå¼€å§‹é¼“æ£ä¸ªåŒºå—é“¾apiå‡ºæ¥å§ ã€‚ Base modelåŒºå—é“¾çš„åŸºæœ¬æ¦‚å¿µä¸Šé¢ä»‹ç»äº† ï¼Œ åŒ…å«ä»¥ä¸‹å‡ ç±» ï¼Œ æˆ‘ä»¬ä½¿ç”¨oopå¯ä»¥æŠ½è±¡å‡ºä»¥ä¸‹ä¸€å †class Transaction äº¤æ˜“ Block åŒºå— Blockchain åŒºå—é“¾ BlockChainNode åŒºå—é“¾èŠ‚ç‚¹ æ’åˆ—ç”±ä¸‹å‘ä¸Šå­˜åœ¨é›†åˆå…³ç³» ã€‚ å…¶å®è¿™é‡Œé¢æœ€ååº”è¯¥åŠ ä¸Šä¸€ä¸ªåŒºå—ç½‘ç»œ ï¼Œ ä¸è¿‡è¿™é‡Œæˆ‘ä»¬æš‚æ—¶ä¸éœ€è¦å®ç°å…¨éƒ¨ç½‘ç»œ ï¼Œ æä¸ªå†…ç½‘çš„å…ˆè€è€å°±å¥½ ä¸‹é¢åˆ†åˆ«æ¥çœ‹ä¸‹å‡ ä¸ªmodelçš„ä»£ç  ps:è¿™é‡Œçš„æ¡†æ¶æ·»åŠ çš„åè®®å’Œæ‰©å±•å¾ˆå¤š ï¼Œ ä¸åœ¨æ­¤è¿‡å¤šä»‹ç» ï¼Œ è¯·æŠŠå…³æ³¨ç‚¹æ”¾åœ¨classæœ¬èº« Transaction.swift 12345678910111213141516171819202122import Foundationimport FluentSQLiteimport Vaporfinal class Transaction: Codable,SQLiteModel &#123; var id: Int? var from: String var to: String var amount: Double init(from: String, to: String, amount: Double) &#123; self.from = from self.to = to self.amount = amount &#125;&#125;extension Transaction: Content &#123; &#125;extension Transaction: Migration &#123; &#125;extension Transaction: Parameter &#123; &#125; è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®šä¹‰äº†å‡ ä¸ªproperty ï¼Œ idæ˜¯SQLiteModelåè®®éœ€è¦å®ç°çš„ ï¼Œ è¿™é‡Œåªè¦è®°ä½æ˜¯ä¸ºäº†æ•°æ®æŒä¹…åŒ–å°±å¥½ to : äº¤æ˜“çš„æ¥æ”¶æ–¹ from : äº¤æ˜“çš„å‘èµ·æ–¹ amount : é‡‘é¢ Block.swift 12345678910111213141516171819202122232425262728293031323334353637383940414243444546import FluentSQLiteimport Vaporfinal class Block: Codable,SQLiteModel &#123; var id: Int? var index: Int = 0 var dateCreated: String var previousHash: String! var hash: String! var nonce: Int var message: String = \"\" private (set) var transactions: [Transaction] = [Transaction]() var key: String &#123; get &#123; let transactionsData = try! JSONEncoder().encode(transactions) let transactionsJSONString = String(data: transactionsData, encoding: .utf8) return String(index) + dateCreated + previousHash + transactionsJSONString! + String(nonce) &#125; &#125; @discardableResult func addTransaction(transaction: Transaction) -&gt; Block&#123; transactions.append(transaction) return self &#125; init() &#123; dateCreated = Date().toString() nonce = 0 message = \"æŒ–å‡ºæ–°çš„åŒºå—\" &#125; init(transaction: Transaction) &#123; dateCreated = Date().toString() nonce = 0 addTransaction(transaction: transaction) &#125;&#125;extension Block: Content &#123; &#125;extension Block: Migration &#123; &#125;extension Block: Parameter &#123; &#125; index : åŒºå—åºå· dateCreated : åˆ›å»ºæ—¥æœŸ previousHash : å‰ä¸€ä¸ªåŒºå—çš„å“ˆå¸Œå€¼ hash : å½“å‰åŒºå—çš„å“ˆå¸Œå€¼ nonce : å…ˆè®°ä½å’Œå·¥ä½œé‡è¯æ˜æœ‰å…³ message : è¿™é‡Œæ˜¯ä¸ºäº†æˆ‘ä»¬çœ‹åˆ°è¾“å‡º Blockchain.swift 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566import Foundationimport FluentSQLiteimport Vaporfinal class Blockchain: Codable,SQLiteModel &#123; var id: Int? var blocks: [Block] = [Block]() init() &#123; &#125; init(_ genesisBlock: Block) &#123; self.addBlock(genesisBlock) &#125; func addBlock(_ block: Block) &#123; if self.blocks.isEmpty &#123; // æ·»åŠ åˆ›ä¸–åŒºå— // ç¬¬ä¸€ä¸ªåŒºå—æ²¡æœ‰ previous hash block.previousHash = \"0\" &#125; else &#123; let previousBlock = getPreviousBlock() block.previousHash = previousBlock.hash block.index = self.blocks.count &#125; block.hash = generateHash(for: block) self.blocks.append(block) block.message = \"æ­¤åŒºå—å·²æ·»åŠ è‡³åŒºå—é“¾\" &#125; private func getPreviousBlock() -&gt; Block &#123; return self.blocks[self.blocks.count - 1] &#125; private func displayBlock(_ block: Block) &#123; print(\"------ ç¬¬ \\(block.index) ä¸ªåŒºå— --------\") print(\"åˆ›å»ºæ—¥æœŸï¼š\\(block.dateCreated)\") // print(\"æ•°æ®ï¼š\\(block.data)\") print(\"Nonceï¼š\\(block.nonce)\") print(\"å‰ä¸€ä¸ªåŒºå—çš„å“ˆå¸Œå€¼ï¼š\\(block.previousHash!)\") print(\"å“ˆå¸Œå€¼ï¼š\\(block.hash!)\") &#125; private func generateHash(for block: Block) -&gt; String &#123; var hash = block.key.sha1Hash() // è®¾ç½®å·¥ä½œé‡è¯æ˜ while(!hash.hasPrefix(\"11\")) &#123; block.nonce += 1 hash = block.key.sha1Hash() print(hash) &#125; return hash &#125;&#125;extension Blockchain: Content &#123; &#125;extension Blockchain: Migration &#123; &#125;extension Blockchain: Parameter &#123; &#125; BlockChainNode.swift 1234567891011121314151617import FluentSQLiteimport Vaporfinal class BlockChainNode: Codable,SQLiteModel &#123; var id: Int? var address :String init(addr:String) &#123; address = addr &#125;&#125;extension BlockChainNode: Content &#123; &#125;extension BlockChainNode: Migration &#123; &#125;extension BlockChainNode: Parameter &#123; &#125; address : èŠ‚ç‚¹åœ°å€ Actionè¿™é‡Œæ¶‰åŠåˆ°çš„äº‹ä»¶ä¸»è¦æ˜¯è®¡ç®—hash ï¼Œ æˆ‘ä»¬åœ¨è¿™é‡Œé¢ç»™String æ·»åŠ ä¸€ä¸ªextension 12345678910111213141516171819202122extension String &#123; func sha1Hash() -&gt; String &#123; let task = Process() task.launchPath = \"/usr/bin/shasum\" task.arguments = [] let inputPipe = Pipe() inputPipe.fileHandleForWriting.write(self.data(using: .utf8)!) inputPipe.fileHandleForWriting.closeFile() let outputPipe = Pipe() task.standardOutput = outputPipe task.standardInput = inputPipe task.launch() let data = outputPipe.fileHandleForReading.readDataToEndOfFile() let hash = String(data: data, encoding: .utf8)! return hash.replacingOccurrences(of: \" -\\n\", with: \"\") &#125;&#125; ç»™dateä¹Ÿæ·»åŠ ä¸€ä¸ªä¾¿äºæˆ‘ä»¬è¾“å‡ºåŒºå—åˆ›å»ºæ—¶é—´ 1234567extension Date &#123; func toString() -&gt; String &#123; let formatter = DateFormatter() formatter.dateFormat = \"yyyy-MM-dd HH:mm:ss\" return formatter.string(from: self) &#125;&#125; Serviceåœ¨è¿™é‡Œæˆ‘ä»¬æŠŠæ‰€æœ‰å¯¹åŒºå—é“¾çš„æ“ä½œæŠ½è±¡ä¸ºä¸€ä¸ªserviceç±» BlockchainService.swift 1234567891011121314151617181920212223242526272829303132333435363738import Foundationimport Vaporclass BlockchainService &#123; private var blockchain: Blockchain = Blockchain() private var nodes = [BlockChainNode]() init() &#123; &#125; func addBlock(_ block: Block) -&gt; Block &#123; self.blockchain.addBlock(block) return block &#125; func getLastBlock() -&gt; Block &#123; guard let lastB = self.blockchain.blocks.last else &#123; return addBlock(Block()) &#125; return lastB; &#125; func getBlockchain() -&gt; Blockchain &#123; return self.blockchain &#125; func registerNode(_ node:BlockChainNode) -&gt; BlockChainNode &#123; self.nodes.append(node) return node &#125; func getAllNodes() -&gt; [BlockChainNode] &#123; return nodes &#125;&#125; Controller &amp; Routerè¿™é‡Œæˆ‘ä»¬åŸºæœ¬å®Œæˆäº†æ‰€æœ‰åŸºæœ¬æ¨¡å‹çš„æ­å»º ï¼Œ ç°åœ¨éœ€è¦å¯¹æˆ‘ä»¬çš„serverè¿›è¡Œæ“ä½œ ï¼Œ è®©æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„é€šè¿‡curlè°ƒç”¨æˆ‘ä»¬çš„åŒºå—é“¾ç³»ç»Ÿ ã€‚ BlockChainController.swift 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263import Foundationimport Vaporstruct BCError:LocalizedError &#123; let name:String&#125;final class BlockChainController &#123; let bcService = BlockchainService() func addBlock(_ req: Request) throws -&gt; Future&lt;Block&gt; &#123; return bcService.addBlock(Block()).save(on: req) &#125; func addTransaction(_ req: Request) throws -&gt; Future&lt;Block&gt; &#123; return try req.content.decode(Transaction.self).flatMap&#123; transation in return self.bcService.getLastBlock().addTransaction(transaction: transation).save(on: req) &#125; &#125; func findBlockChain(_ req: Request) throws -&gt; Future&lt;Blockchain&gt; &#123; return bcService.getBlockchain().save(on: req) &#125; func registeNode(_ req: Request) throws -&gt; Future&lt;BlockChainNode&gt; &#123; return try req.content.decode(BlockChainNode.self).flatMap&#123; node in return self.bcService.registerNode(node).save(on: req) &#125; &#125; func allNodes(_ req: Request) throws -&gt; Future&lt;[BlockChainNode]&gt; &#123; return BlockChainNode.query(on: req).all() &#125; func resolve(_ req: Request) throws -&gt; Future&lt;Blockchain&gt; &#123; let promise = req.eventLoop.newPromise(Blockchain.self) bcService.getAllNodes().forEach &#123; node in guard let url = URL(string: \"http://\\(node.address)/blockchain\") else &#123;return promise.fail(error: BCError(name: \"node error\"))&#125; URLSession.shared.dataTask(with: url, completionHandler: &#123; (data, _, _) in if let data = data &#123; guard let bc = try? JSONDecoder().decode(Blockchain.self, from: data) else &#123;return promise.fail(error: BCError(name: \"json error\"))&#125; if self.bcService.getBlockchain().blocks.count &lt; bc.blocks.count &#123; self.bcService.getBlockchain().blocks = bc.blocks &#125; promise.succeed(result: self.bcService.getBlockchain()) &#125; else &#123; promise.fail(error: BCError(name: \"data Error\")) &#125; &#125;).resume() &#125; return promise.futureResult &#125;&#125; routes.swift 1234567891011121314151617import Vapor/// Register your application's routes here.public func routes(_ router: Router) throws &#123; // Basic \"Hello, world!\" example router.get(\"hello\") &#123; req in return \"Hello, world!\" &#125; let bcc = BlockChainController() router.post(\"block\", use: bcc.addBlock) router.post(\"transaction\", use: bcc.addTransaction) router.get(\"blockchain\", use: bcc.findBlockChain) router.post(\"node\", use: bcc.registeNode) router.get(\"node\", use: bcc.allNodes) router.post(\"resolve\", use: bcc.resolve)&#125; ç°åœ¨è§£é‡Šä¸€ä¸‹æˆ‘ä»¬æ³¨å†Œçš„apiéƒ½æ˜¯å¹²å•¥çš„ ps:APIå±‚éµå®ˆrestfull post(â€œblockâ€, use: bcc.addBlock) å¢åŠ ä¸€ä¸ªåŒºå— post(â€œtransactionâ€, use: bcc.addTransaction) æ–°å¢ä¸€ç¬”äº¤æ˜“ get(â€œblockchainâ€, use: bcc.findBlockChain) æŸ¥è¯¢åŒºå—é“¾ post(â€œnodeâ€, use: bcc.registeNode) å¢åŠ èŠ‚ç‚¹ get(â€œnodeâ€, use: bcc.allNodes) è·å–å…¨éƒ¨èŠ‚ç‚¹ post(â€œresolveâ€, use: bcc.resolve) è§£å†³å†²çª Exampleä¸‹é¢æˆ‘ä»¬å¯ä»¥è®©æœåŠ¡è¿è¡Œèµ·æ¥ ï¼Œ ç„¶åé€šè¿‡curlå‘½ä»¤è¡Œæ¥è°ƒç”¨åŒºå—é“¾ç³»ç»Ÿ ï¼Œ ç¼–è¯‘å·¥ç¨‹è¿›å…¥æˆ‘ä»¬çš„å·¥ç¨‹ç›®å½• ï¼Œ æ‰§è¡Œå‘½ä»¤ 1vapor build ä½ åº”èƒ½çœ‹åˆ°ä»¥ä¸‹è¾“å‡º 1Building Project [Done] è¿™è¯´æ˜æˆ‘ä»¬çš„å·¥ç¨‹å¯ä»¥è¿è¡Œäº† è¿è¡Œå·¥ç¨‹1vapor run serve --port=8080 æˆ‘ä»¬åœ¨æœ¬åœ°8080ç«¯å£ä¸Šå¼€å¯æˆ‘ä»¬çš„æœåŠ¡ è¿™æ—¶åº”èƒ½çœ‹åˆ°å¦‚ä¸‹è¾“å‡º 123456789Running blockChainServer ...[ INFO ] Migrating 'sqlite' database (/Users/felix/Documents/TestFolder/blockChainServer/.build/checkouts/fluent.git-6251908308727715749/Sources/Fluent/Migration/MigrationConfig.swift:69)[ INFO ] Preparing migration 'Todo' (/Users/felix/Documents/TestFolder/blockChainServer/.build/checkouts/fluent.git-6251908308727715749/Sources/Fluent/Migration/Migrations.swift:111)[ INFO ] Preparing migration 'Block' (/Users/felix/Documents/TestFolder/blockChainServer/.build/checkouts/fluent.git-6251908308727715749/Sources/Fluent/Migration/Migrations.swift:111)[ INFO ] Preparing migration 'Blockchain' (/Users/felix/Documents/TestFolder/blockChainServer/.build/checkouts/fluent.git-6251908308727715749/Sources/Fluent/Migration/Migrations.swift:111)[ INFO ] Preparing migration 'BlockChainNode' (/Users/felix/Documents/TestFolder/blockChainServer/.build/checkouts/fluent.git-6251908308727715749/Sources/Fluent/Migration/Migrations.swift:111)[ INFO ] Migrations complete (/Users/felix/Documents/TestFolder/blockChainServer/.build/checkouts/fluent.git-6251908308727715749/Sources/Fluent/Migration/MigrationConfig.swift:73)[Deprecated] --option=value syntax is deprecated. Please use --option value (with no =) instead.Server starting on http://localhost:8080 ç°åœ¨æˆ‘ä»¬åªè¦ç”¨apiè°ƒç”¨ä»¥ä¸‹ ï¼Œ æœ¬æœºçš„åŒºå—é“¾ç³»ç»Ÿå°±ä¼šå“åº”äº† ï¼Œ è®©æˆ‘ä»¬è¯•ä¸€ä¸‹å§ åˆ›å»ºåŒºå—1curl -s -X POST localhost:8080/block ä½ ä¼šåœ¨ä¸€æ®µæ—¶é—´åçœ‹åˆ°å“åº” 12345678910&#123; \"dateCreated\": \"2018-08-11 17:19:01\", \"hash\": \"1124aa2a5867abee8b9cc3a3f4051b6665f89e26\", \"id\": 1, \"index\": 0, \"message\": \"\\u6b64\\u533a\\u5757\\u5df2\\u6dfb\\u52a0\\u81f3\\u533a\\u5757\\u94fe\", \"nonce\": 193, \"previousHash\": \"0\", \"transactions\": []&#125; æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªblockå·²ç»åˆ›å»ºæˆåŠŸå¹¶ä¸”è¢«åŠ å…¥åŒºå—é“¾é‡Œäº† ï¼Œ ä»–çš„previousHashä¸ºâ€œ0â€æ˜¯å› ä¸ºä»–æ˜¯åˆ›ä¸–åŒºå— ã€‚ æ·»åŠ äº¤æ˜“æˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ å‡ ç¬”äº¤æ˜“çœ‹çœ‹ 1curl -s -X POST localhost:8080/transaction --data \"from=Felix&amp;to=mayun&amp;amount=100\" | python -m json.tool dataé‡Œé¢è¡¨ç¤º Felixå‘mayunè½¬è´¦100 æ¯æ¬¡æ·»åŠ åä½ å°†ä¼šå¾—åˆ°åŒºå—çš„æœ€æ–°ä¿¡æ¯ 12345678910111213141516&#123; \"dateCreated\": \"2018-08-11 17:19:01\", \"hash\": \"1124aa2a5867abee8b9cc3a3f4051b6665f89e26\", \"id\": 1, \"index\": 0, \"message\": \"\\u6b64\\u533a\\u5757\\u5df2\\u6dfb\\u52a0\\u81f3\\u533a\\u5757\\u94fe\", \"nonce\": 193, \"previousHash\": \"0\", \"transactions\": [ &#123; \"amount\": 100, \"from\": \"Felix\", \"to\": \"mayun\" &#125; ]&#125; æŸ¥è¯¢é“¾æˆ‘ä»¬å¯ä»¥é‡å¤ä»¥ä¸Šæ“ä½œå‡ æ¬¡ ã€‚ ç„¶åæŸ¥çœ‹æ•´ä¸ªåŒºå—é“¾ä¿¡æ¯ 1curl -s -X GET localhost:8080/blockchain | python -m json.tool ä½ ä¼šçœ‹åˆ°è•¾ä¸å¦‚ä¸‹è¾“å‡º 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&#123; \"blocks\": [ &#123; \"dateCreated\": \"2018-08-11 17:19:01\", \"hash\": \"1124aa2a5867abee8b9cc3a3f4051b6665f89e26\", \"id\": 1, \"index\": 0, \"message\": \"\\u6b64\\u533a\\u5757\\u5df2\\u6dfb\\u52a0\\u81f3\\u533a\\u5757\\u94fe\", \"nonce\": 193, \"previousHash\": \"0\", \"transactions\": [ &#123; \"amount\": 100, \"from\": \"Felix\", \"to\": \"mayun\" &#125;, &#123; \"amount\": 100, \"from\": \"Felix\", \"to\": \"mayun\" &#125; ] &#125;, &#123; \"dateCreated\": \"2018-08-11 17:27:39\", \"hash\": \"11bec5f7bf8226c62119adfbb03ad37d24267092\", \"id\": 2, \"index\": 1, \"message\": \"\\u6b64\\u533a\\u5757\\u5df2\\u6dfb\\u52a0\\u81f3\\u533a\\u5757\\u94fe\", \"nonce\": 277, \"previousHash\": \"1124aa2a5867abee8b9cc3a3f4051b6665f89e26\", \"transactions\": [ &#123; \"amount\": 100, \"from\": \"Felix\", \"to\": \"mayun\" &#125;, &#123; \"amount\": 100, \"from\": \"Felix\", \"to\": \"mayun\" &#125; ] &#125; ], \"id\": 1&#125; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°Felixä¸åœçš„å‘mayunè½¬100å— ï¼Œ çœŸä¸è¦è„¸ ã€‚ èŠ‚ç‚¹ä»¥åŠè§£å†³å†²çªåŒºå—é“¾åŒæ—¶å­˜åœ¨ä¸å¤šä¸ªä¸»æœºä¸Š ï¼Œ ä¹Ÿå°±æ˜¯è¯´ä¼šæœ‰å¾ˆå¤šçš„block-chain-serverè¿è¡Œ ï¼Œ è€Œå¯¹äºä¸åŒçš„è¿ç®—ä¼šæœ‰å¤šä¸ªè§£äº§ç”Ÿ ï¼Œ è¿™å°±æ˜¯å†²çªé—®é¢˜äº† ï¼Œ é‚£ä¹ˆæˆ‘ä»¬çœ‹ä¸‹å†²çªè§£å†³çš„è¿‡ç¨‹å§ é¦–å…ˆ ï¼Œ æˆ‘ä»¬åœ¨8081ç«¯å£åŒæ—¶å¼€å¯ä¸€ä¸ªæœåŠ¡ 1vapor run serve --port=8081 ç„¶åæ·»åŠ å‡ ä¸ªåŒºå—å’Œäº¤æ˜“ ï¼Œ å› ä¸ºæˆ‘ä»¬è¦éªŒè¯è§£å†³å†²çª ï¼Œ æ‰€ä»¥åº”è¯¥æ¯”è¿è¡Œåœ¨8080ç«¯å£ä¸Šçš„åŒºå—å¤š ã€‚ 1curl -s -X POST localhost:8081/block | python -m json.tool é‡å¤å‡ æ¬¡æ“ä½œ ï¼Œ æœ€åçœ‹ä¸‹8081ä¼¤çš„blockchain 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115&#123; \"blocks\": [ &#123; \"dateCreated\": \"2018-08-11 17:35:15\", \"hash\": \"1152cb1aac50abd803a4589f28c7e054db207e23\", \"id\": 1, \"index\": 0, \"message\": \"\\u6b64\\u533a\\u5757\\u5df2\\u6dfb\\u52a0\\u81f3\\u533a\\u5757\\u94fe\", \"nonce\": 215, \"previousHash\": \"0\", \"transactions\": [ &#123; \"amount\": 200, \"from\": \"mayun\", \"to\": \"Felix\" &#125;, &#123; \"amount\": 200, \"from\": \"mayun\", \"to\": \"Felix\" &#125;, &#123; \"amount\": 200, \"from\": \"mayun\", \"to\": \"Felix\" &#125; ] &#125;, &#123; \"dateCreated\": \"2018-08-11 17:37:18\", \"hash\": \"1127f8c712ae3205ccbab9788392bcd190b8b6b1\", \"id\": 2, \"index\": 1, \"message\": \"\\u6b64\\u533a\\u5757\\u5df2\\u6dfb\\u52a0\\u81f3\\u533a\\u5757\\u94fe\", \"nonce\": 380, \"previousHash\": \"1152cb1aac50abd803a4589f28c7e054db207e23\", \"transactions\": [ &#123; \"amount\": 200, \"from\": \"mayun\", \"to\": \"Felix\" &#125;, &#123; \"amount\": 200, \"from\": \"mayun\", \"to\": \"Felix\" &#125; ] &#125;, &#123; \"dateCreated\": \"2018-08-11 17:37:39\", \"hash\": \"11b5d293c3068081f1771f14f96a3e450f282171\", \"id\": 3, \"index\": 2, \"message\": \"\\u6b64\\u533a\\u5757\\u5df2\\u6dfb\\u52a0\\u81f3\\u533a\\u5757\\u94fe\", \"nonce\": 64, \"previousHash\": \"1127f8c712ae3205ccbab9788392bcd190b8b6b1\", \"transactions\": [ &#123; \"amount\": 200, \"from\": \"mayun\", \"to\": \"Felix\" &#125;, &#123; \"amount\": 200, \"from\": \"mayun\", \"to\": \"Felix\" &#125; ] &#125;, &#123; \"dateCreated\": \"2018-08-11 17:37:45\", \"hash\": \"11d97dfca7cc7a67c22b9df06017768fca0a193f\", \"id\": 4, \"index\": 3, \"message\": \"\\u6b64\\u533a\\u5757\\u5df2\\u6dfb\\u52a0\\u81f3\\u533a\\u5757\\u94fe\", \"nonce\": 125, \"previousHash\": \"11b5d293c3068081f1771f14f96a3e450f282171\", \"transactions\": [ &#123; \"amount\": 200, \"from\": \"mayun\", \"to\": \"Felix\" &#125;, &#123; \"amount\": 200, \"from\": \"mayun\", \"to\": \"Felix\" &#125; ] &#125;, &#123; \"dateCreated\": \"2018-08-11 17:38:03\", \"hash\": \"115a991bd5d2ebe6e232b421965ab852b97a4202\", \"id\": 5, \"index\": 4, \"message\": \"\\u6b64\\u533a\\u5757\\u5df2\\u6dfb\\u52a0\\u81f3\\u533a\\u5757\\u94fe\", \"nonce\": 220, \"previousHash\": \"11d97dfca7cc7a67c22b9df06017768fca0a193f\", \"transactions\": [ &#123; \"amount\": 200, \"from\": \"mayun\", \"to\": \"Felix\" &#125;, &#123; \"amount\": 200, \"from\": \"mayun\", \"to\": \"Felix\" &#125; ] &#125; ], \"id\": 1&#125; ç„¶åæˆ‘ä»¬è¦è®©8080çŸ¥é“æœ‰è¿™ä¹ˆä¸€ä¸ªèŠ‚ç‚¹ 1curl -s -X POST localhost:8080/node --data \"address=localhost:8081\" | python -m json.tool æˆ‘ä»¬ä¼šçœ‹åˆ°èŠ‚ç‚¹å·²ç»æ³¨å†ŒæˆåŠŸäº† 1234&#123; \"address\": \"localhost:8081\", \"id\": 1&#125; è¿™æ—¶æˆ‘ä»¬è®©8080å»ä¸»åŠ¨è§£å†³å†²çª 1curl -s -X POST localhost:8080/resolve | python -m json.tool å†æŸ¥çœ‹8080ä¸Šçš„åŒºå—é“¾ ï¼Œ å‘ç°å·²ç»è¢«æ›¿æ¢ä¸ºè¾ƒé•¿çš„8081ä¸Šçš„blocksäº†ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115&#123; \"blocks\": [ &#123; \"dateCreated\": \"2018-08-11 17:35:15\", \"hash\": \"1152cb1aac50abd803a4589f28c7e054db207e23\", \"id\": 1, \"index\": 0, \"message\": \"\\u6b64\\u533a\\u5757\\u5df2\\u6dfb\\u52a0\\u81f3\\u533a\\u5757\\u94fe\", \"nonce\": 215, \"previousHash\": \"0\", \"transactions\": [ &#123; \"amount\": 200, \"from\": \"mayun\", \"to\": \"Felix\" &#125;, &#123; \"amount\": 200, \"from\": \"mayun\", \"to\": \"Felix\" &#125;, &#123; \"amount\": 200, \"from\": \"mayun\", \"to\": \"Felix\" &#125; ] &#125;, &#123; \"dateCreated\": \"2018-08-11 17:37:18\", \"hash\": \"1127f8c712ae3205ccbab9788392bcd190b8b6b1\", \"id\": 2, \"index\": 1, \"message\": \"\\u6b64\\u533a\\u5757\\u5df2\\u6dfb\\u52a0\\u81f3\\u533a\\u5757\\u94fe\", \"nonce\": 380, \"previousHash\": \"1152cb1aac50abd803a4589f28c7e054db207e23\", \"transactions\": [ &#123; \"amount\": 200, \"from\": \"mayun\", \"to\": \"Felix\" &#125;, &#123; \"amount\": 200, \"from\": \"mayun\", \"to\": \"Felix\" &#125; ] &#125;, &#123; \"dateCreated\": \"2018-08-11 17:37:39\", \"hash\": \"11b5d293c3068081f1771f14f96a3e450f282171\", \"id\": 3, \"index\": 2, \"message\": \"\\u6b64\\u533a\\u5757\\u5df2\\u6dfb\\u52a0\\u81f3\\u533a\\u5757\\u94fe\", \"nonce\": 64, \"previousHash\": \"1127f8c712ae3205ccbab9788392bcd190b8b6b1\", \"transactions\": [ &#123; \"amount\": 200, \"from\": \"mayun\", \"to\": \"Felix\" &#125;, &#123; \"amount\": 200, \"from\": \"mayun\", \"to\": \"Felix\" &#125; ] &#125;, &#123; \"dateCreated\": \"2018-08-11 17:37:45\", \"hash\": \"11d97dfca7cc7a67c22b9df06017768fca0a193f\", \"id\": 4, \"index\": 3, \"message\": \"\\u6b64\\u533a\\u5757\\u5df2\\u6dfb\\u52a0\\u81f3\\u533a\\u5757\\u94fe\", \"nonce\": 125, \"previousHash\": \"11b5d293c3068081f1771f14f96a3e450f282171\", \"transactions\": [ &#123; \"amount\": 200, \"from\": \"mayun\", \"to\": \"Felix\" &#125;, &#123; \"amount\": 200, \"from\": \"mayun\", \"to\": \"Felix\" &#125; ] &#125;, &#123; \"dateCreated\": \"2018-08-11 17:38:03\", \"hash\": \"115a991bd5d2ebe6e232b421965ab852b97a4202\", \"id\": 5, \"index\": 4, \"message\": \"\\u6b64\\u533a\\u5757\\u5df2\\u6dfb\\u52a0\\u81f3\\u533a\\u5757\\u94fe\", \"nonce\": 220, \"previousHash\": \"11d97dfca7cc7a67c22b9df06017768fca0a193f\", \"transactions\": [ &#123; \"amount\": 200, \"from\": \"mayun\", \"to\": \"Felix\" &#125;, &#123; \"amount\": 200, \"from\": \"mayun\", \"to\": \"Felix\" &#125; ] &#125; ], \"id\": 1&#125; summaryå¯ä»¥çœ‹åˆ°å¤§æ¦‚åŒºå—é“¾çš„è®¾è®¡è¿˜æ˜¯æ¯”è¾ƒæœ‰æ„æ€çš„ ï¼Œ ç»†èŠ‚éƒ¨åˆ†è¯·ä¸è¦åœ¨æ„ï¼ˆæ¯”å¦‚sha1å’Œprefixâ€œ11â€ ğŸ˜„ï¼‰ åŸºæœ¬çš„ä»‹ç»å°±åˆ°è¿™é‡Œå•¦ ï¼Œ é™äºæœ¬äººçš„æ°´å¹³å¯èƒ½ä¼šæœ‰é”™è¯¯è¯·ä¸è¦å…¨ä¿¡ ã€‚ æ‰“æ‰°äº† .","categories":[],"tags":[{"name":"swift","slug":"swift","permalink":"https://felixplusplus.github.io/tags/swift/"},{"name":"blockChain","slug":"blockChain","permalink":"https://felixplusplus.github.io/tags/blockChain/"}]},{"title":"ç£¨åˆ€ä¸è¯¯ç æŸ´ä¹‹cocoapods","slug":"cocoapod","date":"2018-07-25T02:02:38.000Z","updated":"2018-08-18T10:50:01.167Z","comments":true,"path":"2018/07/25/cocoapod/","link":"","permalink":"https://felixplusplus.github.io/2018/07/25/cocoapod/","excerpt":"","text":"ç®€ä»‹ CocoaPodsæ˜¯OS Xå’ŒiOSä¸‹çš„ä¸€ä¸ªç¬¬ä¸‰ç±»åº“ç®¡ç†å·¥å…·ï¼Œé€šè¿‡CocoaPodså·¥å…·æˆ‘ä»¬å¯ä»¥ä¸ºé¡¹ç›®æ·»åŠ è¢«ç§°ä¸ºâ€œPodsâ€çš„ä¾èµ–åº“ï¼ˆè¿™äº›ç±»åº“å¿…é¡»æ˜¯CocoaPodsæœ¬èº«æ‰€æ”¯æŒçš„ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥è½»æ¾ç®¡ç†å…¶ç‰ˆæœ¬ã€‚ CocoaPodsæ„ä¹‰ä½“ç°åœ¨ä¸¤ä¸ªæ–¹é¢ï¼š ç¬¬ä¸€ï¼Œåœ¨å¼•å…¥ç¬¬ä¸‰æ–¹åº“æ—¶å®ƒå¯ä»¥è‡ªåŠ¨ä¸ºæˆ‘ä»¬å®Œæˆå„ç§å„æ ·çš„é…ç½®ï¼ŒåŒ…æ‹¬é…ç½®ç¼–è¯‘é˜¶æ®µã€è¿æ¥å™¨é€‰é¡¹ã€ç”šè‡³æ˜¯ARCç¯å¢ƒä¸‹çš„-fno-objc-arcé…ç½®ç­‰ã€‚ ç¬¬äºŒï¼Œä½¿ç”¨CocoaPodså¯ä»¥å¾ˆæ–¹ä¾¿åœ°æŸ¥æ‰¾æ–°çš„ç¬¬ä¸‰æ–¹åº“ï¼Œè¿™äº›ç±»åº“æ˜¯æ¯”è¾ƒâ€œæ ‡å‡†çš„â€ï¼Œè€Œä¸æ˜¯ç½‘ä¸Šéšä¾¿æ‰¾åˆ°çš„ï¼Œè¿™æ ·å¯ä»¥è®©æˆ‘ä»¬æ‰¾åˆ°çœŸæ­£å¥½ç”¨çš„ç±»åº“ã€‚ å®‰è£…ä½¿ç”¨å®‰è£…1sudo gem install cocoapods æŸ¥çœ‹ç‰ˆæœ¬1pod --version åœ¨å¼€å‘ä¸­å®‰è£…ä½¿ç”¨cocoapodsè¦æ³¨æ„ç‰ˆæœ¬ ï¼Œ å› ä¸ºä¸€èˆ¬å¼€å‘è¿‡ç¨‹ä¸­è¦å¤§å®¶ä¸€èµ·ä½¿ç”¨åŒä¸€ä¸ªå·¥ç¨‹ ï¼Œä¸€èˆ¬ä¸ºäº†æŒ‡å®šç‰ˆæœ¬æˆ‘ä»¬ä¼šåœ¨å·¥ç¨‹ä¸‹å­˜æ”¾ä¸€ä¸ªGemfileæ¥æŒ‡å®šä½¿ç”¨cocoapodsçš„ç‰ˆæœ¬ ï¼Œ è¿™é‡Œä¸è¿‡å¤šä»‹ç» ã€‚ æŒ‡å®šç‰ˆæœ¬é™¤äº†æŒ‡å®šGemfileä»¥å¤– ï¼Œ æˆ‘ä»¬è¿˜å¯ä»¥å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„pods 1sudo gem install cocoapods -v 1.3.1 å†æŸ¥çœ‹ä¸€ä¸‹podç‰ˆæœ¬æˆ‘ä»¬å°±ä¼šå‘ç°å·²ç»å®‰è£…äº†1.3.1 1pod --version å¸è½½æ‰ä¸éœ€è¦çš„ç‰ˆæœ¬å½“æˆ‘ä»¬æœ¬åœ°åŒæ—¶å­˜åœ¨å¤šä¸ªç‰ˆæœ¬çš„podçš„æ—¶å€™å¯ä»¥æŠŠå¤šä½™çš„å¸è½½æ‰ 1sudo gem uninstall cocoapods ä¼šæç¤ºæˆ‘ä»¬é€‰æ‹©å¸è½½çš„ç‰ˆæœ¬ 12345Select gem to uninstall: 1. cocoapods-1.2.1 2. cocoapods-1.3.1 3. All versions&gt; æˆ‘ä»¬é€‰æ‹©æƒ³è¦å¸è½½çš„ç‰ˆæœ¬çš„åºå·å°±å¥½äº† ã€‚ æŸ¥æ‰¾cocoapodsæ”¯æŒæˆ‘ä»¬å»æŸ¥æ‰¾æƒ³è¦ä½¿ç”¨çš„ä»“åº“ , æ¯”å¦‚æˆ‘ä»¬æƒ³æŸ¥æ‰¾ReactoveObjCè¿™ä¸ªåº“ 1pod spec cat ReactiveObjC 1234567891011121314151617181920212223242526272829303132333435363738394041424344&#123; \"name\": \"ReactiveObjC\", \"version\": \"3.1.0\", \"summary\": \"The 2.x ReactiveCocoa Objective-C API: Streams of values over time\", \"description\": \"ReactiveObjC (formally ReactiveCocoa or RAC) is an Objective-C\\nframework inspired by [Functional Reactive Programming](\\nhttp://en.wikipedia.org/wiki/Functional_reactive_programming).\\nIt provides APIs for composing and **transforming streams of values**.\", \"homepage\": \"https://reactivecocoa.io\", \"screenshots\": \"https://reactivecocoa.io/img/logo.png\", \"license\": &#123; \"type\": \"MIT\", \"file\": \"LICENSE.md\" &#125;, \"documentation_url\": \"https://github.com/ReactiveCocoa/ReactiveObjC/tree/master/Documentation#readme\", \"authors\": \"ReactiveCocoa\", \"social_media_url\": \"https://twitter.com/ReactiveCocoa\", \"platforms\": &#123; \"ios\": \"8.0\", \"osx\": \"10.9\", \"watchos\": \"2.0\", \"tvos\": \"9.0\" &#125;, \"source\": &#123; \"git\": \"https://github.com/ReactiveCocoa/ReactiveObjC.git\", \"tag\": \"3.1.0\" &#125;, \"source_files\": [ \"ReactiveObjC/*.&#123;h,m,d&#125;\", \"ReactiveObjC/extobjc/*.&#123;h,m&#125;\" ], \"private_header_files\": [ \"**/*Private.h\", \"**/*EXTRuntimeExtensions.h\", \"**/RACEmpty*.h\" ], \"ios\": &#123; \"exclude_files\": \"ReactiveObjC/**/*&#123;AppKit,NSControl,NSText,NSTable&#125;*\" &#125;, \"osx\": &#123; \"exclude_files\": \"ReactiveObjC/**/*&#123;UIActionSheet,UIAlertView,UIBarButtonItem,UIButton,UICollectionReusableView,UIControl,UIDatePicker,UIGestureRecognizer,UIImagePicker,UIRefreshControl,UISegmentedControl,UISlider,UIStepper,UISwitch,UITableViewCell,UITableViewHeaderFooterView,UIText,MK&#125;*\" &#125;, \"tvos\": &#123; \"exclude_files\": \"ReactiveObjC/**/*&#123;AppKit,NSControl,NSText,NSTable,UIActionSheet,UIAlertView,UIDatePicker,UIImagePicker,UIRefreshControl,UISlider,UIStepper,UISwitch,MK&#125;*\" &#125;, \"watchos\": &#123; \"exclude_files\": \"ReactiveObjC/**/*&#123;UIActionSheet,UIAlertView,UIBarButtonItem,UIButton,UICollectionReusableView,UIControl,UIDatePicker,UIGestureRecognizer,UIImagePicker,UIRefreshControl,UISegmentedControl,UISlider,UIStepper,UISwitch,UITableViewCell,UITableViewHeaderFooterView,UIText,MK,AppKit,NSControl,NSText,NSTable,NSURLConnection&#125;*\" æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€å¤§å †æœ‰çš„æ²¡çš„ä¿¡æ¯ ï¼Œ åŒ…æ‹¬è¯¥podä»“åº“çš„å®é™…ä»“åº“çš„åœ°å€å’Œä¸€äº›baseä¿¡æ¯ å¼€å§‹ä½¿ç”¨é¦–å…ˆ ï¼Œ æ–°å»ºä¸€ä¸ªsinglgViewApp ï¼Œç„¶ååœ¨å‘½ä»¤è¡Œè¿›å…¥è¯¥projectç›®å½• 1pod init 12345678910# Uncomment the next line to define a global platform for your project# platform :ios, '9.0'target 'Test' do # Uncomment the next line if you're using Swift or would like to use dynamic frameworks # use_frameworks! # Pods for ocTestend æˆ‘ä»¬å¯ä»¥çœ‹åˆ°cocoapodsä¸ºæˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ªPodfileplatformè¡¨ç¤ºè¿™ä¸ªå·¥ç¨‹å®‰è£…çš„è®¾å¤‡ ï¼Œ åé¢æ˜¯ç³»ç»Ÿæœ€ä½ç‰ˆæœ¬ç°åœ¨æˆ‘ä»¬å¯ä»¥åœ¨é‡Œé¢æ·»åŠ ä¸€ä¸‹åˆšæ‰æœç´¢çš„ä»“åº“ 123456789# Uncomment the next line to define a global platform for your projectplatform :ios, '9.0'target 'ocTest' do # Uncomment the next line if you're using Swift or would like to use dynamic frameworks # use_frameworks! pod 'ReactiveObjC' # Pods for ocTestend è¿™é‡Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªä»“åº“ ï¼Œæ¥ä¸‹æ¥å†å‘½ä»¤è¡Œæ‰§è¡Œpod updateæ¥å®‰è£…æ‰€éœ€è¦çš„ä»“åº“ ï¼Œ å®‰è£…å®Œæ¯•åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“å‰è·¯å¾„ä¸‹æœ‰ä¸¤ä¸ªå·¥ç¨‹æ–‡ä»¶ Test.xcodeproj Test.xcworkspace æˆ‘ä»¬åœ¨ä½¿ç”¨äº†cocoapodsç®¡ç†ç¬¬ä¸‰æ–¹åº“çš„æ—¶å€™ ï¼Œ æ¯æ¬¡installæˆ–è€…updateçš„æ—¶å€™å°±ä¼šç”Ÿæˆ*.xcworkspaceè¿™ä¸ªæ–‡ä»¶ ï¼Œ æˆ‘ä»¬å°±ç”¨è¿™ä¸ªå·¥ç¨‹å¼€å‘è°ƒè¯•å°±å¥½äº† ã€‚ ç°åœ¨æ‰“å¼€å·¥ç¨‹ ï¼Œ å®šä½åˆ°viewController.mä¸­å°±å¯ä»¥å¼•ç”¨å¹¶ä½¿ç”¨ReactiveObjCå•¦ ã€‚ ä½¿ç”¨ç§æœ‰æºå…¬å¸å†…éƒ¨æœ‰è‡ªå·±æ­å»ºçš„gitlabæœåŠ¡æ—¶ ï¼Œ æœ‰çš„å…¬å¸æ­å»ºçš„gitlabæœåŠ¡ä¸ºäº†å®‰å…¨å¹¶æ²¡æœ‰æä¾›å¤–ç½‘æ¥å£ ï¼Œ æˆ‘ä»¬åªèƒ½åœ¨å†…ç½‘è®¿é—® ï¼Œ è¿™æ—¶å€™å°±è¦åœ¨podfileä¸­æ·»åŠ ç§æœ‰æºçš„åœ°å€ 12source 'http://xx.xxxx.com/ios/cocoapods-spec.git'source 'https://github.com/CocoaPods/Specs.git' # å®˜æ–¹åº“ ä¸Šé¢é‚£ä¸ªå°±æ˜¯æˆ‘ä»¬è¦æ·»åŠ çš„ç§æœ‰æºåœ°å€ ï¼Œ ä¸‹é¢çš„æ˜¯å®˜æ–¹æºåœ°å€ ï¼Œå¦‚æœéƒ½ä¸å†™çš„è¯é‚£ä¹ˆé»˜è®¤å°±ä¼šä½¿ç”¨å®˜æ–¹æº ã€‚ å‘å¸ƒè‡ªå·±çš„podå‘å¸ƒpodåˆ†ä¸ºå‘å¸ƒåˆ°å®˜æ–¹æºå’Œå‘å¸ƒåˆ°ç§æœ‰æº , è¿™é‡Œæš‚ä¸è¡¨å‘å¸ƒåˆ°å®˜æ–¹æº ã€‚é‡ç‚¹æ¥è®²ä¸€ä¸‹å‘å¸ƒåˆ°ç§æœ‰æº ã€‚ åˆ›å»ºä»“åº“1pod lib create TDFCommonUtil podä¼šç»™å‡ºä¸€äº›é€‰é¡¹è®©æˆ‘ä»¬é€‰æ‹© 123456789101112131415161718192021To get you started we need to ask a few questions, this should only take a minute.If this is your first time we recommend running through with the guide: - https://guides.cocoapods.org/making/using-pod-lib-create.html ( hold cmd and click links to open in a browser. )What platform do you want to use?? [ iOS / macOS ] &gt;iosWhat language do you want to use?? [ Swift / ObjC ] &gt;swiftWould you like to include a demo application with your library? [ Yes / No ] &gt;yesWhich testing frameworks will you use? [ Quick / None ] &gt; NoneWould you like to do view based testing? [ Yes / No ] &gt; NO éƒ½å¡«å†™å®Œåä¼šè‡ªåŠ¨æ‰“å¼€ä¸€ä¸ªå·¥ç¨‹ ã€‚ æ·»åŠ åŸºæœ¬ä¿¡æ¯cdè¿›å…¥åˆšæ‰åˆ›å»ºçš„ç›®å½• æ‰§è¡Œå‘½ä»¤ ls 12Example README.md TDFCommonUtil.podspecLICENSE TDFCommonUtil _Pods.xcodeproj è§£é‡Šä¸€ä¸‹è¿™é‡Œéƒ½æ˜¯å•¥ Example è¿™é‡Œé¢å°±æ˜¯ç¤ºä¾‹å·¥ç¨‹ README.md è¿™é‡Œé¢æ˜¯æˆ‘ä»¬å¯¹æ”¹podåŠŸèƒ½å’Œä½¿ç”¨ç­‰çš„ä»‹ç» ï¼Œ ä½¿ç”¨markdownè¯­æ³• TDFCommonUtil.podspec è¿™é‡Œæ˜¯æ”¹æ¨¡å—çš„å…¨éƒ¨åŸºæœ¬ä¿¡æ¯ LICENSE è¿™é‡Œæ”¾çš„æ˜¯æ”¹å¼€æºé¡¹ç›®éµå®ˆçš„åè®® TDFCommonUtil è¿™é‡Œæ”¾ç€å…¨éƒ¨çš„ç±»æ–‡ä»¶å’Œèµ„æºæ–‡ä»¶ _Pods.xcodeproj è¿™æ˜¯ç¤ºä¾‹å·¥ç¨‹çš„å¿«æ·æ–¹å¼ æˆ‘ä»¬é¦–å…ˆè¦ä¸ºæˆ‘ä»¬çš„podåˆ›å»ºä¸€ä¸ªå®é™…çš„gitä»“åº“ ã€‚ æ‰“å¼€gitlabæœåŠ¡åˆ›å»ºä¸€ä¸ªç©ºçš„gitä»“åº“ ç„¶åå…ˆæŠŠpodç›®å½•æäº¤åˆ°æˆ‘ä»¬çš„ä»“åº“ blalblabla æ‰“å¼€TDFCommonUtil.podspecæ–‡ä»¶ 12345678910111213141516171819202122232425262728Pod::Spec.new do |s| s.name = 'TDFCommonUtil' s.version = '0.1.0' s.summary = 'A short description of TDFCommonUtil.' s.description = &lt;&lt;-DESCTODO: Add long description of the pod here. DESC s.homepage = 'https://github.com/xxxxx@yeah.net/TDFCommonUtil' s.license = &#123; :type =&gt; 'MIT', :file =&gt; 'LICENSE' &#125; s.author = &#123; 'xxxxx' =&gt; 'xxxxx@2dfire.com' &#125; s.source = &#123; :git =&gt; 'https://github.com/xxxxx@yeah.net/TDFCommonUtil.git', :tag =&gt; s.version.to_s &#125; s.ios.deployment_target = '8.0' s.source_files = 'TDFCommonUtil/Classes/**/*' # s.resource_bundles = &#123; # 'TDFCommonUtil' =&gt; ['TDFCommonUtil/Assets/*.png'] # &#125; # s.public_header_files = 'Pod/Classes/**/*.h' # s.frameworks = 'UIKit', 'MapKit' # s.dependency 'AFNetworking', '~&gt; 2.3'end è¿™é‡Œçš„é…ç½®é¡¹å°±æ˜¯ç”Ÿæˆpodéœ€è¦é…ç½®çš„å¤§éƒ¨åˆ†é€‰é¡¹äº† ï¼Œç®€å•ä»‹ç»ä¸€ä¸‹ name podåç§° version ç‰ˆæœ¬å· ï¼Œç‰¹åˆ«æ³¨æ„ä¸‹åœ¨æ›´æ–°æ—¶éœ€è¦å¯¹gitä»“åº“æ‰“tag summary ç®€ä»‹ description æè¿° homepage ä¸»é¡µ license ä½¿ç”¨åè®® author ä½œè€… deployment_target éœ€è¦ç³»ç»Ÿç‰ˆæœ¬ source_files æºæ–‡ä»¶è·¯å¾„ resource_bundles èµ„æºæ–‡ä»¶è·¯å¾„ æ³¨æ„è¿™é‡Œä¼šæŠŠèµ„æºæ–‡ä»¶æ‰“åŒ…æˆbundle ï¼Œ è°ƒç”¨çš„æ—¶å€™è¦æ³¨æ„ä¸‹ public_header_files å…¬å¼€çš„å¤´æ–‡ä»¶ ï¼ˆæœ‰äº›å¤´æ–‡ä»¶æˆ‘ä»¬ä¸æƒ³è¦å¤–éƒ¨çœ‹è§å¯ä»¥åœ¨è¿™é‡Œå»æ‰ï¼‰ frameworks éœ€è¦ä¾èµ–çš„frameworkåº“ dependency éœ€è¦ä¾èµ–çš„å…¶ä»–pod ç°åœ¨æŠŠè¿™äº›å¡«å¥½å§ ã€‚ æ·»åŠ ä¾èµ–æœ‰çš„æ—¶å€™æˆ‘ä»¬å¼€å‘çš„podä»“åº“éœ€è¦ä¾èµ–å…¶ä»–ä»“åº“ ï¼Œ æ¯”å¦‚æˆ‘ä»¬éœ€è¦ä¾èµ–ReactiveObjCè¿™é‡Œå°±å¯ä»¥åœ¨TDFCommonUtil.podspecä¸‹é¢æ·»åŠ è¿™ä¸€è¡Œ 1s.dependency 'ReactiveObjC' ps ï¼Œè¿™é‡Œå¯ä»¥æŒ‡å‘ç‰¹å®šçš„ç‰ˆæœ¬ä¹Ÿå¯ä»¥ç”¨ â€˜~&gt; 2.3â€™ çš„å½¢å¼è¡¨ç¤ºä¾èµ–æ­¤ä»“åº“è‡³å°‘å¤§äº2.3ç‰ˆæœ¬ä½†æ˜¯ä¸ä¼šè¶…è¿‡3.0 ã€‚ lintæ£€æµ‹ä¸€åˆ‡å°±ç»ªåä½ å¯ä»¥åœ¨é‡Œé¢åˆ›å»ºä½ çš„æ–‡ä»¶ ï¼Œ æ·»åŠ ä»£ç äº† ï¼Œåˆ«å¿˜äº†å†æœ‰æ–‡ä»¶çš„å¢åŠ æˆ–åˆ é™¤ååœ¨è¿è¡Œä¸€é â€˜pod installâ€™ å“¦ ã€‚ å…ˆéšä¾¿åˆ›å»ºå‡ ä¸ªæ–‡ä»¶ ï¼Œ ä¿è¯ç¼–è¯‘ä¸æŠ¥é”™å°±å¯ä»¥äº† ï¼Œç„¶åæˆ‘ä»¬ä½¿ç”¨cocoapodsæ£€æµ‹æˆ‘ä»¬çš„åº“ 1pod lib lint --sources='git@git.xxx.com:ios/cocoapods-spec.git' --use-libraries --allow-warnings --verbose --no-clean è¿™é‡Œçš„sourceså¡«å†™ä½ æ‰€ä½¿ç”¨çš„ç§æœ‰gitlabæœåŠ¡ ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥é™é™çš„çœ‹ç€å‘½ä»¤è¡Œäº† ã€‚ æœ€åä¼šå‡ºç° 1Test passed validation. è¯æ˜ä½ çš„åº“æ˜¯å¯è¿è¡Œçš„ ï¼Œ å¦‚æœæ²¡æœ‰å‡ºç°passedå°±æ³¨æ„ä¸‹è¾“å‡ºä¸­çš„errorä¿¡æ¯ ï¼Œçœ‹ä¸‹æ˜¯ä»€ä¹ˆå¯¼è‡´çš„ ã€‚ å‘ç§æœ‰æºæ¨é€linté€šè¿‡åæˆ‘ä»¬å°±å¯ä»¥æŠŠè‡ªå·±çš„ä»“åº“ä¿¡æ¯æ¨é€åˆ°ç§æœ‰æºäº† ï¼Œ æ³¨æ„ä¸æ˜¯ã€Œä»“åº“ã€æ˜¯ã€Œä»“åº“ä¿¡æ¯ã€ï¼Œä¹Ÿå°±æ˜¯x.podspec ã€‚cocoapodå¯ä»¥è‡ªåŠ¨å¸®æˆ‘ä»¬å®Œæˆè¿™ä»¶äº‹æƒ… 1pod repo push xxx-cocoapods-spec TDFOpenShopSDK.podspec --sources=git@git.xxx.com:ios/cocoapods-spec.git --allow-warnings --use-libraries --verbose æŠŠå‘½ä»¤ä¸­çš„xxxæ›¿æ¢ä¸ºä½ çš„ç§æœ‰æºå’Œä»“åº“å°±å¯ä»¥äº† ã€‚ æ€»ç»“ä»¥ä¸ŠåŸºæœ¬æ˜¯æˆ‘ä»¬å·¥ä½œä¸­å¸¸ç”¨çš„cocoapodsçš„æ–¹æ³•äº† ï¼Œ è¿˜æœ‰ä¸€äº›åŠ¨æ€é™æ€åº“ä¾èµ–çš„é—®é¢˜æš‚æ—¶ä¸åšæ€»ç»“ ï¼Œ åç»­å†è°ˆè°ˆè‡ªå·±é‡åˆ°è¿‡çš„å‘ ï¼Œ æ¯”ä¸Šé¢è¿™äº›åŠ èµ·æ¥è¿˜è¦ç²¾å½©å“¦ ï¼Œæ¬¢è¿emailè®¨è®º","categories":[],"tags":[{"name":"Objective-C","slug":"Objective-C","permalink":"https://felixplusplus.github.io/tags/Objective-C/"},{"name":"cocoapods","slug":"cocoapods","permalink":"https://felixplusplus.github.io/tags/cocoapods/"}]},{"title":"NSCache","slug":"NSCache","date":"2018-07-25T02:01:56.000Z","updated":"2018-08-18T10:51:55.834Z","comments":true,"path":"2018/07/25/NSCache/","link":"","permalink":"https://felixplusplus.github.io/2018/07/25/NSCache/","excerpt":"","text":"åŸºæœ¬ NSCache åŸºæœ¬ä¸Šå°±æ˜¯ä¸€ä¸ªä¼šè‡ªåŠ¨ç§»é™¤å¯¹è±¡æ¥é‡Šæ”¾å†…å­˜çš„ NSMutableDictionaryã€‚æ— éœ€å“åº”å†…å­˜è­¦å‘Šæˆ–è€…ä½¿ç”¨è®¡æ—¶å™¨æ¥æ¸…é™¤ç¼“å­˜ã€‚å”¯ä¸€çš„ä¸åŒä¹‹å¤„æ˜¯é”®å¯¹è±¡ä¸ä¼šåƒ NSMutableDictionary ä¸­é‚£æ ·è¢«å¤åˆ¶ï¼Œè¿™å®é™…ä¸Šæ˜¯å®ƒçš„ä¸€ä¸ªä¼˜ç‚¹ï¼ˆé”®ä¸éœ€è¦å®ç° NSCopying åè®®ï¼‰ã€‚ ä¼˜ç‚¹ NSCacheæ˜¯ä¸€ä¸ªç±»ä¼¼NSDictionaryä¸€ä¸ªå¯å˜çš„é›†åˆã€‚ æä¾›äº†å¯è®¾ç½®ç¼“å­˜çš„æ•°ç›®ä¸å†…å­˜å¤§å°é™åˆ¶çš„æ–¹å¼ã€‚ ä¿è¯äº†å¤„ç†çš„æ•°æ®çš„çº¿ç¨‹å®‰å…¨æ€§ã€‚ ç¼“å­˜ä½¿ç”¨çš„keyä¸éœ€è¦æ˜¯å®ç°NSCopyingçš„ç±»ã€‚ å½“å†…å­˜è­¦å‘Šæ—¶å†…éƒ¨è‡ªåŠ¨æ¸…ç†éƒ¨åˆ†ç¼“å­˜æ•°æ®ã€‚ å±æ€§ä¸æ–¹æ³•1@property (assign) id&lt;NSCacheDelegate&gt;delegate; cacheå¯¹è±¡çš„ä»£ç† ï¼Œ ç”¨æ¥å³å°†æ¸…ç†cacheçš„æ—¶å€™å¾—åˆ°é€šçŸ¥ 1- (void)cache:(NSCache *)cache willEvictObject:(id)obj; ä»£ç†æ–¹æ³• ï¼Œ è¿™é‡Œé¢ä¸è¦å¯¹cacheè¿›è¡Œæ”¹åŠ¨ ï¼Œ å¦‚æœå¯¹è±¡objéœ€è¦è¢«æŒä¹…åŒ–å­˜å‚¨çš„è¯å¯ä»¥åœ¨è¿™é‡Œè¿›è¡Œæ“ä½œ è¿™é‡Œé¢æœ‰å‡ ç§æƒ…å†µä¼šå¯¼è‡´è¯¥æ–¹æ³•æ‰§è¡Œï¼š æ‰‹åŠ¨ç§»é™¤ï¼ˆremoveObjectForKeyï¼‰ ç¼“å­˜è¶…è¿‡è®¾å®šçš„ä¸Šçº¿ Appä¸æ´»è·ƒ ç³»ç»Ÿå†…å­˜çˆ†ç‚¸ 1@property BOOL evictsObjectsWithDiscardedContent; è¯¥å±æ€§é»˜è®¤ä¸ºTrue ï¼Œ è¡¨ç¤ºåœ¨å†…å­˜é”€æ¯æ—¶ä¸¢å¼ƒè¯¥å¯¹è±¡ ã€‚ 1@property NSUInteger totalCostLimit; æ€»æˆæœ¬æ•° ï¼Œ ç”¨æ¥è®¾ç½®æœ€å¤§ç¼“å­˜æ•°é‡ ä½¿ç”¨123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051//// TDFSetPhoneNumController.m// TDFLoginModule//// Created by doubanjiang on 2017/6/5.// Copyright Â© 2017å¹´ doubanjiang. All rights reserved.//#import \"viewController.h\"@interface viewController () &lt;NSCacheDelegate&gt;@property (nonatomic ,strong) NSCache *cache;@end@implementation viewController- (void)viewDidLoad &#123; [super viewDidLoad]; [self beginCache];&#125;- (void)beginCache &#123; for (int i = 0; i&lt;10; i++) &#123; NSString *obj = [NSString stringWithFormat:@\"object--%d\",i]; [self.cache setObject:obj forKey:@(i) cost:1]; NSLog(@\"%@ cached\",obj); &#125;&#125;#pragma mark - NSCacheDelegate- (void)cache:(NSCache *)cache willEvictObject:(id)obj &#123; //evict : é©±é€ NSLog(@\"%@\", [NSString stringWithFormat:@\"%@ will be evict\",obj]);&#125;#pragma mark - Getter- (NSCache *)cache &#123; if (!_cache) &#123; _cache = [NSCache new]; _cache.totalCostLimit = 5; _cache.delegate = self; &#125; return _cache;&#125;@end æˆ‘ä»¬ä¼šçœ‹åˆ°ä»¥ä¸‹è¾“å‡º 1234567891011121314152018-07-31 09:30:56.485719+0800 Test_Example[52839:214698] object--0 cached2018-07-31 09:30:56.485904+0800 Test_Example[52839:214698] object--1 cached2018-07-31 09:30:56.486024+0800 Test_Example[52839:214698] object--2 cached2018-07-31 09:30:56.486113+0800 Test_Example[52839:214698] object--3 cached2018-07-31 09:30:56.486254+0800 Test_Example[52839:214698] object--4 cached2018-07-31 09:30:56.486382+0800 Test_Example[52839:214698] object--0 will be evict2018-07-31 09:30:56.486480+0800 Test_Example[52839:214698] object--5 cached2018-07-31 09:30:56.486598+0800 Test_Example[52839:214698] object--1 will be evict2018-07-31 09:30:56.486681+0800 Test_Example[52839:214698] object--6 cached2018-07-31 09:30:56.486795+0800 Test_Example[52839:214698] object--2 will be evict2018-07-31 09:30:56.486888+0800 Test_Example[52839:214698] object--7 cached2018-07-31 09:30:56.486995+0800 Test_Example[52839:214698] object--3 will be evict2018-07-31 09:30:56.487190+0800 Test_Example[52839:214698] object--8 cached2018-07-31 09:30:56.487446+0800 Test_Example[52839:214698] object--4 will be evict2018-07-31 09:30:56.487604+0800 Test_Example[52839:214698] object--9 cached æ€»ç»“ç»è¿‡å®éªŒæˆ‘ä»¬å‘ç°NSCacheä½¿ç”¨ä¸Šæ€§ä»·æ¯”è¿˜æ˜¯æ¯”è¾ƒé«˜çš„ ï¼Œ æ¯”ä¸€äº›çæŠ˜è…¾å‡ºæ¥çš„ç¼“å­˜å¥½ç”¨å¾ˆå¤š ã€‚","categories":[],"tags":[{"name":"Objective-C","slug":"Objective-C","permalink":"https://felixplusplus.github.io/tags/Objective-C/"},{"name":"NSCache","slug":"NSCache","permalink":"https://felixplusplus.github.io/tags/NSCache/"}]},{"title":"RxSwift","slug":"rxswift","date":"2018-07-24T06:32:19.000Z","updated":"2018-08-18T10:52:05.132Z","comments":true,"path":"2018/07/24/rxswift/","link":"","permalink":"https://felixplusplus.github.io/2018/07/24/rxswift/","excerpt":"","text":"åŸºæœ¬ RxSwift æ˜¯åœ¨ Apple æ¨å‡º Swift åï¼Œ ReactiveX æ¨å‡º Reactive Extensions ç³»åˆ—ä¸€ä¸ªå®ç°åº“ã€‚ä½†æ˜¯å­¦ä¹  RxSwift ä¸æ˜¯å­¦ä¹ å¦‚ä½•ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Œè€Œæ˜¯å­¦ä¹ ä¸€ä¸ªæ€æƒ³ã€‚ ç¼–ç¨‹èŒƒå¼ ç¼–ç¨‹èŒƒå‹ã€ç¼–ç¨‹èŒƒå¼æˆ–ç¨‹åºè®¾è®¡æ³•ï¼ˆè‹±è¯­ï¼šProgramming paradigmï¼‰ï¼Œï¼ˆèŒƒå³æ¨¡èŒƒã€å…¸èŒƒä¹‹æ„ï¼ŒèŒƒå¼å³æ¨¡å¼ã€æ–¹æ³•ï¼‰ï¼Œæ˜¯ä¸€ç±»å…¸å‹çš„ç¼–ç¨‹é£æ ¼ï¼Œæ˜¯æŒ‡ä»äº‹è½¯ä»¶å·¥ç¨‹çš„ä¸€ç±»å…¸å‹çš„é£æ ¼ï¼ˆå¯ä»¥å¯¹ç…§æ–¹æ³•å­¦ï¼‰ã€‚å¦‚ï¼šå‡½æ•°å¼ç¼–ç¨‹ã€ç¨‹åºç¼–ç¨‹ã€é¢å‘å¯¹è±¡ç¼–ç¨‹ã€æŒ‡ä»¤å¼ç¼–ç¨‹ç­‰ç­‰ä¸ºä¸åŒçš„ç¼–ç¨‹èŒƒå‹ã€‚ç¼–ç¨‹èŒƒå‹æä¾›äº†ï¼ˆåŒæ—¶å†³å®šäº†ï¼‰ç¨‹åºå‘˜å¯¹ç¨‹åºæ‰§è¡Œçš„çœ‹æ³•ã€‚ä¾‹å¦‚ï¼Œåœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œç¨‹åºå‘˜è®¤ä¸ºç¨‹åºæ˜¯ä¸€ç³»åˆ—ç›¸äº’ä½œç”¨çš„å¯¹è±¡ï¼Œè€Œåœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ä¸€ä¸ªç¨‹åºä¼šè¢«çœ‹ä½œæ˜¯ä¸€ä¸ªæ— çŠ¶æ€çš„å‡½æ•°è®¡ç®—çš„åºåˆ—ã€‚ å‡½æ•°å¼ ç®€å•è¯´ï¼Œâ€å‡½æ•°å¼ç¼–ç¨‹â€æ˜¯ä¸€ç§â€ç¼–ç¨‹èŒƒå¼â€ï¼ˆprogramming paradigmï¼‰ï¼Œä¹Ÿå°±æ˜¯å¦‚ä½•ç¼–å†™ç¨‹åºçš„æ–¹æ³•è®ºã€‚å®ƒå±äºâ€ç»“æ„åŒ–ç¼–ç¨‹â€çš„ä¸€ç§ï¼Œä¸»è¦æ€æƒ³æ˜¯æŠŠè¿ç®—è¿‡ç¨‹å°½é‡å†™æˆä¸€ç³»åˆ—åµŒå¥—çš„å‡½æ•°è°ƒç”¨ã€‚ å“åº”å¼ åœ¨è®¡ç®—æœºä¸­ï¼Œå“åº”å¼ç¼–ç¨‹æˆ–ååº”å¼ç¼–ç¨‹ï¼ˆè‹±è¯­ï¼šReactive programmingï¼‰æ˜¯ä¸€ç§é¢å‘æ•°æ®æµå’Œå˜åŒ–ä¼ æ’­çš„ç¼–ç¨‹èŒƒå¼ã€‚è¿™æ„å‘³ç€å¯ä»¥åœ¨ç¼–ç¨‹è¯­è¨€ä¸­å¾ˆæ–¹ä¾¿åœ°è¡¨è¾¾é™æ€æˆ–åŠ¨æ€çš„æ•°æ®æµï¼Œè€Œç›¸å…³çš„è®¡ç®—æ¨¡å‹ä¼šè‡ªåŠ¨å°†å˜åŒ–çš„å€¼é€šè¿‡æ•°æ®æµè¿›è¡Œä¼ æ’­ã€‚ RxSwiftæ ¸å¿ƒ Observable å¯è§‚æµ‹åºåˆ— Observer è§‚å¯Ÿè€… Operator åˆ›å»ºå˜åŒ–ç»„åˆäº‹ä»¶ Disposable ç®¡ç†è®¢é˜…ç”Ÿå‘½å‘¨æœŸ Schedulers çº¿ç¨‹é˜Ÿåˆ— Observableç®€å•æ¥è¯´ ï¼Œ Observableå³ä½¿å¯è¢«è§‚å¯Ÿçš„åºåˆ— ï¼Œ å°±åƒæ•°ç»„ä¸€æ ·ï¼š[1,2,3,4,5] è€Œæˆ‘å¯¹Observableçš„ç†è§£åˆ™æ˜¯åŠ ä¸Šäº†æ—¶é—´ç»´åº¦çš„æ•°ç»„ ï¼Œ è¿™ä¸ªæ•°ç»„ä¼šéšç€æ—¶é—´çš„å˜åŒ–è€Œå˜åŒ– ã€‚ åœ¨è¿™é‡Œä½ å¯ä»¥æƒ³è±¡ä¸€ä¸‹æ¸©åº¦çš„å˜åŒ– : [35,35.1,35.4,38,çˆ†ç‚¸] æµ·å¹³é¢çš„å‡é«˜ : [æµ·æ‹”100mï¼Œæµ·æ‹”110mï¼Œæµ·æ‹”112m]å¤§æ¦‚è¿™æ ·ç†è§£æ¯”è¾ƒç›´è§‚ ã€‚ 12345678910111213141516171819let numbers: Observable&lt;Int&gt; = Observable.create &#123; observer -&gt; Disposable in observer.onNext(0) observer.onNext(1) observer.onNext(2) observer.onNext(3) observer.onNext(4) observer.onNext(5) observer.onNext(6) observer.onNext(7) observer.onNext(8) observer.onNext(9) observer.onCompleted() return Disposables.create() &#125; _ = numbers.takeUntil(self.rx.deallocated).subscribe(onNext: &#123; a in print(a) &#125;) ObserverObserver æ˜¯ä¸€ä¸ªè®¢é˜…è€… ï¼Œ å®ƒå¯ä»¥è§‚å¯Ÿã€Œå¯è¢«è§‚å¯Ÿåºåˆ—ã€çš„å˜åŒ– AnyObserverBinderOperatorDisposableSchedulersMVVMç¤ºä¾‹","categories":[],"tags":[{"name":"swift","slug":"swift","permalink":"https://felixplusplus.github.io/tags/swift/"}]},{"title":"AOP","slug":"aop","date":"2018-07-24T06:32:12.000Z","updated":"2018-08-18T10:49:50.185Z","comments":true,"path":"2018/07/24/aop/","link":"","permalink":"https://felixplusplus.github.io/2018/07/24/aop/","excerpt":"","text":"Aspect Oriented ProgrammingåŸºæœ¬æ¦‚å¿µAOP ç›´è¯‘ä¸º ï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰ ä»¥ä¸‹å¼•ç”¨è‡ªwikipedia é¢å‘ä¾§é¢çš„ç¨‹åºè®¾è®¡ï¼ˆaspect-oriented programmingï¼ŒAOPï¼Œåˆè¯‘ä½œé¢å‘æ–¹é¢çš„ç¨‹åºè®¾è®¡ã€è§‚ç‚¹å¯¼å‘ç¼–ç¨‹ã€å‰–é¢å¯¼å‘ç¨‹åºè®¾è®¡ï¼‰æ˜¯è®¡ç®—æœºç§‘å­¦ä¸­çš„ä¸€ä¸ªæœ¯è¯­ï¼ŒæŒ‡ä¸€ç§ç¨‹åºè®¾è®¡èŒƒå‹ã€‚è¯¥èŒƒå‹ä»¥ä¸€ç§ç§°ä¸ºä¾§é¢ï¼ˆaspectï¼Œåˆè¯‘ä½œæ–¹é¢ï¼‰çš„è¯­è¨€æ„é€ ä¸ºåŸºç¡€ï¼Œä¾§é¢æ˜¯ä¸€ç§æ–°çš„æ¨¡å—åŒ–æœºåˆ¶ï¼Œç”¨æ¥æè¿°åˆ†æ•£åœ¨å¯¹è±¡ã€ç±»æˆ–å‡½æ•°ä¸­çš„æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼ˆcrosscutting concernï¼‰ã€‚ä¾§é¢çš„æ¦‚å¿µæºäºå¯¹é¢å‘å¯¹è±¡çš„ç¨‹åºè®¾è®¡çš„æ”¹è¿›ï¼Œä½†å¹¶ä¸åªé™äºæ­¤ï¼Œå®ƒè¿˜å¯ä»¥ç”¨æ¥æ”¹è¿›ä¼ ç»Ÿçš„å‡½æ•°ã€‚ä¸ä¾§é¢ç›¸å…³çš„ç¼–ç¨‹æ¦‚å¿µè¿˜åŒ…æ‹¬å…ƒå¯¹è±¡åè®®ã€ä¸»é¢˜ï¼ˆsubjectï¼‰ã€æ··å…¥ï¼ˆmixinï¼‰å’Œå§”æ‰˜ã€‚ é¢å‘å¯¹è±¡(OOP)æˆ‘ä»¬éƒ½çŸ¥é“é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹ç‚¹æ˜¯ï¼š ç»§æ‰¿ å°è£… å¤šæ€ å…¶ä¸­ ï¼Œ åˆ†è£…çš„è¦æ±‚æ˜¯å°†åŠŸèƒ½åˆ†æ•£åˆ°ä¸åŒçš„ç±»ä¸­ ï¼Œ æ‰§è¡ŒèŒè´£åˆ’åˆ† ï¼Œ è¿™æ ·å°±é™ä½äº†ä»£ç çš„å¤æ‚åº¦ ï¼Œ åŒæ—¶ä¹Ÿè®©ç±»å’Œå¯¹è±¡æ›´æ˜“è¯»æ˜“æ‡‚ ã€‚ä½†æ˜¯æœ‰çš„æ—¶å€™å‡ ä¸ªä¸åŒçš„ç±»å¯èƒ½ä¼šéœ€è¦æ‰§è¡Œç›¸åŒçš„æ–¹æ³• ï¼Œ æ¯”å¦‚åœ¨é¡µé¢è·³è½¬çš„æ—¶å€™è¿›è¡ŒåŸ‹ç‚¹è®°å½• ã€ å°†å½“å‰é¡µé¢çš„æ ‡è¯†å‘é€ç»™æœåŠ¡ç«¯è®°å½• ã€‚è¿™é‡Œä½ å¯èƒ½ä¼šæƒ³ ï¼Œå†™ä¸ªç±»æŠŠè¿™å—ä»£ç å°è£…ä¸€ä¸‹ ï¼Œ å†åœ¨éœ€è¦çš„åœ°æ–¹è°ƒç”¨ä¸å°±å¯ä»¥äº† ã€‚æƒ³ä¸€ä¸‹ ï¼Œ å½“æˆ‘ä»¬è¿™ä¸ªæ–¹æ³•è°ƒç”¨çš„apiéœ€è¦æ”¹å†™çš„æ—¶å€™ä¼šæ€ä¹ˆæ ·å‘¢ ï¼Œ æ‰€æœ‰ä¹‹å‰çš„è°ƒç”¨å¤„éƒ½éœ€è¦æ”¹å†™ ã€‚AOPå°±æ˜¯ä¸ºäº†è¿™ç§æƒ…å†µè€Œç”Ÿçš„ ï¼Œ æœ‰äº†å®ƒæˆ‘ä»¬å¯ä»¥æŠŠéœ€è¦æ‰§è¡Œçš„ä»£ç åˆ‡å…¥åˆ°ç‰¹å®šçš„ç±»çš„æŒ‡å®šä½ç½®ï¼ˆæ–¹æ³•ï¼‰ä¸­ ã€‚ ä¸€èˆ¬æˆ‘ä»¬æŠŠè¿™æ®µéœ€è¦æ‰§è¡Œçš„ä»£ç å«åšåˆ‡é¢ , è¿™ç»„ä»£ç ä¸­çš„ä¸€ä»½å«åšåˆ‡ç‰‡ , åˆ‡å…¥çš„ä½ç½®å«åšåˆ‡å…¥ç‚¹ ã€‚ è¿™æ ·çœ‹æ¥ ï¼Œ æœ‰äº†AOP ï¼Œ æˆ‘ä»¬çš„OOPå°±æ›´åŠ ç«‹ä½“äº† ï¼Œ æˆ‘ä»¬å¯ä»¥åœ¨ä¸ä¿®æ”¹æºä»£ç çš„å‰æä¸‹å®ç°ç»Ÿä¸€çš„æŸç§éœ€è¦æ‰§è¡Œçš„æ“ä½œ ã€‚ iOSä¸­çš„åº”ç”¨å¯¹äºæˆ‘ä»¬iOSç¨‹åºå‘˜æ¥è¯´ ï¼Œ æˆ‘ä»¬åœ¨Appä¸­åº”ç”¨AOPæœ€å¥½çš„æ–¹å¼æ˜¯é€šè¿‡runtimeçš„methodswizzing ï¼Œ runtimeæ˜¯ä¸€ä¸ªæ¯”è¾ƒéš¾ç”¨çš„åº“ ï¼Œ å› ä¸ºæ¯”è¾ƒåº•å±‚ ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸‹Aspectsè¿™ä¸ªåº“ ï¼Œ å¯ä»¥è®©æˆ‘ä»¬æ–¹ä¾¿çš„è¿›è¡Œæ–¹æ³•äº¤æ¢ å®‰è£…è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨cocoapodç®¡ç†ä¸‰æ–¹åº“ 1pod \"Aspects\" ç®€å•ä½¿ç”¨é¦–å…ˆåˆ›å»ºä¸€ä¸ªå·¥ç¨‹ ï¼Œ å®‰è£…Aspects ï¼Œ ç„¶ååœ¨appdelegateä¸­çš„ä»£ç†æ–¹æ³•ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 123[UIViewController aspect_hookSelector:@selector(viewWillAppear:) withOptions:AspectPositionAfter usingBlock:^(id&lt;AspectInfo&gt; aspectInfo, BOOL animated) &#123; NSLog(@\"View Controller %@ will appear animated: %tu\", aspectInfo.instance, animated);&#125; error:NULL]; è¿™æ · ï¼Œæˆ‘ä»¬å°±hookäº†UIViewControllerçš„viewWillAppearæ–¹æ³• ï¼Œ å¯ä»¥åœ¨è¿™é‡Œæ’å…¥åˆ‡ç‰‡äº† æºä»£ç è§£è¯»pass","categories":[],"tags":[{"name":"AOP","slug":"AOP","permalink":"https://felixplusplus.github.io/tags/AOP/"},{"name":"Objective-C","slug":"Objective-C","permalink":"https://felixplusplus.github.io/tags/Objective-C/"}]},{"title":"iOS UnitTest XCTest ä½¿ç”¨å°ç»“","slug":"unitTest","date":"2018-06-10T11:33:49.000Z","updated":"2018-08-18T10:52:29.983Z","comments":true,"path":"2018/06/10/unitTest/","link":"","permalink":"https://felixplusplus.github.io/2018/06/10/unitTest/","excerpt":"","text":"UTåœ¨å¼€å‘æˆ–æ˜¯ç»´æŠ¤ä¸€äº›åŠŸèƒ½çš„æ—¶å€™ï¼Œå¾€å¾€æˆ‘ä»¬è‡ªä»¥ä¸ºæ˜¯çš„æ²¡é—®é¢˜ï¼Œå…¨å¼„å¥½äº†ï¼Œæ ¹æœ¬ä¸ä¼šå‡ºé—®é¢˜ï¼ˆå¾®ç¬‘for meï¼‰æ˜¯æ ¹æœ¬é ä¸ä½çš„ï¼Œè¿™æ—¶å€™å°±éœ€è¦æˆ‘ä»¬æå‡ºå•å…ƒæµ‹è¯•æ’¸ä¸€éï¼Œå¦‚æœæ²¡é—®é¢˜å†å»è®©æµ‹è¯•å¤§å¤§å¸®æˆ‘ä»¬æŠŠå…³ï¼Œä»Šå¤©å°±è°ˆä¸€ä¸‹iOSæµ‹è¯•ç±»XCTestã€‚ ä½¿ç”¨åœºæ™¯ å·¥å…·ç±»ï¼Œå’Œæˆ‘ä»¬çš„ä¸€äº›å¤–éƒ¨æ‰©å±•çš„æ–¹æ³•ç¨³å®šæ€§ æ€§èƒ½æµ‹è¯• ç½‘ç»œæ¥å£æµ‹è¯• æ–¹æ³•ä»‹ç»123- (void)setUp &#123; [super setUp];&#125; å½“æµ‹è¯•æ‰§è¡Œä¹‹å‰è¦åšçš„æ˜¯ï¼Œç›¸å½“äºå¯ä»¥æŠŠæ‰€æœ‰çš„åˆå§‹åŒ–å·¥ä½œæ”¾åœ¨è¿™é‡Œ 123- (void)tearDown &#123; [super tearDown];&#125; å½“æµ‹è¯•æ‰§è¡Œå®Œåè¦åšçš„äº‹ ç®€å•ä½¿ç”¨ é¦–å…ˆï¼Œåœ¨ä½ è¦æµ‹è¯•çš„projectä¸­æ–°å»ºä¸€ä¸ªTest target æ–°å»ºä¸€ä¸ªç±»ï¼Œç»§æ‰¿ XCTestCase ç°åœ¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥å†™æµ‹è¯•ä»£ç å•¦ 123456789101112131415@implementation TDFTestCase- (void)setUp &#123; [super setUp]; // è®¾ç½®bundleVersion [[[NSBundle mainBundle]infoDictionary]setValue:@\"5660\" forKey:@\"CFBundleShortVersionString\"];&#125;- (void)tearDown &#123; // Put teardown code here. This method is called after the invocation of each test method in the class. [super tearDown];&#125;- (void)testHTTPDNSPOD &#123; &#125;@end åœ¨æµ‹è¯•ç±»ä¸­ï¼Œæ¯ä¸€ä¸ªä»¥testå¼€å¤´çš„æ–¹æ³•éƒ½æ˜¯ä¸€ä¸ªæµ‹è¯•æ–¹æ³•ï¼Œä¸‹é¢æ¥è®©æˆ‘ä»¬å‡ ä¸ªè¯•ä¸€ä¸‹å§ å‡è®¾æœ‰è¿™æ ·ä¸€ä¸ªç±» 12345@implementation FXCalculator+ (NSInteger)zero &#123; return 0;&#125;@end è¿™ä¸ªç±»æœ‰ä¸€ä¸ªç±»æ–¹æ³•ï¼Œä½œç”¨ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯è¿”å›ä¸€ä¸ª0ï¼Œæˆ‘ä»¬è¦å†™ä¸€ä¸ªæµ‹è¯•æ–¹æ³•ï¼Œæ¥è¯æ˜è¿”å›å€¼ç¡®å®æ˜¯0ä¸‹é¢ï¼Œæˆ‘ä»¬åœ¨TDFTestCase.mæ–‡ä»¶çš„implementationä¸­å†™è¿™æ ·ä¸€ä¸ªæµ‹è¯•æ–¹æ³• 1234- (void)testThatCalculateZeroCorrect&#123; XCTAssert(0==[FXCalculator zero]); &#125; å¾ˆç®€å•ï¼ŒXCTAssertæ¥æ”¶ä¸€ä¸ªæ¡ä»¶ï¼Œå½“æ¡ä»¶æ»¡è¶³æ—¶ï¼Œæµ‹è¯•é€šè¿‡ä½ ä¼šå‘ç°å‡½æ•°å·¦è¾¹å‡ºç°ä¸€ä¸ªè±å½¢æŒ‰é’®ï¼Œæˆ‘ä»¬ç‚¹å‡»è¿™ä¸ªæŒ‰é’®ï¼Œbiuï½Test Success ä½†æ˜¯è¿™åªæ˜¯æµ‹è¯•ä¸€ä¸ªæ–¹æ³•ï¼Œå½“æˆ‘ä»¬æƒ³è¦æµ‹è¯•ä¸€ç»„æ–¹æ³•çš„æ—¶å€™å‘¢ æ·»åŠ ä¸€ä¸ªæ–¹æ³•åˆ°FXCalculatorä¸­ 123+ (NSInteger)one &#123; return 1;&#125; å†æ·»åŠ ä¸€ä¸ªæµ‹è¯•æ–¹æ³•åˆ°TDFTestCase.m 123+ (NSInteger)one &#123; return 1;&#125; ç‚¹å‡» 1@implementation TDFTestCase å·¦è¾¹çš„è±å½¢æŒ‰é’®ï¼Œè¿™äº›æ–¹æ³•å°±ä¼šä¾æ¬¡æ‰§è¡Œä¸‹å» æ€§èƒ½æµ‹è¯•ç°åœ¨æˆ‘ä»¬å…ˆæ·»åŠ ä¸€ä¸ªå‡½æ•°ï¼Œè¿™æ˜¯ä¸€ä¸ªé˜¶ä¹˜å‡½æ•°ï¼Œé€’å½’è°ƒç”¨è‡ªèº« 123456+ (NSInteger)factorial:(NSInteger )i &#123; if (!i) &#123; return 1; &#125; return i*[self factorial:i-1];&#125; æ¥ä¸€ä¸ªæµ‹è¯•å‡½æ•° 123456- (void)testThatCalculateFactorial&#123; NSInteger i = [FXCalculator factorial:4]; XCTAssert(i == 24);&#125; 4çš„é˜¶ä¹˜æ˜¯24ï¼Œç°åœ¨æˆ‘ä»¬æµ‹è¯•æˆåŠŸï¼Œé‚£æˆ‘ä»¬æƒ³æµ‹è¯•ä»¥ä¸‹é˜¶ä¹˜æ–¹æ³•çš„æ€§èƒ½æ€ä¹ˆåŠå‘¢ åªè¦ä½¿ç”¨XCTestæä¾›ç»™æˆ‘ä»¬çš„ä¸€ä¸ªblockå°±å¯ä»¥å•¦ 123456- (void)testThatCalculateFactorial&#123; [self measureBlock:^&#123; [FXCalculator factorial:100]; &#125;];&#125; ç‚¹å‡»å¼€å§‹æµ‹è¯•ï¼Œå®Œæˆåä½ ä¼šçœ‹åˆ°measureBlockè¿™ä¸€è¡Œçš„å·¦é¢å‡ºç°ä¸€ä¸ªç°è‰²çš„æŒ‰é’®ï¼Œç‚¹æŒ‰å°±å¯ä»¥çœ‹åˆ°è¯¥æ–¹æ³•çš„æ€§èƒ½æµ‹è¯•å•¦é€‰ä¸­Baselineï¼Œå¯ä»¥è®¾ç½®æ€§èƒ½çš„åŸºçº¿ï¼Œä¹Ÿå°±æ˜¯åˆæ ¼çº¿ å¼‚æ­¥æµ‹è¯•æœ‰æ—¶å€™æˆ‘ä»¬ç›¸å¯¹ç½‘ç»œè¯·æ±‚è¿›è¡Œæµ‹è¯•ï¼Œå¦‚ä½•æµ‹è¯•å¼‚æ­¥æ–¹æ³•å‘¢æ¯”å¦‚æˆ‘å‰ä¸€æ®µæ—¶é—´æ”¹é€ ç½‘ç»œæ¡†æ¶ï¼Œæ‹…å¿ƒè‡ªå·±å“ªé‡Œå†™å‡ºäº†é—®é¢˜ï¼Œè·‘å»æ‰¾bosså•†é‡ï¼Œç»è¿‡bossçš„æé†’æˆ‘å†³å®šå…ˆæå‡ ä¸ªæ¥å£æµ‹è¯•å‡ºæ¥è¿™æ ·ä¸è®ºæˆ‘æ€ä¹ˆæ”¹é€ ï¼Œå› ä¸ºä¸æ¶‰åŠå¤–éƒ¨è°ƒç”¨ï¼Œæ‰€ä»¥åªè¦æµ‹è¯•å…¨éƒ¨é€šè¿‡å°±è¯´æ˜æ²¡å•¥é—®é¢˜é‚£ä¹ˆæ¥å£æµ‹è¯•å’‹å†™å‘¢ 12345678910111213141516171819202122- (void)testThatLoginWithParamsNull &#123; //ç”Ÿæˆexpection XCTestExpectation *expection = [self expectationWithDescription:@\"login request\"]; //å‘é€è¯·æ±‚ TDFRequest *req = [self loginRequestModelInBossApi]; [[self client] sendRequestWithRequestModel:req progress:nil callback:^(TDFResponse * _Nullable res) &#123; //è¡¨ç¤ºæ¡ä»¶æ»¡è¶³ï¼Œæµ‹è¯•å¯ä»¥æ‰§è¡Œ [expection fulfill]; XCTAssertNotNil(res.responseObject); XCTAssertEqual(res.responseObject[@\"code\"], [NSNumber numberWithInteger:0]); &#125;]; // ç­‰å¾…å¼‚æ­¥ä»»åŠ¡è¶…æ—¶ [self waitForExpectationsWithTimeout:self.networkTimeout handler:^(NSError * _Nullable error) &#123; if (error) &#123; XCTFail(\"Time out\"); &#125; &#125;];&#125; æµ‹è¯•æ–­è¨€å‘½ä»¤123456789101112131415161718192021222324252627282930313233343536XCTFail(formatâ€¦) ç”Ÿæˆä¸€ä¸ªå¤±è´¥çš„æµ‹è¯•ï¼›XCTAssertNil(a1, format...)ä¸ºç©ºåˆ¤æ–­ï¼Œa1ä¸ºç©ºæ—¶é€šè¿‡ï¼Œåä¹‹ä¸é€šè¿‡ï¼›XCTAssertNotNil(a1, formatâ€¦)ä¸ä¸ºç©ºåˆ¤æ–­ï¼Œa1ä¸ä¸ºç©ºæ—¶é€šè¿‡ï¼Œåä¹‹ä¸é€šè¿‡ï¼›XCTAssert(expression, format...)å½“expressionæ±‚å€¼ä¸ºTRUEæ—¶é€šè¿‡ï¼›XCTAssertTrue(expression, format...)å½“expressionæ±‚å€¼ä¸ºTRUEæ—¶é€šè¿‡ï¼›XCTAssertFalse(expression, format...)å½“expressionæ±‚å€¼ä¸ºFalseæ—¶é€šè¿‡ï¼›XCTAssertEqualObjects(a1, a2, format...)åˆ¤æ–­ç›¸ç­‰ï¼Œ[a1 isEqual:a2]å€¼ä¸ºTRUEæ—¶é€šè¿‡ï¼Œå…¶ä¸­ä¸€ä¸ªä¸ä¸ºç©ºæ—¶ï¼Œä¸é€šè¿‡ï¼›XCTAssertNotEqualObjects(a1, a2, format...)åˆ¤æ–­ä¸ç­‰ï¼Œ[a1 isEqual:a2]å€¼ä¸ºFalseæ—¶é€šè¿‡ï¼ŒXCTAssertEqual(a1, a2, format...)åˆ¤æ–­ç›¸ç­‰ï¼ˆå½“a1å’Œa2æ˜¯ Cè¯­è¨€æ ‡é‡ã€ç»“æ„ä½“æˆ–è”åˆä½“æ—¶ä½¿ç”¨,å®é™…æµ‹è¯•å‘ç°NSStringä¹Ÿå¯ä»¥ï¼‰ï¼›XCTAssertNotEqual(a1, a2, format...)åˆ¤æ–­ä¸ç­‰ï¼ˆå½“a1å’Œa2æ˜¯ Cè¯­è¨€æ ‡é‡ã€ç»“æ„ä½“æˆ–è”åˆä½“æ—¶ä½¿ç”¨ï¼‰ï¼›XCTAssertEqualWithAccuracy(a1, a2, accuracy, format...)åˆ¤æ–­ç›¸ç­‰ï¼Œï¼ˆdoubleæˆ–floatç±»å‹ï¼‰æä¾›ä¸€ä¸ªè¯¯å·®èŒƒå›´ï¼Œå½“åœ¨è¯¯å·®èŒƒå›´ï¼ˆ+/-accuracyï¼‰ä»¥å†…ç›¸ç­‰æ—¶é€šè¿‡æµ‹è¯•ï¼›XCTAssertNotEqualWithAccuracy(a1, a2, accuracy, format...) åˆ¤æ–­ä¸ç­‰ï¼Œï¼ˆdoubleæˆ–floatç±»å‹ï¼‰æä¾›ä¸€ä¸ªè¯¯å·®èŒƒå›´ï¼Œå½“åœ¨è¯¯å·®èŒƒå›´ä»¥å†…ä¸ç­‰æ—¶é€šè¿‡æµ‹è¯•ï¼›XCTAssertThrows(expression, format...)å¼‚å¸¸æµ‹è¯•ï¼Œå½“expressionå‘ç”Ÿå¼‚å¸¸æ—¶é€šè¿‡ï¼›åä¹‹ä¸é€šè¿‡ï¼›ï¼ˆå¾ˆå˜æ€ï¼‰XCTAssertThrowsSpecific(expression, specificException, format...) å¼‚å¸¸æµ‹è¯•ï¼Œå½“expressionå‘ç”ŸspecificExceptionå¼‚å¸¸æ—¶é€šè¿‡ï¼›åä¹‹å‘ç”Ÿå…¶ä»–å¼‚å¸¸æˆ–ä¸å‘ç”Ÿå¼‚å¸¸å‡ä¸é€šè¿‡ï¼›XCTAssertThrowsSpecificNamed(expression, specificException, exception_name, format...)å¼‚å¸¸æµ‹è¯•ï¼Œå½“expressionå‘ç”Ÿå…·ä½“å¼‚å¸¸ã€å…·ä½“å¼‚å¸¸åç§°çš„å¼‚å¸¸æ—¶é€šè¿‡æµ‹è¯•ï¼Œåä¹‹ä¸é€šè¿‡ï¼›XCTAssertNoThrow(expression, formatâ€¦)å¼‚å¸¸æµ‹è¯•ï¼Œå½“expressionæ²¡æœ‰å‘ç”Ÿå¼‚å¸¸æ—¶é€šè¿‡æµ‹è¯•ï¼›XCTAssertNoThrowSpecific(expression, specificException, format...)å¼‚å¸¸æµ‹è¯•ï¼Œå½“expressionæ²¡æœ‰å‘ç”Ÿå…·ä½“å¼‚å¸¸ã€å…·ä½“å¼‚å¸¸åç§°çš„å¼‚å¸¸æ—¶é€šè¿‡æµ‹è¯•ï¼Œåä¹‹ä¸é€šè¿‡ï¼›XCTAssertNoThrowSpecificNamed(expression, specificException, exception_name, format...)å¼‚å¸¸æµ‹è¯•ï¼Œå½“expressionæ²¡æœ‰å‘ç”Ÿå…·ä½“å¼‚å¸¸ã€å…·ä½“å¼‚å¸¸åç§°çš„å¼‚å¸¸æ—¶é€šè¿‡æµ‹è¯•ï¼Œåä¹‹ä¸é€šè¿‡. å•å…ƒæµ‹è¯•å°±å…ˆæ€»ç»“åˆ°è¿™é‡Œï¼Œæ¬¢è¿emailè®¨è®º","categories":[],"tags":[{"name":"Objective-C","slug":"Objective-C","permalink":"https://felixplusplus.github.io/tags/Objective-C/"},{"name":"XCTest","slug":"XCTest","permalink":"https://felixplusplus.github.io/tags/XCTest/"}]},{"title":"æµ…è°ˆObjcçš„call method","slug":"methodcall","date":"2018-06-10T10:53:47.000Z","updated":"2018-08-18T10:51:24.453Z","comments":true,"path":"2018/06/10/methodcall/","link":"","permalink":"https://felixplusplus.github.io/2018/06/10/methodcall/","excerpt":"","text":"åœ¨OCä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šå†™å‡ºè¿™æ ·çš„ä»£ç  1[SomeObj someMethod] å®é™…ä¸Šè¿™äº›è°ƒç”¨éƒ½ä¼šè½¬åŒ–ä¸º 1objc_msgSend(receiver, @selector(message)); è¿™æ ·çš„å½¢å¼ é‚£ä¹ˆã€‚è¿™ä¸€åˆ‡ä¸­é—´ç»å†äº†æ€æ ·çš„è¿‡ç¨‹å‘¢ï¼Œä¸‹é¢æˆ‘ä»¬å…ˆä»‹ç»å‡ ä¸ªåè¯ SEL æˆ‘ä»¬å†™çš„OCä»£ç ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µä¼šå¯¹æ‰€æœ‰æ–¹æ³•ç”Ÿæˆä¸€ä¸ªIDï¼Œç”¨æ¥åŒºåˆ†ä¸åŒçš„æ–¹æ³•ï¼ŒåŒæ—¶åªè¦æ˜¯æ˜¯ç›¸åŒçš„å‡½æ•°åç§°ï¼Œè¿™ä¸ªIDæ˜¯ç›¸åŒçš„ IMP æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼ŒæŒ‡å‘çš„æ˜¯å‡½æ•°çš„å®ç°é¦–åœ°å€ã€‚åœ¨å¯¹è±¡æ‰§è¡Œmethodçš„æ—¶å€™ä¸€èˆ¬ä¼šå…ˆä»æ–¹æ³•åˆ—è¡¨é‡Œé¢æŸ¥æ‰¾ç›¸åº”çš„æ–¹æ³•ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥ä½¿ç”¨IMPæ‰§è¡Œæ–¹æ³•çš„è¯ä¼šçœç•¥è¿™ä¸­é—´çš„å¾ˆå¤šæ­¥éª¤ Method Method = SEL + IMP + method_types ä¸‹é¢æ¥ç›´æ¥çœ‹çœ‹æ–¹æ³•è°ƒç”¨æµç¨‹å§ æ£€æŸ¥æ–¹æ³•æ˜¯å¦éœ€è¦å¿½ç•¥ æ£€æŸ¥targetæ˜¯å¦ä¸ºnilï¼Œå¦‚æœä¸ºnilç›´æ¥cleanå¹¶return æ ¹æ®targetçš„classå»å¯»æ‰¾IMPå¹¶æ‰§è¡Œ å¯»æ‰¾IMPè¿‡ç¨‹ å…ˆä»target class çš„cache methodListsï¼ˆæ–¹æ³•ç¼“å­˜åˆ—è¡¨ï¼‰æŸ¥æ‰¾ å¦‚æœç¼“å­˜åˆ—è¡¨æ²¡æœ‰ï¼Œç›´æ¥æŸ¥æ‰¾æ–¹æ³•åˆ—è¡¨ï¼Œæ‰¾åˆ°äº†æ·»åŠ è¿›æ–¹æ³•ç¼“å­˜åˆ—è¡¨å¹¶æ‰§è¡Œ é€’å½’æŸ¥æ‰¾superClass å¦‚æœéƒ½æ²¡æ‰¾åˆ°è¿›å…¥åŠ¨æ€è½¬å‘resolveInstanceMethod","categories":[],"tags":[{"name":"Objective-C","slug":"Objective-C","permalink":"https://felixplusplus.github.io/tags/Objective-C/"}]},{"title":"æµ…è°ˆObjective-Cä¸­çš„weak","slug":"weak","date":"2018-06-10T08:47:24.000Z","updated":"2018-08-18T10:52:36.624Z","comments":true,"path":"2018/06/10/weak/","link":"","permalink":"https://felixplusplus.github.io/2018/06/10/weak/","excerpt":"","text":"æ—¥å¸¸å¼€å‘ä¸­æˆ‘ä»¬ä½¿ç”¨weakå¤§éƒ¨åˆ†æ˜¯ä¸ºäº†ä¿®é¥°å±æ€§å¼•ç”¨è®¡æ•°ï¼Œé˜²æ­¢å¾ªç¯å¼•ç”¨ã€å†…å­˜æ³„æ¼çš„ä½œç”¨ï¼Œé‚£ä¹ˆä»–çš„åŸç†æ˜¯ä»€ä¹ˆå‘¢ï¼Œ åŸç†ç®€ä»‹ Runtimeç»´æŠ¤äº†ä¸€ä¸ªweakè¡¨ï¼Œç”¨äºå­˜å‚¨æŒ‡å‘æŸä¸ªå¯¹è±¡çš„æ‰€æœ‰weakæŒ‡é’ˆã€‚weakè¡¨å…¶å®æ˜¯ä¸€ä¸ªhashï¼ˆå“ˆå¸Œï¼‰è¡¨ï¼ŒKeyæ˜¯æ‰€æŒ‡å¯¹è±¡çš„åœ°å€ï¼ŒValueæ˜¯weakæŒ‡é’ˆçš„åœ°å€ï¼ˆè¿™ä¸ªåœ°å€çš„å€¼æ˜¯æ‰€æŒ‡å¯¹è±¡çš„åœ°å€ï¼‰æ•°ç»„ã€‚ åˆå§‹åŒ–æ—¶ï¼šruntimeä¼šè°ƒç”¨objc_initWeakå‡½æ•°ï¼Œåˆå§‹åŒ–ä¸€ä¸ªæ–°çš„weakæŒ‡é’ˆæŒ‡å‘å¯¹è±¡çš„åœ°å€ã€‚ æ·»åŠ å¼•ç”¨æ—¶ï¼šobjc_initWeakå‡½æ•°ä¼šè°ƒç”¨ objc_storeWeak() å‡½æ•°ï¼Œ objc_storeWeak() çš„ä½œç”¨æ˜¯æ›´æ–°æŒ‡é’ˆæŒ‡å‘ï¼Œåˆ›å»ºå¯¹åº”çš„å¼±å¼•ç”¨è¡¨ã€‚ é‡Šæ”¾æ—¶ï¼Œè°ƒç”¨clearDeallocatingå‡½æ•°ã€‚clearDeallocatingå‡½æ•°é¦–å…ˆæ ¹æ®å¯¹è±¡åœ°å€è·å–æ‰€æœ‰weakæŒ‡é’ˆåœ°å€çš„æ•°ç»„ï¼Œç„¶åéå†è¿™ä¸ªæ•°ç»„æŠŠå…¶ä¸­çš„æ•°æ®è®¾ä¸ºnilï¼Œæœ€åæŠŠè¿™ä¸ªentryä»weakè¡¨ä¸­åˆ é™¤ï¼Œæœ€åæ¸…ç†å¯¹è±¡çš„è®°å½•ã€‚ å½“æˆ‘ä»¬åˆå§‹åŒ–ä¸€ä¸ªweakå˜é‡æ—¶ï¼Œruntimeä¼šè°ƒç”¨ NSObject.mm ä¸­çš„objc_initWeakå‡½æ•°ã€‚ æ·»åŠ å¼•ç”¨æ—¶ï¼šobjc_initWeakå‡½æ•°ä¼šè°ƒç”¨ objc_storeWeak() å‡½æ•°ï¼Œ objc_storeWeak() çš„ä½œç”¨æ˜¯æ›´æ–°æŒ‡é’ˆæŒ‡å‘ï¼Œåˆ›å»ºå¯¹åº”çš„å¼±å¼•ç”¨è¡¨ã€‚ weakè¡¨æ˜¯ä¸€ä¸ªå¼±å¼•ç”¨è¡¨ï¼Œå®ç°ä¸ºä¸€ä¸ªweak_table_tç»“æ„ä½“ï¼Œå­˜å‚¨äº†æŸä¸ªå¯¹è±¡ç›¸å…³çš„çš„æ‰€æœ‰çš„å¼±å¼•ç”¨ä¿¡æ¯ã€‚ å½“é”€æ¯weakæ—¶åˆåšäº†äº›ä»€ä¹ˆå‘¢ è°ƒç”¨objc_release å› ä¸ºå¯¹è±¡çš„å¼•ç”¨è®¡æ•°ä¸º0ï¼Œæ‰€ä»¥æ‰§è¡Œdealloc åœ¨deallocä¸­ï¼Œè°ƒç”¨äº†_objc_rootDeallocå‡½æ•° åœ¨_objc_rootDeallocä¸­ï¼Œè°ƒç”¨äº†object_disposeå‡½æ•° è°ƒç”¨objc_destructInstance æœ€åè°ƒç”¨objc_clear_deallocating","categories":[],"tags":[{"name":"Objective-C","slug":"Objective-C","permalink":"https://felixplusplus.github.io/tags/Objective-C/"}]},{"title":"iOSå›½é™…åŒ–å°ç»“","slug":"local","date":"2018-06-10T08:46:56.000Z","updated":"2018-08-18T10:51:10.583Z","comments":true,"path":"2018/06/10/local/","link":"","permalink":"https://felixplusplus.github.io/2018/06/10/local/","excerpt":"","text":"éšç€é¡¹ç›®äº§å“çš„å‘å±•ï¼Œæˆ‘ä»¬å°±éœ€è¦é€‚é…å¤šç§å›½é™…åŒ–å’Œåœ°åŒºï¼Œä½†æ˜¯å¤–å›½äººè¿˜æœ‰ä¸€äº›ä¸è®¤è¯†ä¸­æ–‡ï¼Œæˆ‘ä»¬åˆä¸èƒ½å¼ºè¿«ä»–ä»¬å»å­¦ä¹ æ˜¯å§æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹è‡ªå·±çš„äº§å“è¿›è¡Œå›½é™…åŒ–ï¼Œè®©æ›´å¤šçš„äººäº†è§£æˆ‘ä»¬çš„APPï¼Œè¿™å°±éœ€è¦å¯¹æˆ‘ä»¬çš„äº§å“è¿›è¡Œå›½é™…åŒ–äº†ä»Šå¤©å°±ä»‹ç»ä¸€ä¸‹è‡ªå·±åœ¨å›½å®¶åŒ–é¡¹ç›®é‡Œé¢è¸©è¿‡çš„å‘ ä¸»å·¥ç¨‹å†…é…ç½®é…ç½®project æ‰“å¼€ä½ çš„å·¥ç¨‹ ï¼Œ åœ¨å·¦ä¾§æ é€‰ä¸­project åœ¨æ‰“å¼€çš„é¢æ¿ä¸­é€‰ä¸­projectä¸‹çš„è“è‰²å›¾æ ‡ æ‰¾åˆ°Localizationsé€‰é¡¹ ï¼Œ æ·»åŠ ä½ éœ€è¦å›½å®¶åŒ–çš„è¯­è¨€ åœ¨ä¸»å·¥ç¨‹ä¸‹command + N æ–°å»ºLocalizable.stringæ–‡ä»¶ é€‰ä¸­ä½ åˆ›å»ºçš„stringæ–‡ä»¶ ï¼Œ æ‰“å¼€å³ä¾§é¢æ¿ ç‚¹å‡»Localizationç»„ä¸‹çš„LocalizeæŒ‰é’® æŠŠä½ åˆšæ‰é…ç½®åœ¨å·¥ç¨‹å†…çš„é€‰é¡¹æ·»åŠ è¿›å»å°±å¥½ã€‚ è°ƒç”¨æ–¹å¼åœ¨ä»¥å‰è°ƒç”¨çš„åœ°æ–¹æˆ‘ä»¬éœ€è¦æ›¿æ¢ä¸ºæœ¬åœ°åŒ–è°ƒç”¨æ–¹å¼ æ¯”å¦‚ä»¥å‰æˆ‘ä»¬æ˜¯è¿™ä¹ˆè°ƒç”¨çš„ï¼š 1NSString *tips = @\"wait\"; é‚£ä¹ˆç°åœ¨è¦æ¢æˆ 1NSString *tips = NSLocalizedString(@\"wait\", @\"some tips to tell user wait\"); è‡³äºåé¢é‚£æ®µæ˜¯ä¸ºäº†æ–¹ä¾¿ç¿»è¯‘äººå‘˜ç†è§£ä¸Šä¸‹æ–‡è¯­å¢ƒä½¿ç”¨çš„ ã€‚ ç„¶ååœ¨stirngæ–‡ä»¶å†…æ·»åŠ å¯¹åº”çš„å­—ç¬¦ä¸²ï¼š 1\"wait\" = \"åˆ«ç€æ€¥\"; è¿™æ˜¯å¯¹åº”ä¸­æ–‡çš„ ï¼Œ ä½ å¯ä»¥åœ¨ä¸åŒçš„æ–‡ä»¶æ·»åŠ å¯¹åº”ä¸åŒè¯­è¨€çš„ç¿»è¯‘ ã€‚ è®©æˆ‘ä»¬çœ‹ä¸‹è¿™ä¸ªå®çš„å®šä¹‰ ï¼š 12345678#define NSLocalizedString(key, comment) \\ [NSBundle.mainBundle localizedStringForKey:(key) value:@\"\" table:nil]#define NSLocalizedStringFromTable(key, tbl, comment) \\ [NSBundle.mainBundle localizedStringForKey:(key) value:@\"\" table:(tbl)]#define NSLocalizedStringFromTableInBundle(key, tbl, bundle, comment) \\ [bundle localizedStringForKey:(key) value:@\"\" table:(tbl)]#define NSLocalizedStringWithDefaultValue(key, tbl, bundle, val, comment) \\ [bundle localizedStringForKey:(key) value:(val) table:(tbl)] å¯ä»¥çœ‹åˆ°å®é™…ä¸Šå°±æ˜¯ä»mainBundleä¸­å–å‡ºäº†æŒ‡å®šçš„Stringæ–‡ä»¶ ï¼Œ ç„¶åæ ¹æ®æˆ‘ä»¬åœ¨ä»£ç ä¸­å®šä¹‰çš„ â€˜keyâ€™ å€¼å–å‡ºvalue è¿™æ˜¯ä¸€ç§æƒ…å†µ . æœ‰çš„æ—¶å€™æˆ‘ä»¬è¦æŒ‡å®šæˆ‘ä»¬çš„stringæ–‡ä»¶åå­—è€Œä¸ä½¿ç”¨ä¸Šé¢çš„é‚£ä¸ªé»˜è®¤åå­— ã€‚ 1NSString *tips = NSLocalizedStringFromTableInBundle(@\"wait\", @\"TDFOSLocalizable\", [NSBundle bundleForClass:[self class]], @\"some tips to tell user wait\")ï¼› è¿™é‡Œé¢å¤šå‡ºæ¥ä¸¤ä¸ªå‚æ•° ï¼Œ ç¬¬ä¸€ä¸ªæ˜¯æˆ‘ä»¬è¦æŒ‡å®šçš„stringæ–‡ä»¶åå­— ï¼Œ ç¬¬äºŒä¸ªå°±æ˜¯è¦ä»å“ªä¸ªbundleä¸­å– ï¼Œ è¿™ä¸ªbundleçš„é—®é¢˜æˆ‘ä»¬ä¸‹é¢å°±ä¼šè®²åˆ° ã€‚ è„šæœ¬æ›¿æ¢é‚£ä¹ˆåœ¨æˆ‘ä»¬å·¥ç¨‹å¾ˆå¤§çš„æƒ…å†µä¸‹æˆ‘ä»¬è¦æŠŠå…¨éƒ¨çš„å­—ç¬¦ä¸²éƒ½æ›¿æ¢ä¸ºå‰ç¼€ä¸ºNSLocalizedStringçš„å½¢å¼äººå·¥æ‰‹åŠ¨æ›¿æ¢è‚¯å®šæ˜¯ä¸è¡Œçš„ ï¼Œ åˆæ…¢åˆä¸å®‰å…¨ ï¼Œ æ²¡å‡†å¤åˆ¶ç²˜è´´çš„æ—¶å€™è¿˜æŠŠåŸæ¥çš„keyæ”¹é”™äº† ã€‚ è¿™é‡Œè´´ä¸€æ®µpythonçš„å®ä¾‹ä»£ç  ï¼Œæ‚¨å¯ä»¥ç¨åŠ æ”¹åŠ¨è¿è¡Œæ›¿æ¢å·¥ç¨‹ä¸­çš„stringå‰ç¼€ ã€‚ 123456789101112131415161718192021222324252627282930313233343536#!/usr/bin/env python3# -*- coding: utf-8 -*-import osimport reimport sysimport datetimefolderPath = '/Users/felix/Documents/2dfire/TDFOpenShop/TDFOpenShop/Classes'stringToReplace = 'NSLocalizedString'stringReplaceTo = 'TDFOSLocalizedString'def scan_files(rootdir): files = [] for parent, dirnames, filenames in os.walk(rootdir): for filename in filenames: if len(filename.split('.',1))&gt;1: if filename.split('.',1)[1] == 'm': files.append(os.path.join(parent, filename)) return filesdef replaceStringIn(file): code = open(file,'r+') text = code.read() code.seek(0,0) code.write(text.replace(stringToReplace,stringReplaceTo)) code.close()def main(): files = scan_files(folderPath) for filePath in files: replaceStringIn(filePath)if __name__ == '__main__': main() è¿™é‡Œé¢æˆ‘æ˜¯æŠŠä»¥å‰çš„NSå¼€å¤´çš„å®æ›¿æ¢ä¸ºè‡ªå®šä¹‰çš„å® ï¼Œ å¤§åŒå°å¼‚ ï¼Œ å¯ä»¥å‚ç…§è¿™ä¸ªä¿®æ”¹ä¸‹å³å¯ ã€‚ ç¼–è¯‘è¿è¡Œæµ‹è¯•å½“æˆ‘ä»¬å…¨éƒ¨ä¿®æ”¹å¥½ä»¥åè‚¯å®šæ˜¯è¦æµ‹è¯•ä¸‹æ˜¾ç¤ºå¯¹ä¸å¯¹çš„ ã€‚è¿™ä¸ªæ—¶å€™æŒ‰ä¸‹command+Bï¼Œç¼–è¯‘è¿è¡Œ ã€‚ æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥å¿«é€Ÿå°†Appè¯­è¨€åˆ‡æ¢æ‰ æ‰“å¼€æ¨¡æ‹Ÿå™¨æˆ–çœŸæœº ï¼Œ general -&gt; setting -&gt; lang ,ä¸è¿‡è¿™æ ·æ¯”è¾ƒç¹ç ã€‚ ç‚¹å‡»å¯¼èˆªæ ä¸Šçš„æ¨¡æ‹Ÿå™¨å›¾æ ‡å·¦è¾¹çš„schemaé€‰é¡¹ ï¼Œ é€‰æ‹©editSchema -&gt; Run -&gt; Options -&gt;Application Language ç›´æ¥æ”¹ä¸ºä½ éœ€è¦éªŒè¯çš„è¯­è¨€è¿è¡Œå°±å¯ä»¥å•¦ ã€‚ æ¨¡å—å†…å•ç‹¬é…ç½®åŸå› å¾ˆå¤šæ—¶å€™æˆ‘ä»¬çš„å·¥ç¨‹ä½“é‡å¤§åˆ°ä¸€å®šç¨‹åº¦çš„æ—¶å€™éƒ½ä¼šæ¨¡å—åŒ–æ‰ ï¼Œ å‡ ä¸ªäººæˆ–è€…ä¸€ä¸ªäººè´Ÿè´£ä¸€ä¸ªæ¨¡å— ï¼Œ è€Œæœ‰çš„æ¨¡å—æ˜¯è¦ä½œä¸ºSDKæä¾›å¤–éƒ¨interfaceä½¿ç”¨çš„ ã€‚ å½“ä½ æŠŠSDKæä¾›å‡ºå»çš„æ—¶å€™ ï¼Œ æˆ‘ä»¬æœŸæœ›çš„æ•ˆæœæ˜¯åœ¨å…¶ä»–äººï¼ˆå…¶ä»–å·¥ç¨‹ï¼‰å†…éƒ¨è¿è¡Œçš„ã€æˆ‘ä»¬çš„SDKä¹Ÿèƒ½å¤Ÿå›½é™…åŒ–æ˜¾ç¤º ã€‚ ä½†æ˜¯åœ¨æˆ‘ä»¬æ•´ä¸ªå·¥ç¨‹çš„stringæ–‡ä»¶åŒ…å«å‡ åƒä¸Šä¸‡æ¡çš„æ—¶å€™æ˜¾ç„¶ä¸éœ€è¦å…¨éƒ¨ç§»åŠ¨åˆ°æ¨¡å—å†… ã€‚ ç›®æ ‡æ‰€ä»¥åœ¨è¿™é‡Œé¢æˆ‘ä»¬è¦åšçš„å°±æ˜¯æŠŠéœ€è¦çš„ä½¿ç”¨åˆ°çš„å­—ç¬¦ä¸²å’Œç¿»è¯‘å¥½çš„valueä»ä¸»å·¥ç¨‹è¿ç§»åˆ°æ¨¡å—å†…éƒ¨ ã€‚ è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨cocoapodsé›†æˆçš„æ¨¡å—åŒ–å†…éƒ¨è¿›è¡Œå›½é™…åŒ–è¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯cocoapods1.2.1 ã€‚å…³äºcocoapodçš„ä½¿ç”¨è¯¦è§æˆ‘çš„å¦ä¸€ç¯‡æ–‡ç«  ã€‚ æˆ‘ä»¬å…ˆæŠŠä¸»å·¥ç¨‹çš„å›½é™…åŒ–æ–‡ä»¶çš„æ–‡ä»¶å¤¹å¤åˆ¶åˆ°æˆ‘ä»¬çš„æ¨¡å—è·¯å¾„ä¸‹é¢ æˆ‘ä»¬åœ¨æ¨¡å—å†…éƒ¨æœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ â€˜xxx.podspecâ€™ é‡Œé¢æ·»åŠ è¿™æ ·ä¸€æ®µé…ç½® 1s.resources = 'xxx/*.&#123;xib,jpg,png,xcassets&#125;','xxx/*.lproj' ä¸»è¦æ³¨æ„åé¢ , è¿™é‡Œå°±æŠŠæˆ‘ä»¬åˆšå¤åˆ¶æ¥çš„å›½é™…åŒ–é—®ä»·åŠ å…¥äº†æ¨¡å—çš„èµ„æºä¸­ ï¼Œè¿™æ—¶ ï¼Œå¦‚æœæˆ‘ä»¬ä¸æƒ³ç”¨è·Ÿä¸»å·¥ç¨‹ä¸€æ ·çš„åå­— ï¼ŒLocalizable.strings ï¼Œå¯ä»¥æŠŠè¿™ä¸ªåå­—ä¹Ÿç»™æ”¹æ‰ ï¼Œ æ¯”å¦‚ abc.strings è°ƒç”¨è¿™é‡Œä¸ºäº†æœ‰åˆ«äºä¸»å·¥ç¨‹çš„å›½é™…åŒ– ï¼Œ æˆ‘ä»¬æŠŠstringsæ–‡ä»¶æ”¹åä¸º abc.strings ç„¶ååœ¨æ¨¡å—å†…æ–°å»ºä¸€ä¸ªå¤´æ–‡ä»¶ 1234567#ifndef TDFOSLocalizeMacro_h#define TDFOSLocalizeMacro_h#define TDFOSLocalizedString(key, comment) \\NSLocalizedStringFromTableInBundle(key, @\"abc\", [NSBundle bundleForClass:[self class]], comment)#endif /* TDFOSLocalizeMacro_h */ è¿™é‡Œå¯ä»¥ä½¿ç”¨ä¸Šé¢çš„è„šæœ¬å†æ¬¡æ›¿æ¢å­—ç¬¦ä¸²å‰ç¼€ ï¼Œ ç„¶åè¿è¡Œä¸‹çœ‹çœ‹æ˜¯å¦æ›¿æ¢æˆåŠŸäº†å‘¢ ã€‚ è¿™é‡Œä¸»è¦é‡æ–°pod installä¸‹ ï¼Œ å¦åˆ™cocoapodsä¸ä¼šå¸®æˆ‘ä»¬æŠŠèµ„æºå¼•å…¥åŒ…å†… ã€‚ ps: åˆ«å¿˜äº†åˆ æ‰ä¸»å·¥ç¨‹ä¸­ç§»é™¤æ¥çš„å­—ç¬¦ä¸² ï¼ï¼ï¼ æ€»ç»“åŸºæœ¬ç”¨æ³•æš‚æ—¶ä»‹ç»åˆ°è¿™é‡Œ ï¼Œ å…³äºæ¨¡å—åŒ–å’Œå›½é™…åŒ–çš„ä¸œè¥¿è¦å¤šäº†è§£ä¸€ä¸‹NSbundleè¿™ä¸ªç±» ã€‚","categories":[],"tags":[{"name":"Objective-C","slug":"Objective-C","permalink":"https://felixplusplus.github.io/tags/Objective-C/"},{"name":"iOS","slug":"iOS","permalink":"https://felixplusplus.github.io/tags/iOS/"}]},{"title":"æµ…è°ˆGCD","slug":"gcd","date":"2018-06-10T08:46:48.000Z","updated":"2018-08-18T10:50:18.020Z","comments":true,"path":"2018/06/10/gcd/","link":"","permalink":"https://felixplusplus.github.io/2018/06/10/gcd/","excerpt":"","text":"åŸºæœ¬æ¦‚å¿µè¿›ç¨‹ è¿›ç¨‹æŒ‡åœ¨ç³»ç»Ÿä¸­èƒ½ç‹¬ç«‹è¿è¡Œå¹¶ä½œä¸ºèµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œå®ƒæ˜¯ç”±ä¸€ç»„æœºå™¨æŒ‡ä»¤ã€æ•°æ®å’Œå †æ ˆç­‰ç»„æˆçš„ï¼Œæ˜¯ä¸€ä¸ªèƒ½ç‹¬ç«‹è¿è¡Œçš„æ´»åŠ¨å®ä½“ çº¿ç¨‹ çº¿ç¨‹æ˜¯è¿›ç¨‹çš„åŸºæœ¬æ‰§è¡Œå•å…ƒï¼Œä¸€ä¸ªè¿›ç¨‹ï¼ˆç¨‹åºï¼‰çš„æ‰€æœ‰ä»»åŠ¡éƒ½åœ¨çº¿ç¨‹ä¸­æ‰§è¡Œã€‚ é˜Ÿåˆ— é˜Ÿåˆ—ï¼Œåˆç§°ä¸ºä¼«åˆ—ï¼ˆqueueï¼‰ï¼Œæ˜¯å…ˆè¿›å…ˆå‡ºï¼ˆFIFO, First-In-First-Outï¼‰çš„çº¿æ€§è¡¨ã€‚åœ¨å…·ä½“åº”ç”¨ä¸­é€šå¸¸ç”¨é“¾è¡¨æˆ–è€…æ•°ç»„æ¥å®ç°ã€‚é˜Ÿåˆ—åªå…è®¸åœ¨åç«¯ï¼ˆç§°ä¸ºrearï¼‰è¿›è¡Œæ’å…¥æ“ä½œï¼Œåœ¨å‰ç«¯ï¼ˆç§°ä¸ºfrontï¼‰è¿›è¡Œåˆ é™¤æ“ä½œã€‚é˜Ÿåˆ—çš„æ“ä½œæ–¹å¼å’Œå †æ ˆç±»ä¼¼ï¼Œå”¯ä¸€çš„åŒºåˆ«åœ¨äºé˜Ÿåˆ—åªå…è®¸æ–°æ•°æ®åœ¨åç«¯è¿›è¡Œæ·»åŠ ã€‚ åŒæ­¥/å¼‚æ­¥å¯ä»¥è¿™ä¹ˆç†è§£ï¼šï¼ˆçŸ¥ä¹ï¼‰ å‡å¦‚ä½ è¦åšä¸¤ä»¶äº‹ï¼Œçƒ§æ°´ã€åˆ·ç‰™ åŒæ­¥ï¼šä½ çƒ§æ°´ï¼Œç­‰æ°´çƒ§å¼€äº†ä½ å†å»åˆ·ç‰™ å¼‚æ­¥ï¼šä½ çƒ§æ°´ï¼Œä¸ç­‰æ°´çƒ§å¼€å°±å»åˆ·ç‰™äº†ï¼Œæ°´çƒ§å¼€äº†ä¼šå‘å‡ºå£°éŸ³å‘Šè¯‰ä½ ï¼ˆcallbackï¼‰ï¼Œç„¶åä½ å†å¤„ç†æ°´çƒ§å¼€ä¹‹åçš„äº‹æƒ… åªè¦ä½ æ˜¯ä¸ªæ­£å¸¸äººï¼Œéƒ½ä¼šé€‰æ‹©ç¬¬äºŒç§ å½“ç„¶ä¹Ÿæœ‰ç‰¹æ®Šæƒ…å†µï¼Œé‚£ä¸ªäººå–œæ¬¢ç”¨çƒ­æ°´åˆ·ç‰™ å¹¶å‘ æŒ‡ä¸¤ä¸ªæˆ–å¤šä¸ªäº‹ä»¶åœ¨åŒä¸€æ—¶é—´é—´éš”å†…å‘ç”Ÿã€‚å¯ä»¥åœ¨æŸæ¡çº¿ç¨‹å’Œå…¶ä»–çº¿ç¨‹ä¹‹é—´åå¤å¤šæ¬¡è¿›è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œçœ‹ä¸Šå»å°±å¥½åƒä¸€ä¸ªCPUèƒ½å¤Ÿå¹¶ä¸”æ‰§è¡Œå¤šä¸ªçº¿ç¨‹ä¸€æ ·ã€‚å…¶å®æ˜¯ä¼ªå¼‚æ­¥ã€‚ çº¿ç¨‹é˜Ÿåˆ—ä¸­å¹¶è¡Œ/ä¸²è¡Œ ä¸²è¡Œé˜Ÿåˆ—ï¼šä¸²è¡Œé˜Ÿåˆ—çš„ç‰¹ç‚¹æ˜¯é˜Ÿåˆ—å†…çš„çº¿ç¨‹æ˜¯ä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œï¼Œç›´åˆ°ç»“æŸã€‚å¹¶è¡Œé˜Ÿåˆ—ï¼šå¹¶è¡Œé˜Ÿåˆ—çš„ç‰¹ç‚¹æ˜¯é˜Ÿåˆ—ä¸­æ‰€æœ‰çº¿ç¨‹çš„æ‰§è¡Œç»“æŸæ—¶å¿…é¡»æ˜¯ä¸€å—çš„ï¼Œé˜Ÿåˆ—ä¸­å…¶ä»–çº¿ç¨‹æ‰§è¡Œå®Œæ¯•åï¼Œä¼šé˜»å¡å½“å‰çº¿ç¨‹ç­‰å¾…é˜Ÿåˆ—ä¸­å…¶ä»–çº¿ç¨‹æ‰§è¡Œï¼Œç„¶åä¸€å—æ‰§è¡Œå®Œæ¯•ã€‚ åŸºæœ¬ç”¨æ³•123456789DispatchQueue.global().async &#123; print(\"do something in global \\(Thread.current)\") DispatchQueue.main.async &#123; print(\"do something in main \\(Thread.current)\") &#125;&#125; è¿™é‡Œä½¿ç”¨äº†å…¨å±€çš„é˜Ÿåˆ—æ‰§è¡Œä¸€äº›ä»»åŠ¡ ï¼Œ ç„¶ååˆ‡å›ä¸»é˜Ÿåˆ— , è¿™é‡Œè¦æ³¨æ„ä¸»é˜Ÿåˆ—æ˜¯è¿è¡Œåœ¨ä¸»çº¿ç¨‹ä¸Šçš„ä»»åŠ¡å †æ ˆ ã€‚ è‡ªå®šä¹‰é˜Ÿåˆ—é™¤äº†ä½¿ç”¨å…¨å±€é˜Ÿåˆ—å¤–æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„é˜Ÿåˆ— 1let q = DispatchQueue(label: \"com.felix.felix\") åˆå§‹åŒ–ä¸€ä¸ªé˜Ÿåˆ—æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯å£°æ˜å®ƒçš„æ ‡ç­¾ ã€‚ async ç°åœ¨ ï¼Œä½ å¯ä»¥æ‰“å¼€Xcode ï¼Œ æ–°å»ºä¸€ä¸ªcommandLineToolå·¥ç¨‹å’Œæˆ‘ä¸€èµ·ç»ƒä¹  ã€‚ æ‰“å¼€main.swift 123456789101112131415let q = DispatchQueue(label: \"com.felix.felix\")q.sync &#123; (1...5).forEach(&#123; i in print(\"ğŸ \\(Thread.current) + \\(i)\") &#125;)&#125;q.async &#123; (6...10).forEach(&#123; i in print(\"ğŸ‡ \\(Thread.current) + \\(i)\") &#125;)&#125;(11...15).forEach(&#123; i in print(\"ğŸŒ \\(Thread.current) + \\(i)\")&#125;) ä¸Šé¢æˆ‘ä»¬å…ˆæ˜¯å£°æ˜ä¸€ä¸ªé˜Ÿåˆ— , ä½¿ç”¨syncæ·»åŠ ä¸€ä¸ªåŒæ­¥çš„ä»»åŠ¡è¾“å‡º1åˆ°5 ï¼Œ ä½¿ç”¨asyncå¼‚æ­¥è¾“å‡º6åˆ°10 ï¼Œ åŒæ—¶åœ¨ä¸»çº¿ç¨‹æ‰“å°11åˆ°15 ã€‚ æŒ‰ä¸‹command+Rè¿è¡Œproject ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸‹è¾“å‡º 12345678910111213141516ğŸ &lt;NSThread: 0x103103480&gt;&#123;number = 1, name = main&#125; + 1ğŸ &lt;NSThread: 0x103103480&gt;&#123;number = 1, name = main&#125; + 2ğŸ &lt;NSThread: 0x103103480&gt;&#123;number = 1, name = main&#125; + 3ğŸ &lt;NSThread: 0x103103480&gt;&#123;number = 1, name = main&#125; + 4ğŸ &lt;NSThread: 0x103103480&gt;&#123;number = 1, name = main&#125; + 5ğŸŒ &lt;NSThread: 0x103103480&gt;&#123;number = 1, name = main&#125; + 11ğŸ‡ &lt;NSThread: 0x103007940&gt;&#123;number = 2, name = (null)&#125; + 6ğŸŒ &lt;NSThread: 0x103103480&gt;&#123;number = 1, name = main&#125; + 12ğŸ‡ &lt;NSThread: 0x103007940&gt;&#123;number = 2, name = (null)&#125; + 7ğŸŒ &lt;NSThread: 0x103103480&gt;&#123;number = 1, name = main&#125; + 13ğŸ‡ &lt;NSThread: 0x103007940&gt;&#123;number = 2, name = (null)&#125; + 8ğŸŒ &lt;NSThread: 0x103103480&gt;&#123;number = 1, name = main&#125; + 14ğŸ‡ &lt;NSThread: 0x103007940&gt;&#123;number = 2, name = (null)&#125; + 9ğŸŒ &lt;NSThread: 0x103103480&gt;&#123;number = 1, name = main&#125; + 15ğŸ‡ &lt;NSThread: 0x103007940&gt;&#123;number = 2, name = (null)&#125; + 10Program ended with exit code: 0 æˆ‘ä»¬å¯ä»¥çœ‹åˆ° ï¼Œ ğŸä»£è¡¨çš„ä»»åŠ¡å…¨éƒ¨æ˜¯ä¼˜å…ˆæ‰§è¡Œçš„ ï¼Œ è¿™è¯´æ˜syncæ·»åŠ çš„ä»»åŠ¡ä¼šé˜»å¡å½“å‰çº¿ç¨‹ ï¼Œ åœ¨çœ‹åˆ°ğŸŒå’ŒğŸ‡æ˜¯å‡åŒ€åˆ†éƒ¨çš„ ã€‚ è¿™æ˜¯ç”±äºasyncæ·»åŠ çš„ä»»åŠ¡ä¼šé»˜è®¤åŠ å…¥ç”±ç³»ç»Ÿç®¡ç†çš„çº¿ç¨‹æ±  ï¼Œ å¼‚æ­¥æ‰§è¡Œ ã€‚ ä¼˜å…ˆçº§ QoSå½“å¤šä¸ªé˜Ÿåˆ—åŒæ—¶æ‰§è¡Œçš„æ—¶å€™ ï¼Œ ç³»ç»Ÿéœ€è¦çŸ¥é“å“ªä¸ªé˜Ÿåˆ—ä¼˜å…ˆçº§æ›´é«˜ ï¼Œ æ‰èƒ½ä¼˜å…ˆå®‰æ’è®¡ç®—èµ„æºç»™ä»– ï¼Œ æˆ‘ä»¬å¯ä»¥è¿™æ ·å®šä¹‰ä¼˜å…ˆçº§ï¼š 1let q = DispatchQueue(label: \"com.felix.felix\", qos: DispatchQoS.background) åˆå§‹åŒ–çš„æ—¶å€™åŠ ä¸Šqoså‚æ•° ï¼Œ qosï¼ˆquality of serviceï¼‰ä»å­—é¢ä¸Šç†è§£å°±æ˜¯ã€ŒæœåŠ¡è´¨é‡ã€ï¼Œåœ¨swiftä¸­æ˜¯è¿™æ ·å®šä¹‰çš„ï¼š 12345678910111213141516171819202122232425public enum QoSClass &#123; @available(OSX 10.10, iOS 8.0, *) case background @available(OSX 10.10, iOS 8.0, *) case utility @available(OSX 10.10, iOS 8.0, *) case `default` @available(OSX 10.10, iOS 8.0, *) case userInitiated @available(OSX 10.10, iOS 8.0, *) case userInteractive case unspecified @available(OSX 10.10, iOS 8.0, *) public init?(rawValue: qos_class_t) @available(OSX 10.10, iOS 8.0, *) public var rawValue: qos_class_t &#123; get &#125; &#125; User Interactiveï¼š å’Œç”¨æˆ·äº¤äº’ç›¸å…³ï¼Œæ¯”å¦‚åŠ¨ç”»ç­‰ç­‰ä¼˜å…ˆçº§æœ€é«˜ã€‚æ¯”å¦‚ç”¨æˆ·è¿ç»­æ‹–æ‹½çš„è®¡ç®— User Initiatedï¼š éœ€è¦ç«‹åˆ»çš„ç»“æœï¼Œæ¯”å¦‚pushä¸€ä¸ªViewControllerä¹‹å‰çš„æ•°æ®è®¡ç®— Utilityï¼š å¯ä»¥æ‰§è¡Œå¾ˆé•¿æ—¶é—´ï¼Œå†é€šçŸ¥ç”¨æˆ·ç»“æœã€‚æ¯”å¦‚ä¸‹è½½ä¸€ä¸ªæ–‡ä»¶ï¼Œç»™ç”¨æˆ·ä¸‹è½½è¿›åº¦ã€‚ Backgroundï¼š ç”¨æˆ·ä¸å¯è§ï¼Œæ¯”å¦‚åœ¨åå°å­˜å‚¨å¤§é‡æ•°æ® åœ¨é€‰æ‹©æ—¶ä½ è¦å…ˆæ€è€ƒä¸€ä¸‹å‡ ä¸ªé—®é¢˜ ã€‚ è¿™ä¸ªä»»åŠ¡æ˜¯ç”¨æˆ·å¯è§çš„å—ï¼Ÿ è¿™ä¸ªä»»åŠ¡å’Œç”¨æˆ·äº¤äº’æœ‰å…³å—ï¼Ÿ è¿™ä¸ªä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´æœ‰å¤šå°‘ï¼Ÿ è¿™ä¸ªä»»åŠ¡çš„æœ€ç»ˆç»“æœå’ŒUIæœ‰å…³ç³»å—ï¼Ÿ å¹¶å‘é˜Ÿåˆ—é»˜è®¤æƒ…å†µä¸‹æ·»åŠ è¿›Queueçš„ä»»åŠ¡ä¼šä¸²è¡Œæ‰§è¡Œ ï¼Œ å…ˆæ‰§è¡Œå®Œä¸€ä¸ªå†æ‰§è¡Œä¸‹ä¸€ä¸ªï¼š 1234567891011121314151617import Foundationlet q = DispatchQueue(label: \"com.felix.felix\")q.async &#123; (1...5).forEach(&#123; i in print(\"ğŸ \\(Thread.current) + \\(i)\") &#125;)&#125;q.async &#123; (6...10).forEach(&#123; i in print(\"ğŸ‡ \\(Thread.current) + \\(i)\") &#125;)&#125;(11...15).forEach(&#123; i in print(\"ğŸŒ \\(Thread.current) + \\(i)\")&#125;) è¿è¡Œçœ‹ä¸‹æ—¥å¿—è¾“å‡º 123456789101112131415ğŸ &lt;NSThread: 0x102a081a0&gt;&#123;number = 2, name = (null)&#125; + 1ğŸŒ &lt;NSThread: 0x100f046f0&gt;&#123;number = 1, name = main&#125; + 11ğŸ &lt;NSThread: 0x102a081a0&gt;&#123;number = 2, name = (null)&#125; + 2ğŸŒ &lt;NSThread: 0x100f046f0&gt;&#123;number = 1, name = main&#125; + 12ğŸ &lt;NSThread: 0x102a081a0&gt;&#123;number = 2, name = (null)&#125; + 3ğŸŒ &lt;NSThread: 0x100f046f0&gt;&#123;number = 1, name = main&#125; + 13ğŸ &lt;NSThread: 0x102a081a0&gt;&#123;number = 2, name = (null)&#125; + 4ğŸŒ &lt;NSThread: 0x100f046f0&gt;&#123;number = 1, name = main&#125; + 14ğŸ &lt;NSThread: 0x102a081a0&gt;&#123;number = 2, name = (null)&#125; + 5ğŸŒ &lt;NSThread: 0x100f046f0&gt;&#123;number = 1, name = main&#125; + 15ğŸ‡ &lt;NSThread: 0x102a081a0&gt;&#123;number = 2, name = (null)&#125; + 6ğŸ‡ &lt;NSThread: 0x102a081a0&gt;&#123;number = 2, name = (null)&#125; + 7ğŸ‡ &lt;NSThread: 0x102a081a0&gt;&#123;number = 2, name = (null)&#125; + 8ğŸ‡ &lt;NSThread: 0x102a081a0&gt;&#123;number = 2, name = (null)&#125; + 9Program ended with exit code: 0 æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç›´åˆ°ğŸéƒ½è¾“å‡ºå®Œæ¯•æ‰ä¼šè¾“å‡ºğŸ‡ ï¼Œ æœ‰æ—¶å€™æˆ‘ä»¬æƒ³æŠŠä»»åŠ¡å¹¶è¡Œæ‰§è¡Œ ï¼Œ æ€ä¹ˆåŠå‘¢ ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥è®¾ç½®queueçš„Attributes ã€‚ 1let q = DispatchQueue(label: \"com.felix.felix\", attributes: DispatchQueue.Attributes.concurrent) å†è¿è¡Œä¸‹ ã€‚ çœ‹çœ‹ä¼šæ€æ ·è¾“å‡ºå§ . DispatchWorkItemæœ‰çš„æ—¶å€™ ï¼Œ å¯¹äºåŒä¸€ä¸ªæ“ä½œæˆ‘ä»¬æœ‰å¯èƒ½ä¼šæ”¾åœ¨ä¸åŒçš„çº¿ç¨‹ä¸­å»æ‰§è¡Œ ï¼Œ è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŠŠè¿™ä¸ªæ“ä½œç”¨DispatchWorkItemçš„å½¢å¼åŒ…è£¹èµ·æ¥ ï¼Œ åœ¨ä¸åŒçš„çº¿ç¨‹ä¸­æ‰§è¡Œ ã€‚ 1234567891011121314151617181920212223242526import Foundationlet group = DispatchGroup()let q = DispatchQueue(label: \"com.felix.felix\", attributes: DispatchQueue.Attributes.concurrent)let item1 = DispatchWorkItem &#123; (1...5).forEach(&#123; i in print(\"ğŸ \\(Thread.current) + \\(i)\") &#125;)&#125;let item2 = DispatchWorkItem &#123; (6...10).forEach(&#123; i in print(\"ğŸ‡ \\(Thread.current) + \\(i)\") &#125;)&#125;q.async(execute: item1)q.async(execute: item2)(11...15).forEach(&#123; i in print(\"ğŸŒ \\(Thread.current) + \\(i)\")&#125;) GroupDispatchGroup å¯ä»¥ç”¨æ¥ç®¡ç†ä¸€ç»„é˜Ÿåˆ— ï¼Œ ç›‘å¬æ‰€æœ‰é˜Ÿåˆ—çš„æ‰€æœ‰ä»»åŠ¡éƒ½å®Œæˆçš„é€šçŸ¥ ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„å°±æ˜¯åœ¨ä¸€ä¸ªé¡µé¢è¯·æ±‚å¤šä¸ªæ¥å£çš„æ—¶å€™ ï¼Œå…¨éƒ¨è¯·æ±‚å®Œå†åˆ·æ–°UI ã€‚ pass å»¶æ—¶æ‰§è¡Œpass çº¿ç¨‹å®‰å…¨pass æ€»ç»“æ€»ä¹‹ ï¼Œ ä½¿ç”¨GCDä¸€æ–¹é¢ä¼šæå‡æˆ‘ä»¬åº”ç”¨çš„æ€§èƒ½ ï¼Œ ç»™ç”¨æˆ·å¸¦æ¥æ›´å¥½çš„ä½“éªŒ ï¼Œ å¦ä¸€æ–¹é¢ä½¿ç”¨å¾—å½“ä¹Ÿèƒ½è§£å†³çº¿ç¨‹å®‰å…¨ç­‰é—®é¢˜ ã€‚","categories":[],"tags":[{"name":"swift","slug":"swift","permalink":"https://felixplusplus.github.io/tags/swift/"},{"name":"GCD","slug":"GCD","permalink":"https://felixplusplus.github.io/tags/GCD/"}]},{"title":"æµ…è°ˆObjCä¸­loadæ–¹æ³•","slug":"load","date":"2018-06-10T03:27:09.000Z","updated":"2018-08-18T10:50:59.287Z","comments":true,"path":"2018/06/10/load/","link":"","permalink":"https://felixplusplus.github.io/2018/06/10/load/","excerpt":"","text":"åœ¨ä½¿ç”¨runtimeè¿›è¡Œ method swizz çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸€èˆ¬æ˜¯åœ¨loadæ–¹æ³•ä¸­è¿›è¡Œæ–¹æ³•äº¤æ¢ 12345+ (void)load&#123; Method m = class_getInstanceMethod([self class], @selector(somemethod)); Method m0 = class_getInstanceMethod([self class], NSSelectorFromString(@\"somemethod\")); method_exchangeImplementations(m2, m1);&#125; é‚£ä¹ˆï¼Œè¿™ä¸ªloadæ–¹æ³•æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Œæ˜¯ä»€ä¹ˆåŸç†å‘¢? é€šè¿‡é˜…è¯»runtimeçš„æºä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªé¡ºåº loadæ˜¯åœ¨ç±»è¢«æ·»åŠ è¿›runtimeå¼€å§‹æ‰§è¡Œçš„ æ¯ä¸ªloadæ–¹æ³•åªä¼šæ‰§è¡Œä¸€æ¬¡ ä¸ä¼šæ²¿ç”¨çˆ¶ç±»çš„å®ç° æ¯ä¸ªç±»çš„çˆ¶ç±»å…ˆæ‰§è¡Œï¼Œç„¶åæ˜¯å­ç±»ï¼Œæœ€åæ˜¯categoryåˆ†ç±» (é€’å½’) æ²¡æœ‰[obj sendmsg]çš„é‚£ä¸€å¥—æ–¹æ³•æŸ¥æ‰¾è¿‡ç¨‹ï¼Œç›´æ¥è·å–å‡½æ•°æŒ‡é’ˆæ‰§è¡Œ å…ˆå°±è¿™ä¹ˆå¤šäº†ï¼Œæ¬¢è¿è¡¥å……","categories":[],"tags":[{"name":"Objective-C","slug":"Objective-C","permalink":"https://felixplusplus.github.io/tags/Objective-C/"}]},{"title":"å…³äºObjective-Cçš„Property","slug":"property","date":"2018-06-04T12:53:32.000Z","updated":"2018-08-13T05:13:33.809Z","comments":true,"path":"2018/06/04/property/","link":"","permalink":"https://felixplusplus.github.io/2018/06/04/property/","excerpt":"","text":"ä¸€ç‚¹å…³äºObjective-Cä¸­åˆæˆå­˜å–å™¨@propertyçš„æ€»ç»“åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šä½¿ç”¨ 1@property (nonatomic,strong) Obj *obj è¿™æ ·çš„è¡¨ç°å½¢å¼æ¥ä¿®é¥°å½“å‰å¯¹è±¡çš„æˆå‘˜å±æ€§ï¼Œå¤§å®¶éƒ½çŸ¥é“ï¼Œç›¸å¯¹äºæ‰‹å·¥åˆ›å»ºæˆå‘˜å˜é‡ï¼Œ@propertyç­‰äºå˜é‡åŠ Getter&amp;Setterï¼Œé‚£ä¹ˆå…ˆè®©æˆ‘ä»¬çœ‹ä¸‹æ—¥å¸¸çš„ç”¨æ³•ï¼Œä¸€ä¸‹ä¸ºä¸€äº›å¸¸ç”¨çš„å…³é”®å­—ï¼š atomic nonatomic readonly assign strong weak copy unsafe_unretained retain ä¸‹é¢åˆ†åˆ«ç®€å•ä»‹ç»ä¸€ä¸‹å„ä¸ªä¿®é¥°ç¬¦ä»£è¡¨çš„æ„æ€ \batomic/nonatomicatoimcä¸nonatomicæ˜¯å¯¹åº”çš„å±æ€§ï¼Œå…¶ä¸­ï¼Œnonatomicè¡¨ç¤ºéçº¿ç¨‹å®‰å…¨çš„ï¼Œä¼˜ç‚¹æ˜¯å†…å­˜å¼€é”€å°ï¼Œç›¸å¯¹è€Œè¨€çš„ç¼ºç‚¹æ˜¯åœ¨å¤šçº¿ç¨‹è®¿é—®çš„è¿‡ç¨‹ä¸­å¹¶ä¸å®‰å…¨ï¼Œä½†æ˜¯atomicä¹Ÿä¸ä¿è¯ä¸€å®šå°±ä¼šçº¿ç¨‹å®‰å…¨ï¼Œä¸ºäº†ä¿è¯å±æ€§è®¿é—®\bçš„çº¿ç¨‹å®‰å…¨ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æˆå‘˜å˜é‡çš„è¯»å–åŠ é”ï¼Œè¿™ä¸€èŠ‚ä¸å¯¹é”è¿‡å¤šåšä»‹ç»ï¼Œæ—¥å¸¸ä¸­å¤§éƒ¨åˆ†çš„è¯»å–å±æ€§\bæˆ‘ä»¬éƒ½æ˜¯ä½¿ç”¨éçº¿ç¨‹å®‰å…¨çš„nonatomicã€‚ readonlyæˆ‘ä»¬ä¸€èˆ¬å°†propertyå«åš\båˆæˆå­˜å–å™¨ï¼Œå› ä¸ºå®ƒå¸®æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆäº†getter&amp;setteræ–¹æ³•ï¼Œreadonlyåˆ™è¡¨ç¤ºåœ¨è‡ªåŠ¨ç”Ÿæˆå­˜å–æ–¹æ³•çš„æ—¶å€™ï¼Œä¸ç”Ÿæˆgetteræ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ç±»å¯¹æŠ—å¤–éƒ¨ä¸èƒ½ç›´æ¥å¯¹ç±»å®ä¾‹çš„è¯¥å±æ€§è¿›è¡Œèµ‹å€¼æ“ä½œï¼Œå½“æˆ‘ä»¬ä¸æ˜¾å¼è®¾å®šreadonlyçš„æ—¶å€™ï¼Œåˆæˆå­˜å–åˆ™é»˜è®¤ä¸ºreadwriteï¼Œå³å¤–éƒ¨å¯è¯»å¯å†™ã€‚ assignassignå¸¸ç”¨äºç®€å•æ•°æ®ç±»å‹ï¼Œå«ä¹‰ä¸ºå½“å‰å±æ€§ä»…ä»…ç”¨äºèµ‹å€¼æ“ä½œï¼Œå¹¶ä¸ä¼šæŒæœ‰è¯¥å±æ€§ï¼Œäº¦ä¸ä¼šå¢åŠ è¯¥å±æ€§çš„å¼•ç”¨è®¡æ•°ï¼Œè‹¥è¯¥å±æ€§ä¸ºå¯¹è±¡ç±»å‹åˆ™å¦‚æœè¯¥å±æ€§é”€æ¯æ—¶å¹¶ä¸ä¼šé€šçŸ¥å½“å‰ç±»å¯¹è±¡ï¼Œæ‰€ä»¥æŒ‡é’ˆä»ç„¶æŒ‡å‘ä¹‹å‰çš„å†…å­˜åœ°å€ï¼Œè¿™æ˜¯è°ƒç”¨getè¯¥å±æ€§æ—¶ä¼šå¯¼è‡´é‡æŒ‡é’ˆã€‚ strongstrongä»å­—é¢æ¥ç†è§£å°±æ˜¯ã€å¼ºã€‘çš„æ„æ€ï¼Œé‚£ä¹ˆå½“propertyå£°æ˜ä¸ºstrongæ—¶ï¼Œè¡¨ç¤ºè¯¥å¯¹è±¡å¯¹è¯¥å±æ€§ä¸ºå¼ºå¼•ç”¨å…³ç³»ï¼Œä¼šå¢åŠ è¯¥æˆå‘˜å±æ€§çš„å¼•ç”¨è®¡æ•°ï¼Œæ‰€ä»¥è¯¥å­—æ®µåªèƒ½ç”¨äºä¿®é¥°å¯¹è±¡ç±»å‹è€Œä¸èƒ½ä¿®é¥°åŸºæœ¬ç±»å‹ã€‚è¿™æ ·å½“è‡ªåŠ¨é‡Šæ”¾æ± æ£€æŸ¥å¯¹è±¡çš„é¥®ç”¨è®¡æ•°æ—¶ï¼Œåªè¦å½“å‰ç±»å¯¹è±¡æœªé‡Šæ”¾åˆ™è¯¥å±æ€§å¼•ç”¨è®¡æ•°å°±ä¸ä¼šä¸º0ã€‚åœ¨è¯¥å±æ€§è¢«èµ‹å€¼æ—¶ä¼šå…ˆå¢åŠ æ–°å€¼çš„å¼•ç”¨è®¡æ•°ï¼Œå†å‡å°‘æ—§å€¼çš„å¼•ç”¨è®¡æ•°ã€‚ weakweakæœ€å¸¸ä½¿ç”¨çš„åœºæ™¯æ—¶ä¸ºæ ‡è®°è¯¥å±æ€§ä¸ºä»£ç†ï¼Œé¿å…å¾ªç¯å¼•ç”¨çš„æ—¶å€™ï¼Œä¸strongæ°æ°ç›¸åï¼Œè¡¨ç¤ºå¯¹è¯¥å±æ€§èµ‹å€¼æ—¶å¹¶ä¸ä¼šå¢åŠ å…¶å¼•ç”¨è®¡æ•°ï¼Œä¹Ÿä¸ä¼šå‡å°‘æ—§å€¼çš„å¼•ç”¨è®¡æ•°ï¼Œå±äºâ€˜è™½ç„¶ä»å½“å‰å¯¹è±¡èƒ½æŸ¥çœ‹åˆ°è¿™ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯æ²¡å•¥å…³ç³»â€™çš„é‚£ç§ã€‚å½“è¯¥å±æ€§è¢«é”€æ¯æ—¶propertyä¼šè‡ªåŠ¨ç½®ä¸ºnilï¼Œé˜²æ­¢é‡æŒ‡é’ˆã€‚ copycopyå¸¸ç”¨è¯­ä¿®é¥°blockä¸å­—ç¬¦ä¸²ï¼Œç”±copyä¿®é¥°çš„å¯¹è±¡å¤åˆ¶æ“ä½œæ—¶ä¼šä»å†…å­˜ç©ºé—´æ‹·è´ä¸€ä»½ï¼Œæ³¨æ„ï¼Œä¸è¦ç”¨copyä¿®é¥°å¯å˜ç±»å‹å¦‚NSMutableArrayç­‰ã€‚ unsafe_unretainedå¤§éƒ¨åˆ†åŒassignï¼Œä¸åŒåœ¨äºunsafe_unretainedä»…å¯ç”¨æ¥ä¿®é¥°åŸºæœ¬æ•°æ®ç±»å‹ retainå¤§éƒ¨åˆ†åŒstrongï¼Œç”±äºå†arcä¸‹è¾£é¸¡è‡ªåŠ¨å›æ”¶ï¼Œæ‰€ä»¥ä¸æ€ä¹ˆä½¿ç”¨è¯¥ä¿®é¥°ã€‚åœ¨MRCä¸‹åŸºæœ¬ç­‰åŒä¸strongã€‚","categories":[],"tags":[{"name":"Objective-C","slug":"Objective-C","permalink":"https://felixplusplus.github.io/tags/Objective-C/"}]},{"title":"KVO","slug":"kvo","date":"2018-03-14T03:08:57.000Z","updated":"2018-08-18T10:50:41.358Z","comments":true,"path":"2018/03/14/kvo/","link":"","permalink":"https://felixplusplus.github.io/2018/03/14/kvo/","excerpt":"","text":"é”®å€¼ç›‘å¬KVOå…ˆä¸Šç»“è®ºï¼š å½“è§‚å¯ŸæŸå¯¹è±¡ A æ—¶ï¼ŒKVO æœºåˆ¶åŠ¨æ€åˆ›å»ºä¸€ä¸ªå¯¹è±¡Aå½“å‰ç±»çš„å­ç±»ï¼Œå¹¶ä¸ºè¿™ä¸ªæ–°çš„å­ç±»é‡å†™äº†è¢«è§‚å¯Ÿå±æ€§ keyPath çš„ setter æ–¹æ³•ã€‚setter æ–¹æ³•éšåè´Ÿè´£é€šçŸ¥è§‚å¯Ÿå¯¹è±¡å±æ€§çš„æ”¹å˜çŠ¶å†µã€‚ æ·±å…¥å‰–æï¼š Apple ä½¿ç”¨äº† isa æ··å†™ï¼ˆisa-swizzlingï¼‰æ¥å®ç° KVO ã€‚å½“è§‚å¯Ÿå¯¹è±¡Aæ—¶ï¼ŒKVOæœºåˆ¶åŠ¨æ€åˆ›å»ºä¸€ä¸ªæ–°çš„åä¸ºï¼šNSKVONotifying_A çš„æ–°ç±»ï¼Œè¯¥ç±»ç»§æ‰¿è‡ªå¯¹è±¡Açš„æœ¬ç±»ï¼Œä¸” KVO ä¸º NSKVONotifying_A é‡å†™è§‚å¯Ÿå±æ€§çš„ setter æ–¹æ³•ï¼Œsetter æ–¹æ³•ä¼šè´Ÿè´£åœ¨è°ƒç”¨åŸ setter æ–¹æ³•ä¹‹å‰å’Œä¹‹åï¼Œé€šçŸ¥æ‰€æœ‰è§‚å¯Ÿå¯¹è±¡å±æ€§å€¼çš„æ›´æ”¹æƒ…å†µã€‚ï¼ˆå¤‡æ³¨ï¼š isa æ··å†™ï¼ˆisa-swizzlingï¼‰isaï¼šis a kind of ï¼› swizzlingï¼šæ··åˆï¼Œæ…åˆï¼›ï¼‰ â‘ NSKVONotifying_A ç±»å‰–æï¼šåœ¨è¿™ä¸ªè¿‡ç¨‹ï¼Œè¢«è§‚å¯Ÿå¯¹è±¡çš„ isa æŒ‡é’ˆä»æŒ‡å‘åŸæ¥çš„ A ç±»ï¼Œè¢« KVO æœºåˆ¶ä¿®æ”¹ä¸ºæŒ‡å‘ç³»ç»Ÿæ–°åˆ›å»ºçš„å­ç±» NSKVONotifying_A ç±»ï¼Œæ¥å®ç°å½“å‰ç±»å±æ€§å€¼æ”¹å˜çš„ç›‘å¬æ‰€ä»¥å½“æˆ‘ä»¬ä»åº”ç”¨å±‚é¢ä¸Šçœ‹æ¥ï¼Œå®Œå…¨æ²¡æœ‰æ„è¯†åˆ°æœ‰æ–°çš„ç±»å‡ºç°ï¼Œè¿™æ˜¯ç³»ç»Ÿâ€œéšç’â€äº†å¯¹ KVO çš„åº•å±‚å®ç°è¿‡ç¨‹ï¼Œè®©æˆ‘ä»¬è¯¯ä»¥ä¸ºè¿˜æ˜¯åŸæ¥çš„ç±»ã€‚ä½†æ˜¯æ­¤æ—¶å¦‚æœæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„åä¸ºâ€œNSKVONotifying_Aâ€çš„ç±»ï¼Œå°±ä¼šå‘ç°ç³»ç»Ÿè¿è¡Œåˆ°æ³¨å†Œ KVO çš„é‚£æ®µä»£ç æ—¶ç¨‹åºå°±å´©æºƒï¼Œå› ä¸ºç³»ç»Ÿåœ¨æ³¨å†Œç›‘å¬çš„æ—¶å€™åŠ¨æ€åˆ›å»ºäº†åä¸º NSKVONotifying_A çš„ä¸­é—´ç±»ï¼Œå¹¶æŒ‡å‘è¿™ä¸ªä¸­é—´ç±»äº†ã€‚ ï¼ˆisa æŒ‡é’ˆçš„ä½œç”¨ï¼šæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ isa æŒ‡é’ˆï¼ŒæŒ‡å‘è¯¥å¯¹è±¡çš„ç±»ï¼Œå®ƒå‘Šè¯‰ Runtime ç³»ç»Ÿè¿™ä¸ªå¯¹è±¡çš„ç±»æ˜¯ä»€ä¹ˆã€‚æ‰€ä»¥å¯¹è±¡æ³¨å†Œä¸ºè§‚å¯Ÿè€…æ—¶ï¼Œisa æŒ‡é’ˆæŒ‡å‘æ–°å­ç±»ï¼Œé‚£ä¹ˆè¿™ä¸ªè¢«è§‚å¯Ÿçš„å¯¹è±¡å°±ç¥å¥‡åœ°å˜æˆæ–°å­ç±»çš„å¯¹è±¡ï¼ˆæˆ–å®ä¾‹ï¼‰äº†ã€‚ï¼‰ å› è€Œåœ¨è¯¥å¯¹è±¡ä¸Šå¯¹ setter çš„è°ƒç”¨å°±ä¼šè°ƒç”¨å·²é‡å†™çš„ setterï¼Œä»è€Œæ¿€æ´»é”®å€¼é€šçŸ¥æœºåˆ¶ã€‚â€”&gt;æˆ‘çŒœï¼Œè¿™ä¹Ÿæ˜¯ KVO å›è°ƒæœºåˆ¶ï¼Œä¸ºä»€ä¹ˆéƒ½ä¿—ç§°KVOæŠ€æœ¯ä¸ºé»‘é­”æ³•çš„åŸå› ä¹‹ä¸€å§ï¼šå†…éƒ¨ç¥ç§˜ã€å¤–è§‚ç®€æ´ã€‚ â‘¡å­ç±»setteræ–¹æ³•å‰–æï¼šKVO çš„é”®å€¼è§‚å¯Ÿé€šçŸ¥ä¾èµ–äº NSObject çš„ä¸¤ä¸ªæ–¹æ³•:willChangeValueForKey:å’Œ didChangevlueForKey:åœ¨å­˜å–æ•°å€¼çš„å‰ååˆ†åˆ«è°ƒç”¨ 2 ä¸ªæ–¹æ³•ï¼šè¢«è§‚å¯Ÿå±æ€§å‘ç”Ÿæ”¹å˜ä¹‹å‰ï¼ŒwillChangeValueForKey:è¢«è°ƒç”¨ï¼Œé€šçŸ¥ç³»ç»Ÿè¯¥ keyPath çš„å±æ€§å€¼å³å°†å˜æ›´ï¼›å½“æ”¹å˜å‘ç”Ÿåï¼Œ didChangeValueForKey: è¢«è°ƒç”¨ï¼Œé€šçŸ¥ç³»ç»Ÿè¯¥ keyPath çš„å±æ€§å€¼å·²ç»å˜æ›´ï¼›ä¹‹åï¼Œ observeValueForKey:ofObject:change:context: ä¹Ÿä¼šè¢«è°ƒç”¨ã€‚ä¸”é‡å†™è§‚å¯Ÿå±æ€§çš„ setter æ–¹æ³•è¿™ç§ç»§æ‰¿æ–¹å¼çš„æ³¨å…¥æ˜¯åœ¨è¿è¡Œæ—¶è€Œä¸æ˜¯ç¼–è¯‘æ—¶å®ç°çš„ã€‚ ç‰¹ç‚¹ï¼š è§‚å¯Ÿè€…è§‚å¯Ÿçš„æ˜¯å±æ€§ï¼Œåªæœ‰éµå¾ª KVO å˜æ›´å±æ€§å€¼çš„æ–¹å¼æ‰ä¼šæ‰§è¡Œ KVO çš„å›è°ƒæ–¹æ³•ï¼Œä¾‹å¦‚æ˜¯å¦æ‰§è¡Œäº† setter æ–¹æ³•ã€æˆ–è€…æ˜¯å¦ä½¿ç”¨äº† KVC èµ‹å€¼ã€‚å¦‚æœèµ‹å€¼æ²¡æœ‰é€šè¿‡ setter æ–¹æ³•æˆ–è€… KVCï¼Œè€Œæ˜¯ç›´æ¥ä¿®æ”¹å±æ€§å¯¹åº”çš„æˆå‘˜å˜é‡ï¼Œä¾‹å¦‚ï¼šä»…è°ƒç”¨ _name = @â€newNameâ€ï¼Œè¿™æ—¶æ˜¯ä¸ä¼šè§¦å‘ KVO æœºåˆ¶ï¼Œæ›´åŠ ä¸ä¼šè°ƒç”¨å›è°ƒæ–¹æ³•çš„ã€‚æ‰€ä»¥ä½¿ç”¨ KVO æœºåˆ¶çš„å‰ææ˜¯éµå¾ª KVO çš„å±æ€§è®¾ç½®æ–¹å¼æ¥å˜æ›´å±æ€§å€¼ã€‚ ä½¿ç”¨ï¼šé¦–å…ˆ ï¼Œ æ‰“å¼€Xcodeåˆ›å»ºä¸€ä¸ªcommandlineToolçš„å·¥ç¨‹ ï¼Œ è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªPersonç±» ï¼Œ å¹¶ä¸ºå…¶å®ç°observeæ–¹æ³• 1234567891011121314151617181920#import &lt;Foundation/Foundation.h&gt;@interface Person : NSObject@property (nonatomic , copy) NSString *name;@end#import \"Person.h\"@implementation Person- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary&lt;NSKeyValueChangeKey,id&gt; *)change context:(void *)context &#123; id old = [change objectForKey:NSKeyValueChangeOldKey]; id new = [change objectForKey:NSKeyValueChangeNewKey]; NSLog(@\"I am %@\",self.name); NSLog(@\"I observe he change his name from %@ to %@\",old,new);&#125;@end æ‰“å¼€main.m 12345678910111213141516171819202122#import &lt;Foundation/Foundation.h&gt;#import \"Person.h\"int main(int argc, const char * argv[]) &#123; @autoreleasepool &#123; // insert code here... Person *alice = [Person new]; alice.name = @\"alice\"; Person *alex = [Person new]; alex.name = @\"alex\"; [alex addObserver:alice forKeyPath:@\"name\" options:NSKeyValueObservingOptionNew|NSKeyValueObservingOptionOld context:nil]; alex.name = @\"alex.å–œé©¬æ‹‰é›….é“å±±\"; alex.name = @\"è¥¿é—¨å¹ç‰›\"; alex.name = @\"å…³è°·\"; [alex removeObserver:alice forKeyPath:@\"name\"]; alex.name = @\"æ¬§é˜³\"; &#125; return 0;&#125; è§£é‡Šä¸€ä¸‹ä¸Šé¢çš„ä»£ç  åˆ›å»ºä¸¤ä¸ªPersonçš„å®ä¾‹ ï¼Œ aliceå’Œalex å°†aliceè®¾ç½®ä¸ºalexçš„nameå±æ€§çš„è§‚å¯Ÿè€… é€‰é¡¹ä¸ºè§‚å¯Ÿæ–°å€¼å’Œæ—§å€¼ æ›´æ”¹alexçš„name åˆ é™¤è§‚å¯Ÿè€… å†æ¬¡æ›´æ”¹alexçš„name æˆ‘ä»¬æŒ‰ä¸‹command+R è¿è¡Œä¸€ä¸‹å¯ä»¥çœ‹åˆ°ä»¥ä¸‹è¾“å‡º 1234567Test[82281:3097986] I am aliceTest[82281:3097986] I observe he change his name from alex to alex.å–œé©¬æ‹‰é›….é“å±±Test[82281:3097986] I am aliceTest[82281:3097986] I observe he change his name from alex.å–œé©¬æ‹‰é›….é“å±± to è¥¿é—¨å¹ç‰›Test[82281:3097986] I am aliceTest[82281:3097986] I observe he change his name from è¥¿é—¨å¹ç‰› to å…³è°·Program ended with exit code: 0 å¯ä»¥åˆ°KVOçš„ä½¿ç”¨è¿˜æ˜¯éå¸¸æ–¹ä¾¿çš„ ï¼Œ ä¸è¿‡è¦æ³¨æ„ä½¿ç”¨å®Œä¹‹åè¦ç§»é™¤è§‚å¯Ÿè€…å“¦ ã€‚","categories":[],"tags":[{"name":"Objective-C","slug":"Objective-C","permalink":"https://felixplusplus.github.io/tags/Objective-C/"},{"name":"KVO","slug":"KVO","permalink":"https://felixplusplus.github.io/tags/KVO/"}]},{"title":"æˆ‘æ‰€äº†è§£çš„KVC","slug":"kvc","date":"2018-02-12T03:08:54.000Z","updated":"2018-08-18T10:50:28.900Z","comments":true,"path":"2018/02/12/kvc/","link":"","permalink":"https://felixplusplus.github.io/2018/02/12/kvc/","excerpt":"","text":"å…ˆä»‹ç»ä¸‹KVCï¼ˆKey-value codingï¼‰é”®å€¼ç¼–ç ï¼Œä»åå­—å¤§æ¦‚å¯ä»¥æ¨æ–­å‡ºåŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯æ ¹æ®å¯¹è±¡çš„å±æ€§åç§°è¿™ä¸ªâ€˜keyâ€˜æ¥è®¾ç½®å’Œæ“ä½œâ€™valueâ€˜ï¼Œå¥½ï¼Œé‚£ä¹ˆè®©æˆ‘ä»¬å…ˆä¸Šæ‰‹è¯•ä¸€ä¸‹ã€‚ æ‰“å¼€Xcodeï¼Œé€‰æ‹©æ–°å»ºå·¥ç¨‹ï¼Œé€‰æ‹©macosï¼Œç„¶åé€‰æ‹©commandlineã€‚ æ–°å»ºå­¦ç”Ÿç±» 12345@interface Student : NSObject@property (nonatomic, copy) NSString *name;@end æ‰¾åˆ°main.m 123456789101112131415#import &lt;Foundation/Foundation.h&gt;#import \"Student.h\"int main(int argc, const char * argv[]) &#123; @autoreleasepool &#123; // insert code here... Student *s = [Student new]; [s setValue:@\"zhangsan\" forKey:@\"name\"]; NSLog(@\"%@\", [s valueForKey:@\"name\"]); &#125; return 0;&#125; ç¥å¥‡å§ ï¼Œæˆ‘ä»¬ä»…ä»…æ˜¯æ ¹æ®ä¸€ä¸ªå­—ç¬¦ä¸² ï¼Œå°±å®Œæˆäº†å¯¹student-&gt;nameçš„èµ‹å€¼æ“ä½œ ï¼è¿™æ˜¯å¦è®©ä½ è”æƒ³åˆ°ä»€ä¹ˆå‘¢ ï¼Œä»”ç»†æ€è€ƒ ã€‚ã€‚ã€‚æ²¡é”™ ï¼Œå½“æˆ‘ä»¬ä»æœåŠ¡ç«¯æ‹‰å–æ•°æ®çš„æ—¶å€™ ï¼Œ å¾€å¾€æ˜¯ä¸€ä¸²jsonï¼Œæˆ‘ä»¬æŠŠå®ƒè½¬åŒ–æˆä¸ºå­—å…¸æˆ–æ•°ç»„ç­‰å½¢å¼ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸æƒ³åœ¨æ¥ä¸‹æ¥çš„è°ƒç”¨ä¸­æ²¡å®Œæ²¡äº†çš„ä½¿ç”¨å­—å…¸ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æŠŠå®ƒè½¬åŒ–ä¸ºmodel ï¼ ä½œç”¨ä»‹ç» åŠ¨æ€åœ°å–å€¼å’Œè®¾å€¼ è®¿é—®å’Œä¿®æ”¹ç§æœ‰å˜é‡ Modelå’Œå­—å…¸è½¬æ¢ åŠ¨æ€å­˜å€¼ç”±äºæˆ‘ä»¬ä¸ç”¨æ˜¾ç¤ºçš„è°ƒç”¨getsetæ–¹æ³•æ“ä½œå¯¹è±¡çš„å±æ€§ ï¼Œ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„é€šè¿‡keyä¸ºå­—ç¬¦ä¸²çš„å½¢å¼å¯¹modelè¿›è¡Œèµ‹å€¼ è®¿é—®å’Œä¿®æ”¹ç§æœ‰å˜é‡æœ‰äº›ä¸‰æ–¹åº“çš„ç§æœ‰å±æ€§æˆ‘ä»¬éœ€è¦åšä¸€äº›è°ƒæ•´æ”¹å˜ ï¼Œ ä½†æ˜¯ç§æœ‰å±æ€§æ— æ³•åœ¨å¤–éƒ¨ç›´æ¥è®¿é—® ï¼Œ è¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥åœ¨å¤–éƒ¨è¿›è¡Œkey-valueèµ‹å€¼ Modelå’Œå­—å…¸è½¬æ¢å®¢æˆ·ç«¯ç»å¸¸è¦å‘èµ·ç½‘ç»œè¯·æ±‚ ï¼Œ å½“æœåŠ¡ç«¯åç»™æˆ‘ä»¬responseçš„æ—¶å€™å…ˆè§£ææˆDictionary ï¼Œ ä¸è¿‡åœ¨ä»£ç ä¸­ç›´æ¥ä½¿ç”¨dictionaryè¿›è¡Œæ“ä½œ ï¼Œ ä¿®æ”¹è§†å›¾ç­‰æ“ä½œæ—¢ä¸å®‰å…¨ ï¼Œ å†™èµ·æ¥ä¹Ÿå¾ˆçƒ¦ ã€‚é™¤äº†ä½¿ç”¨ç¬¬ä¸‰æ–¹model-dicè§£ææ¡†æ¶å¤–ä¹Ÿå¯ä»¥è‡ªå·±å®ç°ä¸€ä¸ªåŸºäºKVCçš„dictionaryè§£æhelper ã€‚ æ—¥å¸¸ä¸­ä½¿ç”¨çš„KVCå°±æ˜¯ä»¥ä¸Šå‡ ä¸ªæ–¹é¢çš„äº† ï¼Œ æ¬¢è¿è¡¥å…… ã€‚","categories":[],"tags":[{"name":"Objective-C","slug":"Objective-C","permalink":"https://felixplusplus.github.io/tags/Objective-C/"},{"name":"KVC","slug":"KVC","permalink":"https://felixplusplus.github.io/tags/KVC/"}]},{"title":"MVVMå®è·µ","slug":"mvvm","date":"2018-01-22T09:08:44.000Z","updated":"2018-08-18T10:51:47.910Z","comments":true,"path":"2018/01/22/mvvm/","link":"","permalink":"https://felixplusplus.github.io/2018/01/22/mvvm/","excerpt":"","text":"ä¸€ç‚¹å¯¹MVVMå¾®ä¸è¶³é“çš„æ€»ç»“ç›®å‰å®¢æˆ·ç«¯æœ€æµè¡Œçš„æ¶æ„åº”è¯¥å°±æ˜¯MVVM ï¼Œ ç„¶è€Œçœ‹äº†ä¸€å¤§å †åšå®¢ä¹‹å ï¼Œ å¤§éƒ¨åˆ†æ˜¯å¤§è°ˆç‰¹è°ˆè€Œå¹¶æ²¡æœ‰ä»”ç»†è®²è§£å…·ä½“çš„å¯è¡Œä¹‹æ³• ï¼Œ è¿™ç¯‡åšå®¢å°†ä¼šè¯´è¯´æˆ‘åœ¨å®é™…å·¥ä½œä¸­çš„ä½¿ç”¨ ã€‚ åŸºæœ¬æ¦‚å¿µMVC MVCæ¨¡å¼ï¼ˆModelâ€“viewâ€“controllerï¼‰æ˜¯è½¯ä»¶å·¥ç¨‹ä¸­çš„ä¸€ç§è½¯ä»¶æ¶æ„æ¨¡å¼ï¼ŒæŠŠè½¯ä»¶ç³»ç»Ÿåˆ†ä¸ºä¸‰ä¸ªåŸºæœ¬éƒ¨åˆ†ï¼šæ¨¡å‹ï¼ˆModelï¼‰ã€è§†å›¾ï¼ˆViewï¼‰å’Œæ§åˆ¶å™¨ï¼ˆControllerï¼‰ã€‚MVCæ¨¡å¼æœ€æ—©ç”±Trygve Reenskaugåœ¨1978å¹´æå‡º[1]ï¼Œæ˜¯æ–½ä¹å¸•ç½—å¥¥å¤šç ”ç©¶ä¸­å¿ƒï¼ˆXerox PARCï¼‰åœ¨20ä¸–çºª80å¹´ä»£ä¸ºç¨‹åºè¯­è¨€Smalltalkå‘æ˜çš„ä¸€ç§è½¯ä»¶æ¶æ„ã€‚MVCæ¨¡å¼çš„ç›®çš„æ˜¯å®ç°ä¸€ç§åŠ¨æ€çš„ç¨‹åºè®¾è®¡ï¼Œä½¿åç»­å¯¹ç¨‹åºçš„ä¿®æ”¹å’Œæ‰©å±•ç®€åŒ–ï¼Œå¹¶ä¸”ä½¿ç¨‹åºæŸä¸€éƒ¨åˆ†çš„é‡å¤åˆ©ç”¨æˆä¸ºå¯èƒ½ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ­¤æ¨¡å¼é€šè¿‡å¯¹å¤æ‚åº¦çš„ç®€åŒ–ï¼Œä½¿ç¨‹åºç»“æ„æ›´åŠ ç›´è§‚ã€‚è½¯ä»¶ç³»ç»Ÿé€šè¿‡å¯¹è‡ªèº«åŸºæœ¬éƒ¨åˆ†åˆ†ç¦»çš„åŒæ—¶ä¹Ÿèµ‹äºˆäº†å„ä¸ªåŸºæœ¬éƒ¨åˆ†åº”æœ‰çš„åŠŸèƒ½ã€‚ä¸“ä¸šäººå‘˜å¯ä»¥é€šè¿‡è‡ªèº«çš„ä¸“é•¿åˆ†ç»„ï¼š æ§åˆ¶å™¨ï¼ˆControllerï¼‰- è´Ÿè´£è½¬å‘è¯·æ±‚ï¼Œå¯¹è¯·æ±‚è¿›è¡Œå¤„ç†ã€‚ è§†å›¾ï¼ˆViewï¼‰ - ç•Œé¢è®¾è®¡äººå‘˜è¿›è¡Œå›¾å½¢ç•Œé¢è®¾è®¡ã€‚ æ¨¡å‹ï¼ˆModelï¼‰ - ç¨‹åºå‘˜ç¼–å†™ç¨‹åºåº”æœ‰çš„åŠŸèƒ½ï¼ˆå®ç°ç®—æ³•ç­‰ç­‰ï¼‰ã€æ•°æ®åº“ä¸“å®¶è¿›è¡Œæ•°æ®ç®¡ç†å’Œæ•°æ®åº“è®¾è®¡(å¯ä»¥å®ç°å…·ä½“çš„åŠŸèƒ½)ã€‚ MVVM MVVMæ˜¯Model-View-ViewModelçš„ç®€å†™ï¼Œæœ€æ—©æ˜¯ç”±å¾®è½¯å…¬å¸æå‡ºå¹¶è¿ç”¨ï¼Œæ˜¯MVPï¼ˆModel-View-Presenterï¼‰æ¨¡å¼ä¸WPFç»“åˆçš„åº”ç”¨æ–¹å¼æ—¶å‘å±•æ¼”å˜è¿‡æ¥çš„ä¸€ç§æ–°å‹æ¶æ„æ¶æ„ã€‚ MVVMæœ‰åŠ©äºå°†å›¾å½¢ç”¨æˆ·ç•Œé¢çš„å¼€å‘ä¸ä¸šåŠ¡é€»è¾‘æˆ–åç«¯é€»è¾‘ï¼ˆæ•°æ®æ¨¡å‹ï¼‰çš„å¼€å‘åˆ†ç¦»å¼€æ¥ï¼Œè¿™æ˜¯é€šè¿‡ç½®æ ‡è¯­è¨€æˆ–GUIä»£ç å®ç°çš„ã€‚MVVMçš„è§†å›¾æ¨¡å‹æ˜¯ä¸€ä¸ªå€¼è½¬æ¢å™¨ï¼Œ è¿™æ„å‘³ç€è§†å›¾æ¨¡å‹è´Ÿè´£ä»æ¨¡å‹ä¸­æš´éœ²ï¼ˆè½¬æ¢ï¼‰æ•°æ®å¯¹è±¡ï¼Œä»¥ä¾¿è½»æ¾ç®¡ç†å’Œå‘ˆç°å¯¹è±¡ã€‚åœ¨è¿™æ–¹é¢ï¼Œè§†å›¾æ¨¡å‹æ¯”è§†å›¾åšå¾—æ›´å¤šï¼Œå¹¶ä¸”å¤„ç†å¤§éƒ¨åˆ†è§†å›¾çš„æ˜¾ç¤ºé€»è¾‘ã€‚ è§†å›¾æ¨¡å‹å¯ä»¥å®ç°ä¸­ä»‹è€…æ¨¡å¼ï¼Œç»„ç»‡å¯¹è§†å›¾æ‰€æ”¯æŒçš„ç”¨ä¾‹é›†çš„åç«¯é€»è¾‘çš„è®¿é—®ã€‚ æ¨¡å‹ æ¨¡å‹æ˜¯æŒ‡ä»£è¡¨çœŸå®çŠ¶æ€å†…å®¹çš„é¢†åŸŸæ¨¡å‹ï¼ˆé¢å‘å¯¹è±¡ï¼‰ï¼Œæˆ–æŒ‡ä»£è¡¨å†…å®¹çš„æ•°æ®è®¿é—®å±‚ï¼ˆä»¥æ•°æ®ä¸ºä¸­å¿ƒï¼‰ã€‚ è§†å›¾ å°±åƒåœ¨MVCå’ŒMVPæ¨¡å¼ä¸­ä¸€æ ·ï¼Œè§†å›¾æ˜¯ç”¨æˆ·åœ¨å±å¹•ä¸Šçœ‹åˆ°çš„ç»“æ„ã€å¸ƒå±€å’Œå¤–è§‚ï¼ˆUIï¼‰ã€‚ è§†å›¾æ¨¡å‹ è§†å›¾æ¨¡å‹æ˜¯æš´éœ²å…¬å…±å±æ€§å’Œå‘½ä»¤çš„è§†å›¾çš„æŠ½è±¡ã€‚MVVMæ²¡æœ‰MVCæ¨¡å¼çš„æ§åˆ¶å™¨ï¼Œä¹Ÿæ²¡æœ‰MVPæ¨¡å¼çš„presenterï¼Œæœ‰çš„æ˜¯ä¸€ä¸ªç»‘å®šå™¨ã€‚åœ¨è§†å›¾æ¨¡å‹ä¸­ï¼Œç»‘å®šå™¨åœ¨è§†å›¾å’Œæ•°æ®ç»‘å®šå™¨ä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚ ç»‘å®šå™¨ å£°æ˜æ€§æ•°æ®å’Œå‘½ä»¤ç»‘å®šéšå«åœ¨MVVMæ¨¡å¼ä¸­ã€‚åœ¨Microsoftè§£å†³æ–¹æ¡ˆå †ä¸­ï¼Œç»‘å®šå™¨æ˜¯ä¸€ç§åä¸ºXAMLçš„æ ‡è®°è¯­è¨€ã€‚ç»‘å®šå™¨ä½¿å¼€å‘äººå‘˜å…äºè¢«è¿«ç¼–å†™æ ·æ¿å¼é€»è¾‘æ¥åŒæ­¥è§†å›¾æ¨¡å‹å’Œè§†å›¾ã€‚åœ¨å¾®è½¯çš„å †ä¹‹å¤–å®ç°æ—¶ï¼Œå£°æ˜æ€§æ•°æ®ç»‘å®šæŠ€æœ¯çš„å‡ºç°æ˜¯å®ç°è¯¥æ¨¡å¼çš„ä¸€ä¸ªå…³é”®å› ç´ ã€‚ ä¼˜ç‚¹è§£å†³controllerè¿‡äºè‡ƒè‚¿åœ¨MVCä¸­å¾ˆå®¹æ˜“å°±ä¼šæŠŠä¸€äº›ä¸šåŠ¡é€»è¾‘ ï¼Œ ç½‘ç»œè¯·æ±‚ ï¼Œ æ•°æ®IOéƒ½æ”¾åœ¨controllerä¸­ æ³¨æ„ ï¼Œ è¿™é‡Œä¸æ˜¯è¯´MVCçš„æ§åˆ¶å™¨ä¸€å®šå¾ˆè‡ƒè‚¿ ï¼Œ è€Œæ˜¯ã€Œå®¹æ˜“å˜å¾—è‡ƒè‚¿ã€ åœ¨æˆ‘ä»¬æ–°å»ºä¸€ä¸ªå·¥ç¨‹çš„æ—¶å€™ ï¼Œ è‹¹æœä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªViewController ï¼Œ è€Œåœ¨åŠ¨æ‰‹å¼€å§‹å†™ä»£ç çš„æ—¶å€™ ï¼Œ å¾€å¾€æ§åˆ¶ä¸ä½å°±ç›´æ¥å°†é€»è¾‘å†™åœ¨Controllerä¸­ ã€‚ MVVMæ¶æ„ä¼šè¦æ±‚æˆ‘ä»¬æŠŠä»»ä½•ä¸éViewçš„é€»è¾‘ç»ç’ƒå‡ºæ¥ ï¼Œ Controllerä¸­é™¤äº†ç»‘å®šviewModelä¹‹å¤–çš„ä»£ç åªå…è®¸å‡ºç°å¯¹Viewçš„æ“ä½œ ã€‚ å› ä¸ºControllerå¯¹æˆ‘ä»¬æ¥è¯´ä¹Ÿåªæ˜¯ä¸€ä¸ªView ã€‚ é€»è¾‘åˆ†ç¦»å°±åƒä¸Šé¢è¯´çš„ ï¼Œ ä¸šåŠ¡é€»è¾‘éƒ½ä¼šæŠ½ç¦»å‡ºæ¥æ”¾åœ¨viewModelä¸­ ï¼Œè¿™æ ·å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹é‡ç”¨è¿™ä¸€å †ä¸šåŠ¡ é™¤æ­¤ä¹‹å¤– ï¼Œ æˆ‘ä»¬çš„ä»£ç å°†ä¼šæ›´åŠ æ˜“äºæµ‹è¯• ï¼Œ é¿å…å‡ºç°åœ¨MVCä¸­å¯èƒ½å‡ºç°çš„é‚£ç§è¶…é•¿çš„æ–¹æ³•ã€ä¸¥é‡ä¾èµ–å…¨å±€çŠ¶æ€å¯¼è‡´éš¾ä»¥æµ‹è¯•çš„é—®é¢˜ ã€‚ viewé‡ç”¨ (å¯æ‹¥æœ‰viewå•ç‹¬çš„viewModel)åœ¨MVVMä¸­ ï¼Œ Viewåªéœ€è¦ä¸ViewModeäº¤äº’ ï¼Œ ä¸ä¼šæ”¶åˆ°å…¶ä»–çš„å½±å“ ï¼Œ æ‰€ä»¥ä¸ä½†vmã€m å¯ä»¥é‡ç”¨ ï¼Œ viewä¸€æ ·å¯ä»¥é‡å¤ä½¿ç”¨ ï¼Œ ä¿®æ”¹çš„æ—¶å€™ä¹Ÿæ›´åŠ æ–¹ä¾¿ ã€‚ ç¼ºç‚¹BUGä¸ä¼ é€’ç”±äºåœ¨MVVMé‡Œé¢Viewå’ŒViewModelæ˜¯æ¾è€¦åˆçš„ ï¼Œ åœ¨æµ‹è¯•å‡ºé—®é¢˜çš„æ—¶å€™å°±è¦æ’æŸ¥å„ä¸ªåœ°æ–¹çš„é—®é¢˜ ï¼Œ æœ‰å¯èƒ½æ˜¯vmä¸­çš„ä¹Ÿæœ‰å¯èƒ½æ˜¯viewä¸­çš„ ã€‚ ç”±äºvmä¼šä¼ é€’æ•°æ® ï¼Œ ä¸€ä¸ªbugä¼šå¾ˆå®¹æ˜“çš„ä¼ é€’åˆ°å…¶ä»–åœ°æ–¹ï¼Œ å¼•å‘æ›´å¤§çš„é—®é¢˜ã€‚ å¹¶ä¸”å…¶ä¸­ä¸€ä¸ªåœ°æ–¹å‡ºç°é—®é¢˜çš„è¯ ï¼Œ è¿™ä¸ªBUGå°±ææœ‰å¯èƒ½éšç€ä¼ é€’åˆ°å…¶ä»–çš„é€»è¾‘ä¸­ ï¼Œ ä»è€Œå¯¼è‡´æ›´ä¸¥é‡çš„é—®é¢˜å‘ç”Ÿ ã€‚ éœ€è¦ç»´æŠ¤Model ï¼Œ viewModel ï¼Œ å’Œviewçš„å¼€é”€ ï¼Œ å†…å­˜èŠ±è´¹å¤§é¢å¤–çš„viewModelä½¿ç”¨ä¹Ÿå¹¶ä¸æ˜¯æ— ä»£ä»·çš„ ï¼Œ æœ‰å¯èƒ½ç”±äºå„ç§åŸå› å¯¼è‡´å†…å­˜å ç”¨å¢å¤š ï¼Œ è€Œé¢å¤–çš„ ï¼Œ å¦‚æœå› ä¸ºå¼ºé¥®ç”¨æˆ–å…¶ä»–åŸå› å¯¼è‡´çš„å¾ªç¯å¼•ç”¨ç­‰å†…å­˜ä¸èƒ½æ­£ç¡®é‡Šæ”¾çš„æƒ…å†µä¸‹ ï¼Œ æœ‰å¯èƒ½ä¼šå†…å­˜ç–¯æ¶¨ ã€‚ ä½¿ç”¨æ–¹æ³•ä¸Šé¢è¯´äº†è¿™äº›åªæ˜¯ä¸€ä¸ªå¤§è‡´çš„ä»‹ç» ï¼Œ æˆ‘ä»¬è¿˜æ˜¯æ¥çœ‹çœ‹åº”è¯¥æ€æ ·ä½¿ç”¨å§ ã€‚ ä½ å¯ä»¥ä½¿ç”¨delegateçš„æ–¹å¼æˆ–è€…blockçš„æ–¹å¼å¯¹viewå’ŒviewModelè¿›è¡Œæ¡¥æ¥ ï¼Œ åœ¨è¿™é‡Œæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨delegate ï¼Œ æˆ‘è®¤ä¸ºè¿™æ ·çœ‹ç€æ¯”è¾ƒç›´è§‚ ï¼Œ åœ¨ä»£ç ä¸­ä¹Ÿæ›´åŠ æ˜ç¡®ã€‚ é¦–å…ˆåˆ›å»ºä¸€ä¸ªå·¥ç¨‹ ï¼Œ é€‰æ‹©singleViewApplication ï¼Œ æˆ‘ä»¬å°±ä»¥æœ€å¸¸è§çš„çš„ç™»é™†åŠŸèƒ½ä½œä¸ºç¤ºä¾‹ æ–°å»ºç”¨äºç”±viewModelè°ƒç”¨ ï¼Œ viewè¿›è¡Œå“åº”çš„protocolé¦–å…ˆè¦èµ·ä¸ªåå­— ï¼Œ å°±å«LoginViewModelDelegateProtocol å§ 123@protocol LoginViewModelDelegateProtocol &lt;NSObject&gt;@end å¥½ ï¼Œ è®©æˆ‘ä»¬æƒ³ä¸€æƒ³viewä¼šå‘é€ä¸€äº›ä»€ä¹ˆæ•°æ®ç»™VM ï¼ŒVMéƒ½éœ€è¦ä»€ä¹ˆæ•°æ® ã€‚ å¯¹äºç®€å•ç™»é™†çš„VMæ¥è¯´ ï¼Œ æˆ‘ä»¬éœ€è¦é€šçŸ¥viewçš„æ•°æ®å’Œæ–¹æ³• ç™»é™†æˆåŠŸ é”™è¯¯æç¤º æŒ‰é’®çŠ¶æ€æ”¹å˜ï¼ˆæ˜¯å¦å¯ä»¥ç‚¹å‡»ï¼‰ é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨protocolä¸­æ·»åŠ æ–¹æ³•äº† 1234567@protocol LoginViewModelDelegateProtocol &lt;NSObject&gt;- (void)loginSuccess;- (void)showTips:(NSString *)tip;- (void)buttonEnable:(BOOL )enable;@end æ–°å»ºç”¨äºç”±viewè°ƒç”¨ ï¼Œ viewModelè¿›è¡Œå“åº”çš„protocolåŒç† ï¼Œ æˆ‘ä»¬åªè¦ç¡®è®¤vmå’Œvéœ€è¦äº¤æ¢çš„æ•°æ®å°±å¥½äº† ã€‚ ç”¨æˆ·åè¾“å…¥æ¡†çš„å­—ç¬¦ä¸² å¯†ç è¾“å…¥æ¡†çš„å­—ç¬¦ä¸² ç‚¹å‡»ç™»é™†äº‹ä»¶ 1234567@protocol LoginViewModelInterfaceProtocol &lt;NSObject&gt;- (void)inputUserName:(NSString *)uname;- (void)inputPwd:(NSString *)pwd;- (void)didTapLoginBUtton;@end å®ç°ä»£ç†æ–¹æ³•ä¸‹é¢æˆ‘ä»¬æ–°å»ºä¸€ä¸ªviewModelå«åšLoginViewModel LoginViewModel.h 123456789#import &lt;Foundation/Foundation.h&gt;#import \"LoginViewModelDelegateProtocol.h\"#import \"LoginViewModelInterfaceProtocol.h\"@interface LoginViewModel : NSObject&lt;LoginViewModelInterfaceProtocol&gt;@property (nonatomic ,weak) id&lt;LoginViewModelDelegateProtocol&gt; delegate;@end LoginViewModel.m 1234567891011121314151617181920212223242526272829303132333435#import \"LoginViewModelDelegateProtocol.h\"@interface LoginViewModel ()@property (assign, nonatomic) BOOL unameValid;@property (assign, nonatomic) BOOL pwdValid;@end@implementation LoginViewModel- (void)inputUserName:(NSString *)uname &#123; self.unameValid = uname.length&gt;0; [self judgeAllValid];&#125;- (void)inputPwd:(NSString *)pwd &#123; self.pwdValid = pwd.length&gt;0; [self judgeAllValid];&#125;- (void)didTapLoginBUtton &#123; // ä¸€äº›è¯·æ±‚ ï¼Œ è¿™é‡Œå¿½ç•¥ç½‘ç»œè¯·æ±‚ ï¼Œ ç›´æ¥æ¨¡æ‹Ÿç»“æœ [self.delegate loginSuccess];&#125;- (void)judgeAllValid &#123; BOOL v = [self isAllValid]; [self.delegate buttonEnable:v];&#125;- (BOOL)isAllValid &#123; return self.unameValid &amp;&amp; self.pwdValid;&#125;@end ç„¶ååœ¨controlleråˆå§‹åŒ– ï¼Œ å¹¶ä¸”å®ç°å…¨éƒ¨çš„æ–¹æ³•å°±å¯ä»¥äº† ã€‚ viewController.m 123456789101112131415161718192021222324252627282930313233343536#import \"viewController.h\"...@interface viewController () &lt;LoginViewModelDelegateProtocol&gt;@property (nonatomic ,strong) LoginViewModel *vm;@end@implementation TDFSetPhoneNumController- (void)viewDidLoad &#123; [super viewDidLoad]; self.vm.delegate = self;&#125;#pragma mark - VMDelegate- (void)loginSuccess &#123; [self.navigationController pushViewController:[SuccessVC new]] animated:true];&#125;- (void)showTips:(NSString *)tip &#123; [self showAlert:tip];&#125;- (void)buttonEnable:(BOOL )enable &#123; self.loginbutton.enable = enable;&#125;#pragma mark - Getter- (LoginViewModel *)vm &#123; if (!_vm) &#123; _vm = [LoginViewModel new]; &#125; return _vm;&#125;@end å¤§åŠŸå‘Šæˆè¿™é‡Œå…¨éƒ¨çš„ä»£ç æ˜¯æˆ‘æ‰‹å†™çš„ ï¼Œ åé¢çœç•¥äº†ä¸€äº›UIKitç›¸å…³çš„å¸ƒå±€ ï¼Œ æƒ³å¿…ä»¥ä½ çš„èªæ˜æ‰æ™ºåº”è¯¥å·²ç»èƒ½å¾ˆè½»æ¾çš„å°†å‰©ä½™çš„è¡¥å…¨äº†å§ ã€‚ æ³¨æ„äº‹é¡¹è¿™é‡Œæœ‰å‡ ç‚¹æˆ‘è®¤ä¸ºåº”è¯¥æ³¨æ„çš„ vmä¸vä¹‹é—´ä¸è®ºé€šè¿‡ä»€ä¹ˆä¼ é€’å€¼å’Œå“åº” ï¼Œ éƒ½è¦ä¿æŒæ•°æ®çš„å•å‘æµåŠ¨ ã€‚ ä»£ç†ç”¨weak ï¼Œ å†…å­˜å›æ”¶æ—¶ä¼šè‡ªåŠ¨ç½®ä¸ºnil ï¼Œ å…¨éƒ¨modelä¸viewModelä¸­ä¸åº”åŒ…å«ä»»ä½•UIKitæ¡†æ¶ä¸‹çš„ç±» æ€»ç»“æ€»è€Œè¨€ä¹‹ ï¼Œ æˆ‘è®¤ä¸ºMVVMåœ¨æˆ‘ä»¬çš„ä»£ç æ•´ä½“åˆ†å·¥å’Œåº”ç”¨æ¶æ„çš„è¿‡ç¨‹ä¸­åº”ç”¨è¿˜æ˜¯ååˆ†ä¼˜é›…å’Œå®‰å…¨çš„ ï¼Œ ä¸è¿‡è¯è¯´å›æ¥ä»€ä¹ˆæ¶æ„ä¹Ÿç½¢ ï¼Œ è¿˜æ˜¯è¦çœ‹æˆ‘ä»¬æ€ä¹ˆå»ç”¨å®ƒ ï¼Œ ä¸æ˜¯å—","categories":[],"tags":[{"name":"Objective-C","slug":"Objective-C","permalink":"https://felixplusplus.github.io/tags/Objective-C/"},{"name":"MVVM","slug":"MVVM","permalink":"https://felixplusplus.github.io/tags/MVVM/"}]}]}